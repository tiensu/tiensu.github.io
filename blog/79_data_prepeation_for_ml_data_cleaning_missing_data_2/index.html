<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>SuNT&#39;s Blog | AI in Practical</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This is meta description">
  <meta name="author" content="SuNT">
  <meta name="generator" content="Hugo 0.80.0" />

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/themify-icons/themify-icons.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/venobox/venobox.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/css/override.css">
  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://tiensu.github.io/scss/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://tiensu.github.io/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://tiensu.github.io/images/favicon.png " type="image/x-icon">

  <!-- google analitycs -->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'Your ID', 'auto');
    ga('send', 'pageview');
  </script>

</head><body>
<!-- preloader start -->
<div class="preloader">
  
</div>
<!-- preloader end -->
<!-- navigation -->
<header class="navigation">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0">
      <a class="navbar-brand mobile-view" href="https://tiensu.github.io/"><img class="img-fluid"
          src="https://tiensu.github.io/images/logo3.jpg" alt="SuNT&#39;s Blog | AI in Practical"></a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="ti-menu h3"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <div class="desktop-view">
          <ul class="navbar-nav mr-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.facebook.com/tiensunguyen2103"><i class="ti-facebook"></i></a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.linkedin.com/in/su-nguyen-tien-aws%C2%AE-5ba74ba6/"><i class="ti-linkedin"></i></a>
            </li>
            
          </ul>
        </div>

        <a class="navbar-brand mx-auto desktop-view" href="https://tiensu.github.io/"><img class="img-fluid"
            src="https://tiensu.github.io/images/logo3.jpg" alt="SuNT&#39;s Blog | AI in Practical"></a>

        <ul class="navbar-nav">
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://tiensu.github.io/about">About</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://tiensu.github.io/blog">Post</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://tiensu.github.io/contact">Contact</a>
          </li>
          
          
        </ul>

        
        <!-- search -->
        <div class="search pl-lg-4">
          <button id="searchOpen" class="search-btn"><i class="ti-search"></i></button>
          <div class="search-wrapper">
            <form action="https://tiensu.github.io//search" class="h-100">
              <input class="search-box px-4" id="search-query" name="s" type="search" placeholder="Type & Hit Enter...">
            </form>
            <button id="searchClose" class="search-close"><i class="ti-close text-dark"></i></button>
          </div>
        </div>
        

        
      </div>
    </nav>
  </div>
  <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</header>
<!-- /navigation -->

<section class="section-sm">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 mx-auto">
        
        <a href="/categories/machine-learning"
          class="text-primary">Machine Learning</a>
        
        <a href="/categories/data-preparation"
          class="text-primary">Data Preparation</a>
        
        <h2>DP4ML - Missing Data - Phần 2 - Statistical Imputation</h2>
        <div class="mb-3 post-meta">
          <span>By SuNT</span>
          
          <span class="border-bottom border-primary px-2 mx-1"></span>
          <span>14 June 2021</span>
          
        </div>
        
        <img src="https://tiensu.github.io/images/featured-post/79_missing_data.png" class="img-fluid w-100 mb-4" alt="DP4ML - Missing Data - Phần 2 - Statistical Imputation">
        
        <div class="content mb-5">
          <p>Bài thứ 5 trong chuỗi các bài viết về chủ đề Data Preparation cho các mô hình ML và là bài thứ 2 về chủ đề Missing Data. Trong bài này, chúng ta sẽ tìm hiểu phương pháp tiếp theo để giải quyết vấn đề Missing Data, đó là phương pháp Statistical Imputation.</p>
<p>Imputation, nói chung là các phương pháp thay thế các Missing Data bằng một giá trị khác. Có 3 phương pháp Imputation phổ biến là Statistical Imputation, KNN Imputation, và Iterative Imputation. Phương pháp đầu tiên sẽ được tìm hiểu trong bài này.</p>
<h3 id="1-statistic-imputation">1. Statistic Imputation</h3>
<p>Đây là phương pháp sử dụng các giá trị thống kê để thay thế cho Missing Data. Ưu điểm của nó là đơn giản, tính toán nhanh. Một số phương án thay thế Missing Data bằng giá trị thống kê có thể sử dụng ở đây là:</p>
<ul>
<li>Thay thế Missing Data trong 1 cột bằng giá trị trung bình của cột chứa Missing Data đó.</li>
<li>Thay thế Missing Data trong 1 cột bằng giá trị trung vị của cột chứa Missing Data đó.</li>
<li>Thay thế Missing Data trong 1 cột bằng giá trị xuất hiện nhiều nhất (<em>mode</em>) trong cột chứa Missing Data đó.</li>
<li>Thay thế Missing Data trong 1 cột bằng giá trị là hằng số khác.</li>
</ul>
<h3 id="2-thực-hàng-statistical-imputation">2. Thực hàng Statistical Imputation</h3>
<p>Chúng ta sẽ thử thực hành phương pháp Statistical Imputation trên một bộ dữ liệu cụ thể.</p>
<h4 id="21-giới-thiệu-bộ-dữ-liệu-horse-colic-dataset">2.1 Giới thiệu bộ dữ liệu Horse Colic Dataset</h4>
<p><a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/horse-colic.csv">Horse Colic Dataset</a> là bộ dữ liệu mô tả các đặc điểm y học của những con ngựa bị đau bụng và cho ra kết quả là chúng còn sống hay đã chết. Có tổng cộng 300 con ngựa, mỗi con có 26 đặc điểm được ghi nhận. Thông tin chi tiết về các trường dữ liệu được trình bày trong <a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/horse-colic.names">file này</a>. Đây là bài toán Binary Classification, kết quả dự đoán là 1 nếu con ngựa còn sống và 2 nếu con ngựa đã chết. Tập dữ liệu có nhiều giá trị bị thiếu được đánh dấu bằng một ký tự dấu chấm hỏi (“?”).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">530101</span>,<span style="color:#ae81ff">38.50</span>,<span style="color:#ae81ff">66</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">3</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">4</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">45.00</span>,<span style="color:#ae81ff">8.40</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">11300</span>,<span style="color:#ae81ff">00000</span>,<span style="color:#ae81ff">00000</span>,<span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">534817</span>,<span style="color:#ae81ff">39.2</span>,<span style="color:#ae81ff">88</span>,<span style="color:#ae81ff">20</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">2</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">85</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0220</span><span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">00000</span>,<span style="color:#ae81ff">00000</span>,<span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">530334</span>,<span style="color:#ae81ff">38.30</span>,<span style="color:#ae81ff">40</span>,<span style="color:#ae81ff">24</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">1</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">33.00</span>,<span style="color:#ae81ff">6.70</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">00000</span>,<span style="color:#ae81ff">00000</span>,<span style="color:#ae81ff">00000</span>,<span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">5290409</span>,<span style="color:#ae81ff">39.10</span>,<span style="color:#ae81ff">164</span>,<span style="color:#ae81ff">84</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">5.00</span>,<span style="color:#ae81ff">3</span>,<span style="color:#960050;background-color:#1e0010">?</span>,<span style="color:#ae81ff">48.00</span>,<span style="color:#ae81ff">7.20</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">5.30</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0220</span><span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">00000</span>,<span style="color:#ae81ff">00000</span>,<span style="color:#ae81ff">1</span>
<span style="color:#f92672">...</span>
</code></pre></div><p>Mình sẽ tiến hành đọc bộ dữ liệu này vào một Dataframe, thay thế Missing Data bằng giá trị NaN, sau đó đếm số lượng Missing Data trong mỗi cột kèm theo phần trăm tương ứng:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># summarize the horse colic dataset</span>
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#75715e"># load dataset</span>
dataframe <span style="color:#f92672">=</span> read_csv(<span style="color:#e6db74">&#39;horse-colic.csv&#39;</span> , header<span style="color:#f92672">=</span>None, na_values<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;?&#39;</span>)
<span style="color:#75715e"># summarize the first few rows</span>
<span style="color:#66d9ef">print</span>(dataframe<span style="color:#f92672">.</span>head())
<span style="color:#75715e"># summarize the number of rows with missing values for each column</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(dataframe<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>]):
    <span style="color:#75715e"># count number of rows with missing values</span>
    n_miss <span style="color:#f92672">=</span> dataframe[[i]]<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum()
    perc <span style="color:#f92672">=</span> n_miss <span style="color:#f92672">/</span> dataframe<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;&gt; </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">, Missing: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">%.1f%%</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (i, n_miss, perc))
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    <span style="color:#ae81ff">0</span>   <span style="color:#ae81ff">1</span>        <span style="color:#ae81ff">2</span>     <span style="color:#ae81ff">3</span>      <span style="color:#ae81ff">4</span>     <span style="color:#ae81ff">5</span>    <span style="color:#ae81ff">6</span>    <span style="color:#ae81ff">7</span>    <span style="color:#ae81ff">8</span>    <span style="color:#ae81ff">9</span>    <span style="color:#ae81ff">10</span>   <span style="color:#ae81ff">11</span>   <span style="color:#ae81ff">12</span>   <span style="color:#ae81ff">13</span>   <span style="color:#ae81ff">14</span>   <span style="color:#ae81ff">15</span>   <span style="color:#ae81ff">16</span>   <span style="color:#ae81ff">17</span>    <span style="color:#ae81ff">18</span>    <span style="color:#ae81ff">19</span>   <span style="color:#ae81ff">20</span>   <span style="color:#ae81ff">21</span>   <span style="color:#ae81ff">22</span>  <span style="color:#ae81ff">23</span>     <span style="color:#ae81ff">24</span>  <span style="color:#ae81ff">25</span>  <span style="color:#ae81ff">26</span>  <span style="color:#ae81ff">27</span>
<span style="color:#ae81ff">0</span>  <span style="color:#ae81ff">2.0</span>   <span style="color:#ae81ff">1</span>   <span style="color:#ae81ff">530101</span>  <span style="color:#ae81ff">38.5</span>   <span style="color:#ae81ff">66.0</span>  <span style="color:#ae81ff">28.0</span>  <span style="color:#ae81ff">3.0</span>  <span style="color:#ae81ff">3.0</span>  NaN  <span style="color:#ae81ff">2.0</span>  <span style="color:#ae81ff">5.0</span>  <span style="color:#ae81ff">4.0</span>  <span style="color:#ae81ff">4.0</span>  NaN  NaN  NaN  <span style="color:#ae81ff">3.0</span>  <span style="color:#ae81ff">5.0</span>  <span style="color:#ae81ff">45.0</span>   <span style="color:#ae81ff">8.4</span>  NaN  NaN  <span style="color:#ae81ff">2.0</span>   <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">11300</span>   <span style="color:#ae81ff">0</span>   <span style="color:#ae81ff">0</span>   <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">1.0</span>   <span style="color:#ae81ff">1</span>   <span style="color:#ae81ff">534817</span>  <span style="color:#ae81ff">39.2</span>   <span style="color:#ae81ff">88.0</span>  <span style="color:#ae81ff">20.0</span>  NaN  NaN  <span style="color:#ae81ff">4.0</span>  <span style="color:#ae81ff">1.0</span>  <span style="color:#ae81ff">3.0</span>  <span style="color:#ae81ff">4.0</span>  <span style="color:#ae81ff">2.0</span>  NaN  NaN  NaN  <span style="color:#ae81ff">4.0</span>  <span style="color:#ae81ff">2.0</span>  <span style="color:#ae81ff">50.0</span>  <span style="color:#ae81ff">85.0</span>  <span style="color:#ae81ff">2.0</span>  <span style="color:#ae81ff">2.0</span>  <span style="color:#ae81ff">3.0</span>   <span style="color:#ae81ff">2</span>   <span style="color:#ae81ff">2208</span>   <span style="color:#ae81ff">0</span>   <span style="color:#ae81ff">0</span>   <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">2.0</span>   <span style="color:#ae81ff">1</span>   <span style="color:#ae81ff">530334</span>  <span style="color:#ae81ff">38.3</span>   <span style="color:#ae81ff">40.0</span>  <span style="color:#ae81ff">24.0</span>  <span style="color:#ae81ff">1.0</span>  <span style="color:#ae81ff">1.0</span>  <span style="color:#ae81ff">3.0</span>  <span style="color:#ae81ff">1.0</span>  <span style="color:#ae81ff">3.0</span>  <span style="color:#ae81ff">3.0</span>  <span style="color:#ae81ff">1.0</span>  NaN  NaN  NaN  <span style="color:#ae81ff">1.0</span>  <span style="color:#ae81ff">1.0</span>  <span style="color:#ae81ff">33.0</span>   <span style="color:#ae81ff">6.7</span>  NaN  NaN  <span style="color:#ae81ff">1.0</span>   <span style="color:#ae81ff">2</span>      <span style="color:#ae81ff">0</span>   <span style="color:#ae81ff">0</span>   <span style="color:#ae81ff">0</span>   <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">3</span>  <span style="color:#ae81ff">1.0</span>   <span style="color:#ae81ff">9</span>  <span style="color:#ae81ff">5290409</span>  <span style="color:#ae81ff">39.1</span>  <span style="color:#ae81ff">164.0</span>  <span style="color:#ae81ff">84.0</span>  <span style="color:#ae81ff">4.0</span>  <span style="color:#ae81ff">1.0</span>  <span style="color:#ae81ff">6.0</span>  <span style="color:#ae81ff">2.0</span>  <span style="color:#ae81ff">2.0</span>  <span style="color:#ae81ff">4.0</span>  <span style="color:#ae81ff">4.0</span>  <span style="color:#ae81ff">1.0</span>  <span style="color:#ae81ff">2.0</span>  <span style="color:#ae81ff">5.0</span>  <span style="color:#ae81ff">3.0</span>  NaN  <span style="color:#ae81ff">48.0</span>   <span style="color:#ae81ff">7.2</span>  <span style="color:#ae81ff">3.0</span>  <span style="color:#ae81ff">5.3</span>  <span style="color:#ae81ff">2.0</span>   <span style="color:#ae81ff">1</span>   <span style="color:#ae81ff">2208</span>   <span style="color:#ae81ff">0</span>   <span style="color:#ae81ff">0</span>   <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">2.0</span>   <span style="color:#ae81ff">1</span>   <span style="color:#ae81ff">530255</span>  <span style="color:#ae81ff">37.3</span>  <span style="color:#ae81ff">104.0</span>  <span style="color:#ae81ff">35.0</span>  NaN  NaN  <span style="color:#ae81ff">6.0</span>  <span style="color:#ae81ff">2.0</span>  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  <span style="color:#ae81ff">74.0</span>   <span style="color:#ae81ff">7.4</span>  NaN  NaN  <span style="color:#ae81ff">2.0</span>   <span style="color:#ae81ff">2</span>   <span style="color:#ae81ff">4300</span>   <span style="color:#ae81ff">0</span>   <span style="color:#ae81ff">0</span>   <span style="color:#ae81ff">2</span>
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>, Missing: <span style="color:#ae81ff">1</span> (<span style="color:#ae81ff">0.3</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>, Missing: <span style="color:#ae81ff">0</span> (<span style="color:#ae81ff">0.0</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">2</span>, Missing: <span style="color:#ae81ff">0</span> (<span style="color:#ae81ff">0.0</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">3</span>, Missing: <span style="color:#ae81ff">60</span> (<span style="color:#ae81ff">20.0</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">4</span>, Missing: <span style="color:#ae81ff">24</span> (<span style="color:#ae81ff">8.0</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">5</span>, Missing: <span style="color:#ae81ff">58</span> (<span style="color:#ae81ff">19.3</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">6</span>, Missing: <span style="color:#ae81ff">56</span> (<span style="color:#ae81ff">18.7</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">7</span>, Missing: <span style="color:#ae81ff">69</span> (<span style="color:#ae81ff">23.0</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">8</span>, Missing: <span style="color:#ae81ff">47</span> (<span style="color:#ae81ff">15.7</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">9</span>, Missing: <span style="color:#ae81ff">32</span> (<span style="color:#ae81ff">10.7</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">10</span>, Missing: <span style="color:#ae81ff">55</span> (<span style="color:#ae81ff">18.3</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">11</span>, Missing: <span style="color:#ae81ff">44</span> (<span style="color:#ae81ff">14.7</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">12</span>, Missing: <span style="color:#ae81ff">56</span> (<span style="color:#ae81ff">18.7</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">13</span>, Missing: <span style="color:#ae81ff">104</span> (<span style="color:#ae81ff">34.7</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">14</span>, Missing: <span style="color:#ae81ff">106</span> (<span style="color:#ae81ff">35.3</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">15</span>, Missing: <span style="color:#ae81ff">247</span> (<span style="color:#ae81ff">82.3</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">16</span>, Missing: <span style="color:#ae81ff">102</span> (<span style="color:#ae81ff">34.0</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">17</span>, Missing: <span style="color:#ae81ff">118</span> (<span style="color:#ae81ff">39.3</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">18</span>, Missing: <span style="color:#ae81ff">29</span> (<span style="color:#ae81ff">9.7</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">19</span>, Missing: <span style="color:#ae81ff">33</span> (<span style="color:#ae81ff">11.0</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">20</span>, Missing: <span style="color:#ae81ff">165</span> (<span style="color:#ae81ff">55.0</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">21</span>, Missing: <span style="color:#ae81ff">198</span> (<span style="color:#ae81ff">66.0</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">22</span>, Missing: <span style="color:#ae81ff">1</span> (<span style="color:#ae81ff">0.3</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">23</span>, Missing: <span style="color:#ae81ff">0</span> (<span style="color:#ae81ff">0.0</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">24</span>, Missing: <span style="color:#ae81ff">0</span> (<span style="color:#ae81ff">0.0</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">25</span>, Missing: <span style="color:#ae81ff">0</span> (<span style="color:#ae81ff">0.0</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">26</span>, Missing: <span style="color:#ae81ff">0</span> (<span style="color:#ae81ff">0.0</span><span style="color:#f92672">%</span>)
<span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">27</span>, Missing: <span style="color:#ae81ff">0</span> (<span style="color:#ae81ff">0.0</span><span style="color:#f92672">%</span>)
</code></pre></div><p>Có thể thấy rằng, chỉ có cột 1, 2, 23, 24, 25, 25, 27 là không có Missing Data. Các cột còn lại đều có. Đặc biệt, cột cột 15 và 21, số lượng Missing Data chiếm phần lớn.</p>
<h4 id="22-thực-hiện-statistical-imputation">2.2 Thực hiện Statistical Imputation</h4>
<p>Thư viện Scikit-learn cung cấp lớp <em>SimpleImputer</em> giúp chúng ta thực hiện Statistical Imputation rất dễ dàng.</p>
<h5 id="a-simpleimputer-và-data-transform">a, SimpleImputer và Data Transform</h5>
<p>Đầu tiên, khai báo một Instance của lớp <em>SimpleImputer</em>, truyền vào loại thống kê muốn sử dụng: mean, median, mode, &hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># define imputer</span>
imputer <span style="color:#f92672">=</span> SimpleImputer(strategy<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;mean&#39;</span>)
</code></pre></div><p>Tiếp theo, dùng <em>imputer</em> vừa khai báo <em>fit</em> trên tập dữ liệu để tính toán trung bình của mỗi cột.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">...</span>
<span style="color:#75715e"># fit on the dataset</span>
imputer<span style="color:#f92672">.</span>fit(X)
</code></pre></div><p>Cuối cùng, mang <em>imputer</em> áp dụng lên toàn bộ tập dữ liệu để tạo ra một phiên bản mới của tập dữ liệu, trong đó, tất cả Missing Data được thay thể bởi giá trị trung bình của cột chứa nó.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">...</span>
<span style="color:#75715e"># transform the dataset</span>
Xtrans <span style="color:#f92672">=</span> imputer<span style="color:#f92672">.</span>transform(X)
</code></pre></div><p>Code đầy đủ áp dụng vào tập dữ liệu Horse Colic Dataset như sau:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># statistical imputation transform for the horse colic dataset</span>
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> isnan
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> sklearn.impute <span style="color:#f92672">import</span> SimpleImputer

<span style="color:#75715e"># load dataset</span>
dataframe <span style="color:#f92672">=</span> read_csv(<span style="color:#e6db74">&#39;horse-colic.csv&#39;</span> , header<span style="color:#f92672">=</span>None, na_values<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;?&#39;</span> )
<span style="color:#75715e"># split into input and output elements. #23 is label column</span>
data <span style="color:#f92672">=</span> dataframe<span style="color:#f92672">.</span>values
ix <span style="color:#f92672">=</span> [i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(data<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>]) <span style="color:#66d9ef">if</span> i <span style="color:#f92672">!=</span> <span style="color:#ae81ff">23</span>]
X, y <span style="color:#f92672">=</span> data[:, ix], data[:, <span style="color:#ae81ff">23</span>]
<span style="color:#75715e"># summarize total missing</span>
<span style="color:#66d9ef">print</span>( <span style="color:#e6db74">&#39;Missing: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> sum(isnan(X)<span style="color:#f92672">.</span>flatten()))
<span style="color:#75715e"># define imputer</span>
imputer <span style="color:#f92672">=</span> SimpleImputer(strategy<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;mean&#39;</span> )
<span style="color:#75715e"># fit on the dataset</span>
imputer<span style="color:#f92672">.</span>fit(X)
<span style="color:#75715e"># transform the dataset</span>
Xtrans <span style="color:#f92672">=</span> imputer<span style="color:#f92672">.</span>transform(X)
<span style="color:#75715e"># summarize total missing</span>
<span style="color:#66d9ef">print</span>( <span style="color:#e6db74">&#39;Missing: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> sum(isnan(Xtrans)<span style="color:#f92672">.</span>flatten()))
</code></pre></div><p>Kết quả thực thi:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Missing: <span style="color:#ae81ff">1605</span>
Missing: <span style="color:#ae81ff">0</span>
</code></pre></div><p>Ban đầu, có 1605 Missing Data. Sau khi thực hiện Statistical Imputation, không còn Missing Data nữa.</p>
<h5 id="b-simpleimputer-và-model-evaluation">b, SimpleImputer và Model Evaluation</h5>
<p>Phần này, chúng ta sẽ thực hiện đầy đủ việc áp dụng Statistical Imputation vào mô hình hóa thuật toán RandomForest trên tập dữ liệu Horse Colic Dataset theo phương pháp k-Fold Cross-validation.</p>
<p>Hãy nhớ lại cách tiếp cận chuẩn khi thực hiện Data Preparation mà chúng ta đã đề cập ở bài đầu tiên. Cụ thể, với bài toán này, các bước thực hiện sẽ như sau:</p>
<ul>
<li>Chia tập dữ liệu thành 2 tập Train và Test theo kiểu k-Fold Cross-validation.</li>
<li>Tính toán giá trị Statistic trên mỗi cột của tập Train.</li>
<li>Áp dụng phần tính toán đó vào cả 2 tập Train và Test.</li>
</ul>
<p>Để thực hiện các công viêc này một cách đơn giản, mình sẽ sử dụng lớp <em>Pipeline</em> của Scikit-learn. Có thể hiểu đó là một cách thực hiện các bước tuần tự nhau theo một thứ tự được quy định trước. Như ví dụ dưới đây, <em>Pipeline</em> gồm 2 bước: bước 1 là khai báo SimpleImputer, bước 2 là khai báo RandomForest model:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">...</span>
<span style="color:#75715e"># define modeling pipeline</span>
model <span style="color:#f92672">=</span> RandomForestClassifier()
imputer <span style="color:#f92672">=</span> SimpleImputer(strategy<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;mean&#39;</span>)
pipeline <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>[(<span style="color:#e6db74">&#39;i&#39;</span> , imputer), (<span style="color:#e6db74">&#39;m&#39;</span> , model)])
</code></pre></div><p>Code đây đủ của bài toán như dưới đây:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># evaluate mean imputation and random forest for the horse colic dataset</span>
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> mean
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> std
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> RandomForestClassifier
<span style="color:#f92672">from</span> sklearn.impute <span style="color:#f92672">import</span> SimpleImputer
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> cross_val_score
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> RepeatedStratifiedKFold
<span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> Pipeline

<span style="color:#75715e"># load dataset</span>
dataframe <span style="color:#f92672">=</span> read_csv(<span style="color:#e6db74">&#39;horse-colic.csv&#39;</span> , header<span style="color:#f92672">=</span>None, na_values<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;?&#39;</span>)
<span style="color:#75715e"># split into input and output elements</span>
data <span style="color:#f92672">=</span> dataframe<span style="color:#f92672">.</span>values
ix <span style="color:#f92672">=</span> [i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(data<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>]) <span style="color:#66d9ef">if</span> i <span style="color:#f92672">!=</span> <span style="color:#ae81ff">23</span>]
X, y <span style="color:#f92672">=</span> data[:, ix], data[:, <span style="color:#ae81ff">23</span>]
<span style="color:#75715e"># define modeling pipeline</span>
model <span style="color:#f92672">=</span> RandomForestClassifier()
imputer <span style="color:#f92672">=</span> SimpleImputer(strategy<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;mean&#39;</span>)
pipeline <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>[(<span style="color:#e6db74">&#39;i&#39;</span> , imputer), (<span style="color:#e6db74">&#39;m&#39;</span> , model)])
<span style="color:#75715e"># define model evaluation</span>
cv <span style="color:#f92672">=</span> RepeatedStratifiedKFold(n_splits<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, n_repeats<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
<span style="color:#75715e"># evaluate model</span>
scores <span style="color:#f92672">=</span> cross_val_score(pipeline, X, y, scoring<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;accuracy&#39;</span> , cv<span style="color:#f92672">=</span>cv, n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Mean Accuracy: </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (mean(scores), std(scores)))
</code></pre></div><p>Pipeline được đánh giá sử dụng 3 lần lặp của 10-Fold Cross-validation. Độ chính xác trung bình đo được là khoảng 86.4%, một kết quả tương đối tốt.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Mean Accuracy: <span style="color:#ae81ff">0.864</span> (<span style="color:#ae81ff">0.054</span>)
</code></pre></div><p>Chú ý rằng kết quả thực hiện của bạn có thể không giống ở đây. Nên chạy thử vài lần để tính kết quá trung bình.</p>
<h5 id="c-so-sánh-các-loại-statistical-imputation-khác-nhau">c, So sánh các loại Statistical Imputation khác nhau</h5>
<p>Như đã nói ở trên, Statistical Imputation có thể sử dụng Mean, Median, Mode, Constant &hellip; để thay thế cho Missing Data. Câu hỏi đặt ra là làm sao biết được cái nào là tốt nhất đối với bài toán của chúng ta? Câu trả lời là chúng ta không thể khẳng định ngay được, mà phải thông qua phép <em>thử-sai</em> mới có được kết quả chính xác.</p>
<p>Code dưới đây thực hiện áp dụng 4 loại Statistical Imputation khác nhau cho bài toán ở mục b, sau đó so sách các độ chính xác trung bình của mỗi loại với nhau:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># compare statistical imputation strategies for the horse colic dataset</span>
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> mean
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> std
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> RandomForestClassifier
<span style="color:#f92672">from</span> sklearn.impute <span style="color:#f92672">import</span> SimpleImputer
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> cross_val_score
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> RepeatedStratifiedKFold
<span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> Pipeline
<span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> pyplot

<span style="color:#75715e"># load dataset</span>
dataframe <span style="color:#f92672">=</span> read_csv(<span style="color:#e6db74">&#39;horse-colic.csv&#39;</span> , header<span style="color:#f92672">=</span>None, na_values<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;?&#39;</span>)
<span style="color:#75715e"># split into input and output elements</span>
data <span style="color:#f92672">=</span> dataframe<span style="color:#f92672">.</span>values
ix <span style="color:#f92672">=</span> [i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(data<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>]) <span style="color:#66d9ef">if</span> i <span style="color:#f92672">!=</span> <span style="color:#ae81ff">23</span>]
X, y <span style="color:#f92672">=</span> data[:, ix], data[:, <span style="color:#ae81ff">23</span>]
<span style="color:#75715e"># evaluate each strategy on the dataset</span>
results <span style="color:#f92672">=</span> list()
strategies <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;mean&#39;</span> , <span style="color:#e6db74">&#39;median&#39;</span> , <span style="color:#e6db74">&#39;most_frequent&#39;</span> , <span style="color:#e6db74">&#39;constant&#39;</span>]
<span style="color:#66d9ef">for</span> s <span style="color:#f92672">in</span> strategies:
    <span style="color:#75715e"># create the modeling pipeline</span>
    pipeline <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>[(<span style="color:#e6db74">&#39;i&#39;</span> , SimpleImputer(strategy<span style="color:#f92672">=</span>s)), (<span style="color:#e6db74">&#39;m&#39;</span>, RandomForestClassifier())])
    <span style="color:#75715e"># evaluate the model</span>
    cv <span style="color:#f92672">=</span> RepeatedStratifiedKFold(n_splits<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, n_repeats<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
    scores <span style="color:#f92672">=</span> cross_val_score(pipeline, X, y, scoring<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;accuracy&#39;</span> , cv<span style="color:#f92672">=</span>cv, n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)
    <span style="color:#75715e"># store results</span>
    results<span style="color:#f92672">.</span>append(scores)
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;&gt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (s, mean(scores), std(scores)))
<span style="color:#75715e"># plot model performance for comparison</span>
pyplot<span style="color:#f92672">.</span>boxplot(results, labels<span style="color:#f92672">=</span>strategies, showmeans<span style="color:#f92672">=</span>True)
pyplot<span style="color:#f92672">.</span>show()
</code></pre></div><ul>
<li>Kết quả so sánh độ chính xác trung bình và độ lệch chuẩn:</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">&gt;</span>mean <span style="color:#ae81ff">0.868</span> (<span style="color:#ae81ff">0.055</span>)
<span style="color:#f92672">&gt;</span>median <span style="color:#ae81ff">0.870</span> (<span style="color:#ae81ff">0.055</span>)
<span style="color:#f92672">&gt;</span>most_frequent <span style="color:#ae81ff">0.873</span> (<span style="color:#ae81ff">0.056</span>)
<span style="color:#f92672">&gt;</span>constant <span style="color:#ae81ff">0.880</span> (<span style="color:#ae81ff">0.048</span>)
</code></pre></div><p>Khá ngạc nhiên là Statictical Imputation với hằng số 0 lại cho kết quả cao nhất, 88%.</p>
<ul>
<li>Kết quả so sánh sự phân phối kết quả:</li>
</ul>


<div style="text-align:center">
   <img style="height:auto" src="/images/post/79_missing_data_1.png">
</div>


<p>Quan sát đồ thị <em>box-plot</em> ta thấy Statistical Imputation với hằng số 0 có độ phân tán kết quả thấp nhất giữa các lần thực hiện của nó.</p>
<p>Từ 2 nhận xét trên, có thể kết luận rằng Statistical Imputation với hằng số 0 là chiến thuật phù hợp nhất đối với bài toán của chúng ta.</p>
<h5 id="d-sử-dụng-simpleimputer-transform-khi-dự-đoán-dữ-liệu-mới">d, Sử dụng SimpleImputer Transform khi dự đoán dữ liệu mới</h5>
<p>Sau khi đã biết được loại Statistical Imputation phù hợp nhất, chúng ta mong muốn sử dụng nó để thực hiện việc dự đoán trên mẫu dữ liệu mới. Điều này có thể đạt được bằng cách định nghĩa một Pipeline, <em>fitting</em> nó trên toàn bộ dữ liệu, sau đó gọi hàm <em>predict()</em> và truyền vào mẫu dữ liệu mới cần dự đoán nhãn.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># constant imputation strategy and prediction for the horse colic dataset</span>
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> nan
<span style="color:#f92672">import</span> joblib
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> RandomForestClassifier
<span style="color:#f92672">from</span> sklearn.impute <span style="color:#f92672">import</span> SimpleImputer
<span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> Pipeline
<span style="color:#75715e"># load dataset</span>
dataframe <span style="color:#f92672">=</span> read_csv(<span style="color:#e6db74">&#39;horse-colic.csv&#39;</span>, header<span style="color:#f92672">=</span>None, na_values<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;?&#39;</span>)
<span style="color:#75715e"># split into input and output elements</span>
data <span style="color:#f92672">=</span> dataframe<span style="color:#f92672">.</span>values
ix <span style="color:#f92672">=</span> [i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(data<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>]) <span style="color:#66d9ef">if</span> i <span style="color:#f92672">!=</span> <span style="color:#ae81ff">23</span>]
X, y <span style="color:#f92672">=</span> data[:, ix], data[:, <span style="color:#ae81ff">23</span>]
<span style="color:#75715e"># create the modeling pipeline</span>
pipeline <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>[(<span style="color:#e6db74">&#39;i&#39;</span>, SimpleImputer(strategy<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;constant&#39;</span>)), (<span style="color:#e6db74">&#39;m&#39;</span>, RandomForestClassifier())])
<span style="color:#75715e"># fit the model</span>
pipeline<span style="color:#f92672">.</span>fit(X, y)

<span style="color:#75715e"># save pipeline as model file</span>
joblib<span style="color:#f92672">.</span>dump(pipeline, <span style="color:#e6db74">&#39;model.mod&#39;</span>) 
<span style="color:#75715e"># load model from file</span>
model <span style="color:#f92672">=</span> joblib<span style="color:#f92672">.</span>load(<span style="color:#e6db74">&#39;model.mod&#39;</span>)

<span style="color:#75715e"># define new data</span>
row <span style="color:#f92672">=</span> [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">530101</span>, <span style="color:#ae81ff">38.50</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>, nan, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>, nan, nan, nan, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">45.00</span>, <span style="color:#ae81ff">8.40</span>, nan, nan, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">11300</span>, <span style="color:#ae81ff">00000</span>, <span style="color:#ae81ff">00000</span>, <span style="color:#ae81ff">2</span>]
<span style="color:#75715e"># make a prediction</span>
yhat <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict([row])
<span style="color:#75715e"># summarize prediction</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Predicted Class: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> yhat[<span style="color:#ae81ff">0</span>])
</code></pre></div><p>Chạy code trên thu được kết quả:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Predicted Class: <span style="color:#ae81ff">2</span>
</code></pre></div><p>Chú ý quan trọng là Missing Data trong mẫu dữ liệu mới phải được đánh dấu là <em>nan</em> thì model mới có thể hiểu được.</p>
<h3 id="3-kết-luận">3. Kết luận</h3>
<p>Hôm nay, chúng ta đã tìm hiểu về phương pháp Statistical Imputation trong việc giải quyết vấn đề Missing Data. Đây là một phương pháp đơn giản, dễ thực hiện, và tỏ ra hiệu quả cao trong một số trường hợp cụ thể.</p>
<p>Toàn bộ code của bài này, các bạn có thể tham khảo tại <a href="https://github.com/tiensu/Data_Preparation_for_ML/tree/master/02_Data_Cleaning/Missing_Data/Statistical_Imputation">đây</a>.</p>
<p>Trong bài tiếp theo, chúng ta sẽ tìm hiểu về phương pháp tiếp theo trong việc xử lý Missing Data, đó là kNN Imputation. Mời các bạn đón đọc.</p>
<h3 id="4-tham-khảo">4. Tham khảo</h3>
<p>[1] Jason Brownlee, &ldquo;Data Preparation for Machine Learning&rdquo;, Book: <a href="https://machinelearningmastery.com/data-preparation-for-machine-learning/">https://machinelearningmastery.com/data-preparation-for-machine-learning/</a>.</p>

        </div>

        
        
      </div>
    </div>
  </div>
</section>



<footer>
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 text-center mb-5">
        <a href="https://tiensu.github.io/"><img src="https://tiensu.github.io/images/logo3.jpg" alt="SuNT&#39;s Blog | AI in Practical" style="height: auto"></a>
      </div>
               
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Contact Me</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="tel:0869644890"><i
                class="ti-mobile mr-3 text-primary"></i>0869644890</a></li>
          
                     
          <li class="mb-3"><i class="ti-location-pin mr-3 text-primary"></i>Hanoi, Vietnam</li>
          
                     
          <li class="mb-3"><a class="text-dark" href="mailto:tiensunguyen2103@gmail.com"><i
                class="ti-email mr-3 text-primary"></i>tiensunguyen2103@gmail.com</a>
          
          </li>
        </ul>
      </div>
      
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Social Contacts</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://www.facebook.com/tiensunguyen2103">Facebook</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://www.linkedin.com/in/su-nguyen-tien-aws%C2%AE-5ba74ba6/">Linkedin</a></li>
          
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Categories</h6>
        <ul class="list-unstyled">
          <li class="mb-3"><a class="text-dark"
              href="/categories/algorithm-optimization">Algorithm Optimization</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/attention">Attention</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/audio-classification">Audio Classification</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/autoencoder">Autoencoder</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/bert">BERT</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/cnn">CNN</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ctc">CTC</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-driff">Data Driff</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-imbalance">Data Imbalance</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-preparation">Data Preparation</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-science">Data Science</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/deep-learning">Deep Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/docker">Docker</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ebook">Ebook</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/eda">EDA</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ensemble-learning">Ensemble Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/face-recognition">Face Recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/game">Game</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/human-action-recognition">Human action recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/human-pose">Human pose</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/image-classification">Image Classification</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/kubernetes">Kubernetes</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/lstm">LSTM</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/machine-learning">Machine Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/mlops">MLOps</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/neural-network">Neural Network</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/nlp">NLP</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/object-detection">Object Detection</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ocr">OCR</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/one-shot-learning">One Shot Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/project-management">Project Management</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/recommender-system">Recommender System</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/rnn">RNN</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/scalability">Scalability</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/siamese-network">Siamese Network</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/speech-recognition">Speech Recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/speech-to-text">Speech To Text</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-classification">Text Classification</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-detection">Text Detection</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-generation">Text Generation</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-recognition">Text Recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/time-series">Time Series</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/transformer">Transformer</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/xgboost">XGBoost</a>
          </li>
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Quick Links</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://tiensu.github.io/about">About</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://tiensu.github.io/blog">Post</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://tiensu.github.io/contact">Contact</a></li>
          
        </ul>
      </div>
      <div class="col-12 border-top py-4 text-center">
        | copyright © 2021 <a href="tiensu.github.io">SuNT</a>. All Rights Reserved |
      </div>
    </div>
  </div>
</footer>

<script>
  var indexURL = "https://tiensu.github.io/index.json"
</script>

<!-- JS Plugins -->

<script src="https://tiensu.github.io/plugins/jQuery/jquery.min.js"></script>

<script src="https://tiensu.github.io/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://tiensu.github.io/plugins/slick/slick.min.js"></script>

<script src="https://tiensu.github.io/plugins/venobox/venobox.min.js"></script>

<script src="https://tiensu.github.io/plugins/search/fuse.min.js"></script>

<script src="https://tiensu.github.io/plugins/search/mark.js"></script>

<script src="https://tiensu.github.io/plugins/search/search.js"></script>

<!-- Main Script -->

<script src="https://tiensu.github.io/js/script.min.js"></script>




<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"></script>
<div id="js-cookie-box" class="cookie-box cookie-box-hide">
	This site uses cookies. By continuing to use this website, you agree to their use. <span id="js-cookie-button" class="btn btn-sm btn-primary ml-2">I Accept</span>
</div>
<script>
	(function ($) {
		const cookieBox = document.getElementById('js-cookie-box');
		const cookieButton = document.getElementById('js-cookie-button');
		if (!Cookies.get('cookie-box')) {
			cookieBox.classList.remove('cookie-box-hide');
			cookieButton.onclick = function () {
				Cookies.set('cookie-box', true, {
					expires:  2 
				});
				cookieBox.classList.add('cookie-box-hide');
			};
		}
	})(jQuery);
</script>


<style>
.cookie-box {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  text-align: center;
  z-index: 9999;
  padding: 1rem 2rem;
  background: rgb(71, 71, 71);
  transition: all .75s cubic-bezier(.19, 1, .22, 1);
  color: #fdfdfd;
}

.cookie-box-hide {
  display: none;
}
</style>
</body>
</html>