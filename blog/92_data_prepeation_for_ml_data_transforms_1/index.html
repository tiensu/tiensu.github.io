<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>SuNT&#39;s Blog | AI in Practical</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This is meta description">
  <meta name="author" content="SuNT">
  <meta name="generator" content="Hugo 0.80.0" />

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/themify-icons/themify-icons.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/venobox/venobox.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/css/override.css">
  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://tiensu.github.io/scss/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://tiensu.github.io/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://tiensu.github.io/images/favicon.png " type="image/x-icon">

  <!-- google analitycs -->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'Your ID', 'auto');
    ga('send', 'pageview');
  </script>

</head><body>
<!-- preloader start -->
<div class="preloader">
  
</div>
<!-- preloader end -->
<!-- navigation -->
<header class="navigation">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0">
      <a class="navbar-brand mobile-view" href="https://tiensu.github.io/"><img class="img-fluid"
          src="https://tiensu.github.io/images/logo3.jpg" alt="SuNT&#39;s Blog | AI in Practical"></a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="ti-menu h3"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <div class="desktop-view">
          <ul class="navbar-nav mr-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.facebook.com/tiensunguyen2103"><i class="ti-facebook"></i></a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.linkedin.com/in/su-nguyen-tien-aws%C2%AE-5ba74ba6/"><i class="ti-linkedin"></i></a>
            </li>
            
          </ul>
        </div>

        <a class="navbar-brand mx-auto desktop-view" href="https://tiensu.github.io/"><img class="img-fluid"
            src="https://tiensu.github.io/images/logo3.jpg" alt="SuNT&#39;s Blog | AI in Practical"></a>

        <ul class="navbar-nav">
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://tiensu.github.io/about">About</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://tiensu.github.io/blog">Post</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://tiensu.github.io/contact">Contact</a>
          </li>
          
          
        </ul>

        
        <!-- search -->
        <div class="search pl-lg-4">
          <button id="searchOpen" class="search-btn"><i class="ti-search"></i></button>
          <div class="search-wrapper">
            <form action="https://tiensu.github.io//search" class="h-100">
              <input class="search-box px-4" id="search-query" name="s" type="search" placeholder="Type & Hit Enter...">
            </form>
            <button id="searchClose" class="search-close"><i class="ti-close text-dark"></i></button>
          </div>
        </div>
        

        
      </div>
    </nav>
  </div>
  <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</header>
<!-- /navigation -->

<section class="section-sm">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 mx-auto">
        
        <a href="/categories/machine-learning"
          class="text-primary">Machine Learning</a>
        
        <a href="/categories/data-preparation"
          class="text-primary">Data Preparation</a>
        
        <h2>DP4ML - Data Transform - Phần 1 - How to Scale Numerical Data</h2>
        <div class="mb-3 post-meta">
          <span>By SuNT</span>
          
          <span class="border-bottom border-primary px-2 mx-1"></span>
          <span>16 July 2021</span>
          
        </div>
        
        <img src="https://tiensu.github.io/images/featured-post/92_data_transforms.png" class="img-fluid w-100 mb-4" alt="DP4ML - Data Transform - Phần 1 - How to Scale Numerical Data">
        
        <div class="content mb-5">
          <p>Bài thứ 14 trong chuỗi các bài viết về chủ đề Data Preparation cho các mô hình ML và là bài đầu tiên về về Data Transforms. Trong bài này, chúng ta sẽ tìm hiểu về các kiến thức cơ bản của Data Transforms, các kỹ thuật thực hiện Transforms cho features dạng numerical. Chúng ta cũng sẽ thực hành trên bộ dữ liệu thực tế.</p>
<h3 id="1-data-transforms">1. Data Transforms</h3>
<p>Trong một bộ dữ liệu, pham vi giá trị, sự phân phối, đơn vị đo, &hellip; của các features có thể khác nhau, tùy theo từng bài toán cụ thể.  Những sự khác biệt này làm tăng độ khó của vấn đề đang được mô hình hóa, hoặc tệ hơn là làm cho mô hình trở nên <em>thiên vị</em> hơn đối với những features có khoảng giá trị lớn hơn, có phân phối lớn hơn, &hellip; Đó là điều mà chúng ta hoàn toàn không mong muốn. Để hạn chế vấn đề này, dữ liệu cần phải được transform trước khi đưa vào để huấn luyện mô hình.</p>
<p>Hai kỹ thuật phổ biến nhất để thực hiện transform  đối với dữ liệu dạng numerical là Normalization và Standardization. Normalization chuyển đổi phạm vi giá trị của tất cả các features về từ 0 đến 1. Còn Standardization chuyển đổi phân phối của tất cả các features về phân phối chuẩn (<em>là phân phối mà có giá trị trung bình mean = 0, và độ lệch chuẩn std = 1</em>). Chúng ta sẽ tìm hiểu kỹ hơn về 2 kỹ thuật này trong các phần tiếp theo.</p>
<p>Việc thực hiện Data Transform áp dụng cho cả features và target.</p>
<h3 id="2-numerical-data-scaling-methods">2. Numerical Data Scaling Methods</h3>
<h4 id="21-data-normalization">2.1 Data Normalization</h4>
<p>Công thức tính giá trị của feature khi thực hiện normalized như sau:</p>


<div style="text-align-last:center">
   <p>$y = \frac{x- min}{max - min}$</p>
</div>


<p>Trong đó:</p>
<ul>
<li>x là giá trị ban đầu của feature.</li>
<li>y là giá trị sau khi normalized của feature.</li>
<li>min/max là giá trị lớn nhất/nhỏ nhất của feature trong toàn bộ tập dữ liệu.</li>
</ul>
<p>Thư viện scikit-learn cung cấp lớp <em>MinMaxScaler()</em> giúp chúng ta thực hiện công việc này một cách đơn giản. Các bước thực hiện như sau:</p>
<ul>
<li>Khai báo một instance của lớp <em>MinMaxScaler()</em>.</li>
<li>Fit instance vừa tạo trên tập train (<em>thực chất là tìm giá trị max/min của mỗi features trong tập train</em>) sưr dụng hàm <em>fit()</em>.</li>
<li>Áp dụng instance đã fit lên tập train/test, và các mẫu dữ liệu mới về sau, sử dụng hàm <em>transforms()</em>.</li>
</ul>
<p>Hai hàm <em>fit()</em> và <em>transform()</em> có thể gộp chung thành hàm <em>fit_transform()</em> nếu chúng ta chỉ có 1 tập dữ liệu cần xử lý (<em>VD: chỉ có tập train, &hellip;</em>)</p>
<p>Mặc định <em>MinMaxScaler()</em> sẽ đưa giá trị của features về khoảng [0,1], tuy nhiên, chúng ta có thể chỉ định một khoảng giá trị mong muốn khác thông qua tham số <em>feature_range</em>.</p>
<p>Ví dụ sử dụng <em>MinMaxScaler()</em> để thực hiện normalization:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># example of a normalization</span>
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> asarray
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> MinMaxScaler
<span style="color:#75715e"># define data</span>
data <span style="color:#f92672">=</span> asarray([[<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">0.001</span>],
				[<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0.05</span>],
				[<span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">0.005</span>],
				[<span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">0.07</span>],
				[<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0.1</span>]])
<span style="color:#66d9ef">print</span>(data)
<span style="color:#75715e"># define min max scaler</span>
scaler <span style="color:#f92672">=</span> MinMaxScaler()
<span style="color:#75715e"># transform data</span>
scaled <span style="color:#f92672">=</span> scaler<span style="color:#f92672">.</span>fit_transform(data)
<span style="color:#66d9ef">print</span>(scaled)
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">[[<span style="color:#ae81ff">1.0e+02</span> <span style="color:#ae81ff">1.0e-03</span>]
 [<span style="color:#ae81ff">8.0e+00</span> <span style="color:#ae81ff">5.0e-02</span>]
 [<span style="color:#ae81ff">5.0e+01</span> <span style="color:#ae81ff">5.0e-03</span>]
 [<span style="color:#ae81ff">8.8e+01</span> <span style="color:#ae81ff">7.0e-02</span>]
 [<span style="color:#ae81ff">4.0e+00</span> <span style="color:#ae81ff">1.0e-01</span>]]
[[<span style="color:#ae81ff">1.</span>         <span style="color:#ae81ff">0.</span>        ]
 [<span style="color:#ae81ff">0.04166667</span> <span style="color:#ae81ff">0.49494949</span>]
 [<span style="color:#ae81ff">0.47916667</span> <span style="color:#ae81ff">0.04040404</span>]
 [<span style="color:#ae81ff">0.875</span>      <span style="color:#ae81ff">0.6969697</span> ]
 [<span style="color:#ae81ff">0.</span>         <span style="color:#ae81ff">1.</span>        ]]
</code></pre></div><p>Rõ ràng là các giá trị bay giờ đều nằm trong khoảng [0,1]. Giá trị min trở thành 0, còn giá trị max trở thành 1.</p>
<p>Ở chiều ngược lại, chúng ta có thể chuyển đổi ngược các giá trị đã được normalized về lại giá trị ban đâu bằng cách sử dụng hàm <em>inverse_transform()</em> của lớp <em>MinMaxScaler()</em>. Việc này hữu ích khi chúng ta muốn tìm lại chính xác kết quả dự đoán của model, bởi vì kết quả trả về từ model là giá trị đã được normalized, mà chúng ta muốn biết giá trị khi chưa thực hiện normalize của nó.</p>
<h4 id="22-data-standardization">2.2 Data Standardization</h4>
<p>Công thức tính giá trị của feature khi thực hiện standardized như sau:


<div style="text-align-last:center">
   <p>$y = \frac{x- mean}{std}$</p>
</div>

</p>
<p>Trong đó:</p>
<ul>
<li>
<p>x là giá trị ban đầu của feature.</p>
</li>
<li>
<p>y là giá trị sau khi standardized feature.</p>
</li>
<li>
<p>mean là giá trị trung bình của feature.


<div style="text-align-last:center">
   <p>$y = \frac{1}{N} \sum _{i=1}^n x_i$</p>
</div>

</p>
</li>
<li>
<p>std là giá trị độ lệch chuẩn feature.</p>
</li>
</ul>


<div style="text-align-last:center">
   <p>$y = \sqrt{\frac{\sum_{i=1}^n(x_i-mean)^2}{N - 1}}$</p>
</div>


<p>Scikit-learn cung cấp lớp <em>StandardScaler()</em> để thực hiện hiện standardization. Cách sử dụng hoàn toàn tương tự như lớp <em>MinMaxScaler()</em>.</p>
<p>Ví dụ:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># example of a standardization</span>
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> asarray
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> StandardScaler
<span style="color:#75715e"># define data</span>
data <span style="color:#f92672">=</span> asarray([[<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">0.001</span>],
				[<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0.05</span>],
				[<span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">0.005</span>],
				[<span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">0.07</span>],
				[<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0.1</span>]])
<span style="color:#66d9ef">print</span>(data)
<span style="color:#75715e"># define standard scaler</span>
scaler <span style="color:#f92672">=</span> StandardScaler()
<span style="color:#75715e"># transform data</span>
scaled <span style="color:#f92672">=</span> scaler<span style="color:#f92672">.</span>fit_transform(data)
<span style="color:#66d9ef">print</span>(scaled)
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">[[<span style="color:#ae81ff">1.0e+02</span> <span style="color:#ae81ff">1.0e-03</span>]
 [<span style="color:#ae81ff">8.0e+00</span> <span style="color:#ae81ff">5.0e-02</span>]
 [<span style="color:#ae81ff">5.0e+01</span> <span style="color:#ae81ff">5.0e-03</span>]
 [<span style="color:#ae81ff">8.8e+01</span> <span style="color:#ae81ff">7.0e-02</span>]
 [<span style="color:#ae81ff">4.0e+00</span> <span style="color:#ae81ff">1.0e-01</span>]]
[[ <span style="color:#ae81ff">1.26398112</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.16389967</span>]
 [<span style="color:#f92672">-</span><span style="color:#ae81ff">1.06174414</span>  <span style="color:#ae81ff">0.12639634</span>]
 [ <span style="color:#ae81ff">0.</span>         <span style="color:#f92672">-</span><span style="color:#ae81ff">1.05856939</span>]
 [ <span style="color:#ae81ff">0.96062565</span>  <span style="color:#ae81ff">0.65304778</span>]
 [<span style="color:#f92672">-</span><span style="color:#ae81ff">1.16286263</span>  <span style="color:#ae81ff">1.44302493</span>]]
</code></pre></div><h3 id="3-thực-hành-các-kỹ-thuật-data-transforms">3. Thực hành các kỹ thuật Data Transforms</h3>
<h4 id="31-diebetes-dataset">3.1 Diebetes Dataset</h4>
<p>Chúng ta tiếp tục sử dụng bộ dữ liệu Diabetes đã được giới thiệu ở bài <a href="https://tiensu.github.io/blog/78_data_prepeation_for_ml_data_cleaning_missing_data_1/">thứ 4</a>.</p>
<p>Đầu tiên, hãy load bộ dữ liệu này lên:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># load and summarize the diabetes dataset</span>
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> pyplot
<span style="color:#75715e"># load the dataset</span>
dataset <span style="color:#f92672">=</span> read_csv(<span style="color:#e6db74">&#39;pima-indians-diabetes.csv&#39;</span>, header<span style="color:#f92672">=</span>None)
<span style="color:#75715e"># summarize the shape of the dataset</span>
<span style="color:#66d9ef">print</span>(dataset<span style="color:#f92672">.</span>shape)
<span style="color:#75715e"># summarize each variable</span>
<span style="color:#66d9ef">print</span>(dataset<span style="color:#f92672">.</span>describe())
<span style="color:#75715e"># histograms of the variables</span>
fig <span style="color:#f92672">=</span> dataset<span style="color:#f92672">.</span>hist(xlabelsize<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>, ylabelsize<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>)
[x<span style="color:#f92672">.</span>title<span style="color:#f92672">.</span>set_size(<span style="color:#ae81ff">4</span>) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> fig<span style="color:#f92672">.</span>ravel()]
<span style="color:#75715e"># show the plot</span>
pyplot<span style="color:#f92672">.</span>show()
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">(<span style="color:#ae81ff">768</span>, <span style="color:#ae81ff">9</span>)
                <span style="color:#ae81ff">0</span>           <span style="color:#ae81ff">1</span>           <span style="color:#ae81ff">2</span>           <span style="color:#ae81ff">3</span>           <span style="color:#ae81ff">4</span>           <span style="color:#ae81ff">5</span>           <span style="color:#ae81ff">6</span>           <span style="color:#ae81ff">7</span>           <span style="color:#ae81ff">8</span>
count  <span style="color:#ae81ff">768.000000</span>  <span style="color:#ae81ff">768.000000</span>  <span style="color:#ae81ff">768.000000</span>  <span style="color:#ae81ff">768.000000</span>  <span style="color:#ae81ff">768.000000</span>  <span style="color:#ae81ff">768.000000</span>  <span style="color:#ae81ff">768.000000</span>  <span style="color:#ae81ff">768.000000</span>  <span style="color:#ae81ff">768.000000</span>
mean     <span style="color:#ae81ff">3.845052</span>  <span style="color:#ae81ff">120.894531</span>   <span style="color:#ae81ff">69.105469</span>   <span style="color:#ae81ff">20.536458</span>   <span style="color:#ae81ff">79.799479</span>   <span style="color:#ae81ff">31.992578</span>    <span style="color:#ae81ff">0.471876</span>   <span style="color:#ae81ff">33.240885</span>    <span style="color:#ae81ff">0.348958</span>
std      <span style="color:#ae81ff">3.369578</span>   <span style="color:#ae81ff">31.972618</span>   <span style="color:#ae81ff">19.355807</span>   <span style="color:#ae81ff">15.952218</span>  <span style="color:#ae81ff">115.244002</span>    <span style="color:#ae81ff">7.884160</span>    <span style="color:#ae81ff">0.331329</span>   <span style="color:#ae81ff">11.760232</span>    <span style="color:#ae81ff">0.476951</span>
min      <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.078000</span>   <span style="color:#ae81ff">21.000000</span>    <span style="color:#ae81ff">0.000000</span>
<span style="color:#ae81ff">25</span><span style="color:#f92672">%</span>      <span style="color:#ae81ff">1.000000</span>   <span style="color:#ae81ff">99.000000</span>   <span style="color:#ae81ff">62.000000</span>    <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.000000</span>   <span style="color:#ae81ff">27.300000</span>    <span style="color:#ae81ff">0.243750</span>   <span style="color:#ae81ff">24.000000</span>    <span style="color:#ae81ff">0.000000</span>
<span style="color:#ae81ff">50</span><span style="color:#f92672">%</span>      <span style="color:#ae81ff">3.000000</span>  <span style="color:#ae81ff">117.000000</span>   <span style="color:#ae81ff">72.000000</span>   <span style="color:#ae81ff">23.000000</span>   <span style="color:#ae81ff">30.500000</span>   <span style="color:#ae81ff">32.000000</span>    <span style="color:#ae81ff">0.372500</span>   <span style="color:#ae81ff">29.000000</span>    <span style="color:#ae81ff">0.000000</span>
<span style="color:#ae81ff">75</span><span style="color:#f92672">%</span>      <span style="color:#ae81ff">6.000000</span>  <span style="color:#ae81ff">140.250000</span>   <span style="color:#ae81ff">80.000000</span>   <span style="color:#ae81ff">32.000000</span>  <span style="color:#ae81ff">127.250000</span>   <span style="color:#ae81ff">36.600000</span>    <span style="color:#ae81ff">0.626250</span>   <span style="color:#ae81ff">41.000000</span>    <span style="color:#ae81ff">1.000000</span>
max     <span style="color:#ae81ff">17.000000</span>  <span style="color:#ae81ff">199.000000</span>  <span style="color:#ae81ff">122.000000</span>   <span style="color:#ae81ff">99.000000</span>  <span style="color:#ae81ff">846.000000</span>   <span style="color:#ae81ff">67.100000</span>    <span style="color:#ae81ff">2.420000</span>   <span style="color:#ae81ff">81.000000</span>    <span style="color:#ae81ff">1.000000</span>
</code></pre></div>

   <div style="text-align:center">
      <img style="height:auto" src="/images/post/92_data_transforms_1.png">
   </div>


<p>Ta thấy, các features đang có khoảng giá trị và phân phối khác xa nhau.</p>
<p>Tiếp theo, tạo Base model với dữ liệu được giữ nguyên như ban đầu. Ở đây, mình lựa chọn thuật toán KNN cho đơn giản.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># evaluate knn on the raw diabetes dataset</span>
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> mean
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> std
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> cross_val_score
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> RepeatedStratifiedKFold
<span style="color:#f92672">from</span> sklearn.neighbors <span style="color:#f92672">import</span> KNeighborsClassifier
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> LabelEncoder
<span style="color:#75715e"># load the dataset</span>
dataset <span style="color:#f92672">=</span> read_csv(<span style="color:#e6db74">&#39;pima-indians-diabetes.csv&#39;</span>, header<span style="color:#f92672">=</span>None)
data <span style="color:#f92672">=</span> dataset<span style="color:#f92672">.</span>values
<span style="color:#75715e"># separate into input and output columns</span>
X, y <span style="color:#f92672">=</span> data[:, :<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], data[:, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
<span style="color:#75715e"># ensure inputs are floats and output is an integer label</span>
X <span style="color:#f92672">=</span> X<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;float32&#39;</span>)
y <span style="color:#f92672">=</span> LabelEncoder()<span style="color:#f92672">.</span>fit_transform(y<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;str&#39;</span>))
<span style="color:#75715e"># define and configure the model</span>
model <span style="color:#f92672">=</span> KNeighborsClassifier()
<span style="color:#75715e"># evaluate the model</span>
cv <span style="color:#f92672">=</span> RepeatedStratifiedKFold(n_splits<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, n_repeats<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
n_scores <span style="color:#f92672">=</span> cross_val_score(model, X, y, scoring<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;accuracy&#39;</span>, cv<span style="color:#f92672">=</span>cv, n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)
<span style="color:#75715e"># report model performance</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Accuracy: </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (mean(n_scores), std(n_scores)))
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Accuracy: <span style="color:#ae81ff">0.717</span> (<span style="color:#ae81ff">0.040</span>)
</code></pre></div><p>Base model cho ta độ chính xác là 71.7%. Hãy thử xem giá trị này có tăng lên khi áp dụng 2 kỹ thuật Data Transforms hay không?</p>
<h4 id="32-normalization-data">3.2 Normalization Data</h4>
<p>Áp dụng kỹ thuật normalization trên tập Diebetes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># visualize a minmax scaler transform of the diabetes dataset</span>
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> DataFrame
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> MinMaxScaler
<span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> pyplot
<span style="color:#75715e"># load the dataset</span>
dataset <span style="color:#f92672">=</span> read_csv(<span style="color:#e6db74">&#39;pima-indians-diabetes.csv&#39;</span>, header<span style="color:#f92672">=</span>None)
<span style="color:#75715e"># retrieve just the numeric input values</span>
data <span style="color:#f92672">=</span> dataset<span style="color:#f92672">.</span>values[:, :<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
<span style="color:#75715e"># perform a robust scaler transform of the dataset</span>
trans <span style="color:#f92672">=</span> MinMaxScaler()
data <span style="color:#f92672">=</span> trans<span style="color:#f92672">.</span>fit_transform(data)
<span style="color:#75715e"># convert the array back to a dataframe</span>
dataset <span style="color:#f92672">=</span> DataFrame(data)
<span style="color:#75715e"># summarize</span>
<span style="color:#66d9ef">print</span>(dataset<span style="color:#f92672">.</span>describe())
<span style="color:#75715e"># histograms of the variables</span>
fig <span style="color:#f92672">=</span> dataset<span style="color:#f92672">.</span>hist(xlabelsize<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>, ylabelsize<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>)
[x<span style="color:#f92672">.</span>title<span style="color:#f92672">.</span>set_size(<span style="color:#ae81ff">4</span>) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> fig<span style="color:#f92672">.</span>ravel()]
<span style="color:#75715e"># show the plot</span>
pyplot<span style="color:#f92672">.</span>show()
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">                <span style="color:#ae81ff">0</span>           <span style="color:#ae81ff">1</span>           <span style="color:#ae81ff">2</span>           <span style="color:#ae81ff">3</span>           <span style="color:#ae81ff">4</span>           <span style="color:#ae81ff">5</span>           <span style="color:#ae81ff">6</span>           <span style="color:#ae81ff">7</span>
count  <span style="color:#ae81ff">768.000000</span>  <span style="color:#ae81ff">768.000000</span>  <span style="color:#ae81ff">768.000000</span>  <span style="color:#ae81ff">768.000000</span>  <span style="color:#ae81ff">768.000000</span>  <span style="color:#ae81ff">768.000000</span>  <span style="color:#ae81ff">768.000000</span>  <span style="color:#ae81ff">768.000000</span>
mean     <span style="color:#ae81ff">0.226180</span>    <span style="color:#ae81ff">0.607510</span>    <span style="color:#ae81ff">0.566438</span>    <span style="color:#ae81ff">0.207439</span>    <span style="color:#ae81ff">0.094326</span>    <span style="color:#ae81ff">0.476790</span>    <span style="color:#ae81ff">0.168179</span>    <span style="color:#ae81ff">0.204015</span>
std      <span style="color:#ae81ff">0.198210</span>    <span style="color:#ae81ff">0.160666</span>    <span style="color:#ae81ff">0.158654</span>    <span style="color:#ae81ff">0.161134</span>    <span style="color:#ae81ff">0.136222</span>    <span style="color:#ae81ff">0.117499</span>    <span style="color:#ae81ff">0.141473</span>    <span style="color:#ae81ff">0.196004</span>
min      <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.000000</span>
<span style="color:#ae81ff">25</span><span style="color:#f92672">%</span>      <span style="color:#ae81ff">0.058824</span>    <span style="color:#ae81ff">0.497487</span>    <span style="color:#ae81ff">0.508197</span>    <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.000000</span>    <span style="color:#ae81ff">0.406855</span>    <span style="color:#ae81ff">0.070773</span>    <span style="color:#ae81ff">0.050000</span>
<span style="color:#ae81ff">50</span><span style="color:#f92672">%</span>      <span style="color:#ae81ff">0.176471</span>    <span style="color:#ae81ff">0.587940</span>    <span style="color:#ae81ff">0.590164</span>    <span style="color:#ae81ff">0.232323</span>    <span style="color:#ae81ff">0.036052</span>    <span style="color:#ae81ff">0.476900</span>    <span style="color:#ae81ff">0.125747</span>    <span style="color:#ae81ff">0.133333</span>
<span style="color:#ae81ff">75</span><span style="color:#f92672">%</span>      <span style="color:#ae81ff">0.352941</span>    <span style="color:#ae81ff">0.704774</span>    <span style="color:#ae81ff">0.655738</span>    <span style="color:#ae81ff">0.323232</span>    <span style="color:#ae81ff">0.150414</span>    <span style="color:#ae81ff">0.545455</span>    <span style="color:#ae81ff">0.234095</span>    <span style="color:#ae81ff">0.333333</span>
max      <span style="color:#ae81ff">1.000000</span>    <span style="color:#ae81ff">1.000000</span>    <span style="color:#ae81ff">1.000000</span>    <span style="color:#ae81ff">1.000000</span>    <span style="color:#ae81ff">1.000000</span>    <span style="color:#ae81ff">1.000000</span>    <span style="color:#ae81ff">1.000000</span>    <span style="color:#ae81ff">1.000000</span>
</code></pre></div>

   <div style="text-align:center">
      <img style="height:auto" src="/images/post/92_data_transforms_2.png">
   </div>


<p>Rõ ràng rằng tất các các features đều có giá trị nằm trong khoảng [0,1].</p>
<p>Thử đánh giá mô hình kNN trên tập Diebetes đã được normalized:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># visualize a standard scaler transform of the diabetes dataset</span>
<span style="color:#75715e"># evaluate knn on the diabetes dataset with minmax scaler transform</span>
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> mean
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> std
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> cross_val_score
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> RepeatedStratifiedKFold
<span style="color:#f92672">from</span> sklearn.neighbors <span style="color:#f92672">import</span> KNeighborsClassifier
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> LabelEncoder
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> MinMaxScaler
<span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> Pipeline
<span style="color:#75715e"># load the dataset</span>
dataset <span style="color:#f92672">=</span> read_csv(<span style="color:#e6db74">&#39;pima-indians-diabetes.csv&#39;</span>, header<span style="color:#f92672">=</span>None)
data <span style="color:#f92672">=</span> dataset<span style="color:#f92672">.</span>values
<span style="color:#75715e"># separate into input and output columns</span>
X, y <span style="color:#f92672">=</span> data[:, :<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], data[:, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
<span style="color:#75715e"># ensure inputs are floats and output is an integer label</span>
X <span style="color:#f92672">=</span> X<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;float32&#39;</span>)
y <span style="color:#f92672">=</span> LabelEncoder()<span style="color:#f92672">.</span>fit_transform(y<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;str&#39;</span>))
<span style="color:#75715e"># define the pipeline</span>
trans <span style="color:#f92672">=</span> MinMaxScaler()
model <span style="color:#f92672">=</span> KNeighborsClassifier()
pipeline <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>[(<span style="color:#e6db74">&#39;t&#39;</span>, trans), (<span style="color:#e6db74">&#39;m&#39;</span>, model)])
<span style="color:#75715e"># evaluate the pipeline</span>
cv <span style="color:#f92672">=</span> RepeatedStratifiedKFold(n_splits<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, n_repeats<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
n_scores <span style="color:#f92672">=</span> cross_val_score(pipeline, X, y, scoring<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;accuracy&#39;</span>, cv<span style="color:#f92672">=</span>cv, n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)
<span style="color:#75715e"># report pipeline performance</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Accuracy: </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (mean(n_scores), std(n_scores)))
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Accuracy: <span style="color:#ae81ff">0.739</span> (<span style="color:#ae81ff">0.053</span>)
</code></pre></div><p>Độ chính xác tăng từ 71.7% lên gần 74%. Một sự cải thiện đáng kể.</p>
<h4 id="33-standardization-data">3.3 Standardization Data</h4>
<p>Áp dụng kỹ thuật standardization trên tập Diebetes:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># visualize a standard scaler transform of the diabetes dataset</span>
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> DataFrame
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> StandardScaler
<span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> pyplot
<span style="color:#75715e"># load the dataset</span>
dataset <span style="color:#f92672">=</span> read_csv(<span style="color:#e6db74">&#39;pima-indians-diabetes.csv&#39;</span>, header<span style="color:#f92672">=</span>None)
<span style="color:#75715e"># retrieve just the numeric input values</span>
data <span style="color:#f92672">=</span> dataset<span style="color:#f92672">.</span>values[:, :<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
<span style="color:#75715e"># perform a robust scaler transform of the dataset</span>
trans <span style="color:#f92672">=</span> StandardScaler()
data <span style="color:#f92672">=</span> trans<span style="color:#f92672">.</span>fit_transform(data)
<span style="color:#75715e"># convert the array back to a dataframe</span>
dataset <span style="color:#f92672">=</span> DataFrame(data)
<span style="color:#75715e"># summarize</span>
<span style="color:#66d9ef">print</span>(dataset<span style="color:#f92672">.</span>describe())
<span style="color:#75715e"># histograms of the variables</span>
fig <span style="color:#f92672">=</span> dataset<span style="color:#f92672">.</span>hist(xlabelsize<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>, ylabelsize<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>)
[x<span style="color:#f92672">.</span>title<span style="color:#f92672">.</span>set_size(<span style="color:#ae81ff">4</span>) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> fig<span style="color:#f92672">.</span>ravel()]
<span style="color:#75715e"># show the plot</span>
pyplot<span style="color:#f92672">.</span>show()
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">                  <span style="color:#ae81ff">0</span>             <span style="color:#ae81ff">1</span>             <span style="color:#ae81ff">2</span>             <span style="color:#ae81ff">3</span>             <span style="color:#ae81ff">4</span>             <span style="color:#ae81ff">5</span>             <span style="color:#ae81ff">6</span>             <span style="color:#ae81ff">7</span>
count  <span style="color:#ae81ff">7.680000e+02</span>  <span style="color:#ae81ff">7.680000e+02</span>  <span style="color:#ae81ff">7.680000e+02</span>  <span style="color:#ae81ff">7.680000e+02</span>  <span style="color:#ae81ff">7.680000e+02</span>  <span style="color:#ae81ff">7.680000e+02</span>  <span style="color:#ae81ff">7.680000e+02</span>  <span style="color:#ae81ff">7.680000e+02</span>
mean  <span style="color:#f92672">-</span><span style="color:#ae81ff">6.476301e-17</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">9.251859e-18</span>  <span style="color:#ae81ff">1.503427e-17</span>  <span style="color:#ae81ff">1.006140e-16</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">3.006854e-17</span>  <span style="color:#ae81ff">2.590520e-16</span>  <span style="color:#ae81ff">2.451743e-16</span>  <span style="color:#ae81ff">1.931325e-16</span>
std    <span style="color:#ae81ff">1.000652e+00</span>  <span style="color:#ae81ff">1.000652e+00</span>  <span style="color:#ae81ff">1.000652e+00</span>  <span style="color:#ae81ff">1.000652e+00</span>  <span style="color:#ae81ff">1.000652e+00</span>  <span style="color:#ae81ff">1.000652e+00</span>  <span style="color:#ae81ff">1.000652e+00</span>  <span style="color:#ae81ff">1.000652e+00</span>
min   <span style="color:#f92672">-</span><span style="color:#ae81ff">1.141852e+00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">3.783654e+00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">3.572597e+00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.288212e+00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">6.928906e-01</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">4.060474e+00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.189553e+00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.041549e+00</span>
<span style="color:#ae81ff">25</span><span style="color:#f92672">%</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">8.448851e-01</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">6.852363e-01</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">3.673367e-01</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.288212e+00</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">6.928906e-01</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">5.955785e-01</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">6.889685e-01</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">7.862862e-01</span>
<span style="color:#ae81ff">50</span><span style="color:#f92672">%</span>   <span style="color:#f92672">-</span><span style="color:#ae81ff">2.509521e-01</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.218877e-01</span>  <span style="color:#ae81ff">1.496408e-01</span>  <span style="color:#ae81ff">1.545332e-01</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">4.280622e-01</span>  <span style="color:#ae81ff">9.419788e-04</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">3.001282e-01</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">3.608474e-01</span>
<span style="color:#ae81ff">75</span><span style="color:#f92672">%</span>    <span style="color:#ae81ff">6.399473e-01</span>  <span style="color:#ae81ff">6.057709e-01</span>  <span style="color:#ae81ff">5.632228e-01</span>  <span style="color:#ae81ff">7.190857e-01</span>  <span style="color:#ae81ff">4.120079e-01</span>  <span style="color:#ae81ff">5.847705e-01</span>  <span style="color:#ae81ff">4.662269e-01</span>  <span style="color:#ae81ff">6.602056e-01</span>
max    <span style="color:#ae81ff">3.906578e+00</span>  <span style="color:#ae81ff">2.444478e+00</span>  <span style="color:#ae81ff">2.734528e+00</span>  <span style="color:#ae81ff">4.921866e+00</span>  <span style="color:#ae81ff">6.652839e+00</span>  <span style="color:#ae81ff">4.455807e+00</span>  <span style="color:#ae81ff">5.883565e+00</span>  <span style="color:#ae81ff">4.063716e+00</span>
</code></pre></div>

   <div style="text-align:center">
      <img style="height:auto" src="/images/post/92_data_transforms_3.png">
   </div>


<p>Biểu đồ histogram của các features được tạo, mặc dù các phân phối trông không khác nhiều so với các phân phối của dữ liệu ban đầu, ngoại trừ tỷ lệ của chúng trên trục x, nhưng chúng ta có thể thấy rằng trung tâm của mỗi phân phối đều tập trung vào điểm giá trị 0.</p>
<p>Thử đánh giá mô hình kNN trên tập Diebetes đã được standardized:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># evaluate knn on the diabetes dataset with standard scaler transform</span>
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> mean
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> std
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> cross_val_score
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> RepeatedStratifiedKFold
<span style="color:#f92672">from</span> sklearn.neighbors <span style="color:#f92672">import</span> KNeighborsClassifier
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> LabelEncoder
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> StandardScaler
<span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> Pipeline
<span style="color:#75715e"># load the dataset</span>
dataset <span style="color:#f92672">=</span> read_csv(<span style="color:#e6db74">&#39;pima-indians-diabetes.csv&#39;</span>, header<span style="color:#f92672">=</span>None)
data <span style="color:#f92672">=</span> dataset<span style="color:#f92672">.</span>values
<span style="color:#75715e"># separate into input and output columns</span>
X, y <span style="color:#f92672">=</span> data[:, :<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], data[:, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
<span style="color:#75715e"># ensure inputs are floats and output is an integer label</span>
X <span style="color:#f92672">=</span> X<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;float32&#39;</span>)
y <span style="color:#f92672">=</span> LabelEncoder()<span style="color:#f92672">.</span>fit_transform(y<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;str&#39;</span>))
<span style="color:#75715e"># define the pipeline</span>
trans <span style="color:#f92672">=</span> StandardScaler()
model <span style="color:#f92672">=</span> KNeighborsClassifier()
pipeline <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>[(<span style="color:#e6db74">&#39;t&#39;</span>, trans), (<span style="color:#e6db74">&#39;m&#39;</span>, model)])
<span style="color:#75715e"># evaluate the pipeline</span>
cv <span style="color:#f92672">=</span> RepeatedStratifiedKFold(n_splits<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, n_repeats<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
n_scores <span style="color:#f92672">=</span> cross_val_score(pipeline, X, y, scoring<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;accuracy&#39;</span>, cv<span style="color:#f92672">=</span>cv, n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)
<span style="color:#75715e"># report pipeline performance</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Accuracy: </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (mean(n_scores), std(n_scores)))
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Accuracy: <span style="color:#ae81ff">0.741</span> (<span style="color:#ae81ff">0.050</span>)
</code></pre></div><p>Độ chính xác tăng lên một chút so với khi thực hiện normalization, từ 73.9% lên 74.1%.</p>
<h3 id="4-common-questions">4. Common Questions</h3>
<h4 id="q1-khi-nào-thì-nên-sử-dụng-normalizationstandardization">Q1: Khi nào thì nên sử dụng Normalization/Standardization?</h4>
<p>Ưu tiên lựa chọn theo thứ tự sau:</p>
<ul>
<li>Nếu dữ liệu của bạn có phân phối chuẩn hoặc gần chuẩn, thì nên áp dụng Standardization.</li>
<li>Nếu dữ liệu của bạn có số lượng lớn các features, phạm vi giá trị của các features đó khác nhau nhiều (<em>10s, 100s, 1000s, 0.01, 0.001, &hellip;</em>) thì nên sử dụng Normalization.</li>
<li>Thử cả 2 kỹ thuật nếu bạn có đủ thời gian.</li>
<li>Nếu dữ liệu của bạn không giống 3 trường hợp mô tả ở trên thì không cần thiết phải thực hiện Data Transforms.</li>
</ul>
<h4 id="q2-có-nên-thực-hiện-standardization-trước-sau-đó-lại-thực-hiện-normalization-không">Q2: Có nên thực hiện Standardization trước, sau đó lại thực hiện Normalization không?</h4>
<p>Việc kết hợp cả 2 kỹ thuật Data Transforms có thể là một ý tưởng tốt. Hãy thử nó nếu bạn có đủ thời gian.</p>
<h3 id="5-kết-luận">5. Kết luận</h3>
<p>Bài đầu tiên về chủ đề Data Transforms, mình đã giới thiệu 2 kỹ thuật thực hiện Data Transforms cho dữ liệu dạng numerical, đó là normalization và standardizaton.
Toàn bộ code của bài này, các bạn có thể tham khảo tại <a href="https://github.com/tiensu/Data_Preparation_for_ML/tree/master/04_Data_Transforms/Transform_Numerical_Data">đây</a>.</p>
<p>Bài tiếp theo chúng ta sẽ tìm hiểu cách thức thực hiện Data Transforms đối với dữ liệu có dạng categorical. Mời các bạn đón đọc.</p>
<h3 id="6-tham-khảo">6. Tham khảo</h3>
<p>[1] Jason Brownlee, &ldquo;Data Preparation for Machine Learning&rdquo;, Book: <a href="https://machinelearningmastery.com/data-preparation-for-machine-learning/">https://machinelearningmastery.com/data-preparation-for-machine-learning/</a>.</p>

        </div>

        
        
      </div>
    </div>
  </div>
</section>



<footer>
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 text-center mb-5">
        <a href="https://tiensu.github.io/"><img src="https://tiensu.github.io/images/logo3.jpg" alt="SuNT&#39;s Blog | AI in Practical" style="height: auto"></a>
      </div>
               
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Contact Me</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="tel:0869644890"><i
                class="ti-mobile mr-3 text-primary"></i>0869644890</a></li>
          
                     
          <li class="mb-3"><i class="ti-location-pin mr-3 text-primary"></i>Hanoi, Vietnam</li>
          
                     
          <li class="mb-3"><a class="text-dark" href="mailto:tiensunguyen2103@gmail.com"><i
                class="ti-email mr-3 text-primary"></i>tiensunguyen2103@gmail.com</a>
          
          </li>
        </ul>
      </div>
      
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Social Contacts</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://www.facebook.com/tiensunguyen2103">Facebook</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://www.linkedin.com/in/su-nguyen-tien-aws%C2%AE-5ba74ba6/">Linkedin</a></li>
          
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Categories</h6>
        <ul class="list-unstyled">
          <li class="mb-3"><a class="text-dark"
              href="/categories/algorithm-optimization">Algorithm Optimization</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/attention">Attention</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/audio-classification">Audio Classification</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/autoencoder">Autoencoder</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/bert">BERT</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/cnn">CNN</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ctc">CTC</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-driff">Data Driff</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-imbalance">Data Imbalance</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-preparation">Data Preparation</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-science">Data Science</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/deep-learning">Deep Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/docker">Docker</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ebook">Ebook</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/eda">EDA</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ensemble-learning">Ensemble Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/face-recognition">Face Recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/game">Game</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/human-action-recognition">Human action recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/human-pose">Human pose</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/image-classification">Image Classification</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/kubernetes">Kubernetes</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/lstm">LSTM</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/machine-learning">Machine Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/mlops">MLOps</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/neural-network">Neural Network</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/nlp">NLP</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/object-detection">Object Detection</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ocr">OCR</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/one-shot-learning">One Shot Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/project-management">Project Management</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/recommender-system">Recommender System</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/rnn">RNN</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/scalability">Scalability</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/siamese-network">Siamese Network</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/speech-recognition">Speech Recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/speech-to-text">Speech To Text</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-classification">Text Classification</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-detection">Text Detection</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-generation">Text Generation</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-recognition">Text Recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/time-series">Time Series</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/transformer">Transformer</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/xgboost">XGBoost</a>
          </li>
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Quick Links</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://tiensu.github.io/about">About</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://tiensu.github.io/blog">Post</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://tiensu.github.io/contact">Contact</a></li>
          
        </ul>
      </div>
      <div class="col-12 border-top py-4 text-center">
        | copyright © 2021 <a href="tiensu.github.io">SuNT</a>. All Rights Reserved |
      </div>
    </div>
  </div>
</footer>

<script>
  var indexURL = "https://tiensu.github.io/index.json"
</script>

<!-- JS Plugins -->

<script src="https://tiensu.github.io/plugins/jQuery/jquery.min.js"></script>

<script src="https://tiensu.github.io/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://tiensu.github.io/plugins/slick/slick.min.js"></script>

<script src="https://tiensu.github.io/plugins/venobox/venobox.min.js"></script>

<script src="https://tiensu.github.io/plugins/search/fuse.min.js"></script>

<script src="https://tiensu.github.io/plugins/search/mark.js"></script>

<script src="https://tiensu.github.io/plugins/search/search.js"></script>

<!-- Main Script -->

<script src="https://tiensu.github.io/js/script.min.js"></script>




<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"></script>
<div id="js-cookie-box" class="cookie-box cookie-box-hide">
	This site uses cookies. By continuing to use this website, you agree to their use. <span id="js-cookie-button" class="btn btn-sm btn-primary ml-2">I Accept</span>
</div>
<script>
	(function ($) {
		const cookieBox = document.getElementById('js-cookie-box');
		const cookieButton = document.getElementById('js-cookie-button');
		if (!Cookies.get('cookie-box')) {
			cookieBox.classList.remove('cookie-box-hide');
			cookieButton.onclick = function () {
				Cookies.set('cookie-box', true, {
					expires:  2 
				});
				cookieBox.classList.add('cookie-box-hide');
			};
		}
	})(jQuery);
</script>


<style>
.cookie-box {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  text-align: center;
  z-index: 9999;
  padding: 1rem 2rem;
  background: rgb(71, 71, 71);
  transition: all .75s cubic-bezier(.19, 1, .22, 1);
  color: #fdfdfd;
}

.cookie-box-hide {
  display: none;
}
</style>
</body>
</html>