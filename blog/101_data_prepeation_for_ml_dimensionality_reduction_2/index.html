<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>SuNT&#39;s Blog | AI in Practical</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This is meta description">
  <meta name="author" content="SuNT">
  <meta name="generator" content="Hugo 0.80.0" />

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/themify-icons/themify-icons.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/venobox/venobox.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/css/override.css">
  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://tiensu.github.io/scss/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://tiensu.github.io/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://tiensu.github.io/images/favicon.png " type="image/x-icon">

  <!-- google analitycs -->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'Your ID', 'auto');
    ga('send', 'pageview');
  </script>

</head><body>
<!-- preloader start -->
<div class="preloader">
  
</div>
<!-- preloader end -->
<!-- navigation -->
<header class="navigation">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0">
      <a class="navbar-brand mobile-view" href="https://tiensu.github.io/"><img class="img-fluid"
          src="https://tiensu.github.io/images/logo3.jpg" alt="SuNT&#39;s Blog | AI in Practical"></a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="ti-menu h3"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <div class="desktop-view">
          <ul class="navbar-nav mr-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.facebook.com/tiensunguyen2103"><i class="ti-facebook"></i></a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.linkedin.com/in/su-nguyen-tien-aws%C2%AE-5ba74ba6/"><i class="ti-linkedin"></i></a>
            </li>
            
          </ul>
        </div>

        <a class="navbar-brand mx-auto desktop-view" href="https://tiensu.github.io/"><img class="img-fluid"
            src="https://tiensu.github.io/images/logo3.jpg" alt="SuNT&#39;s Blog | AI in Practical"></a>

        <ul class="navbar-nav">
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://tiensu.github.io/about">About</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://tiensu.github.io/blog">Post</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://tiensu.github.io/contact">Contact</a>
          </li>
          
          
        </ul>

        
        <!-- search -->
        <div class="search pl-lg-4">
          <button id="searchOpen" class="search-btn"><i class="ti-search"></i></button>
          <div class="search-wrapper">
            <form action="https://tiensu.github.io//search" class="h-100">
              <input class="search-box px-4" id="search-query" name="s" type="search" placeholder="Type & Hit Enter...">
            </form>
            <button id="searchClose" class="search-close"><i class="ti-close text-dark"></i></button>
          </div>
        </div>
        

        
      </div>
    </nav>
  </div>
  <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</header>
<!-- /navigation -->

<section class="section-sm">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 mx-auto">
        
        <a href="/categories/machine-learning"
          class="text-primary">Machine Learning</a>
        
        <a href="/categories/data-preparation"
          class="text-primary">Data Preparation</a>
        
        <h2>DP4ML - Dimensionality Reduction - Phần 2 - How to Perform LDA and PCA Dimensionality Reduction</h2>
        <div class="mb-3 post-meta">
          <span>By SuNT</span>
          
          <span class="border-bottom border-primary px-2 mx-1"></span>
          <span>11 August 2021</span>
          
        </div>
        
        <img src="https://tiensu.github.io/images/featured-post/101_dimensionality_reduction.png" class="img-fluid w-100 mb-4" alt="DP4ML - Dimensionality Reduction - Phần 2 - How to Perform LDA and PCA Dimensionality Reduction">
        
        <div class="content mb-5">
          <p>Bài thứ 23 trong chuỗi các bài viết về chủ đề Data Preparation cho các mô hình ML và là bài thứ 2 về về Dimensionality Reduction. Trong bài này, chúng ta sẽ tìm hiểu về 3 thuật toán: LDA, PCA và SVD, cách sử dung chúng để thực hiện Dimensionality Reduction.</p>
<h3 id="1-linear-discriminant-analysis---lda">1. Linear Discriminant Analysis - LDA</h3>
<p>LDA thực chất là một thuật toán Linear ML cho bài toán Multiclass Classification. LDA hoạt động bằng cách tìm kiếm một sự kết hợp tuyến tính giữa các features để có thể tối đa hóa khả năng phân biệt giữa các classes và tối thiểu hóa khả năng phân biệt giữa các samples trong mỗi class.</p>
<p>Có một thuật toán khác, cũng viết tắt là LDA. Đó là Latent Dirichlet Allocation, chuyên dùng cho Dimensionality Reduction trong bài toán Text Classification. Nhưng nó nằm ngoài phạm vi bài này, mình chỉ đưa ra đây để về sau nếu có gặp thì các bạn đỡ bối rối.</p>
<p>Trong scikit-learn, LDA được implemented bởi class <em>LinearDiscriminantAnalysis()</em>. Cách sử dụng tương tự như các kỹ thuật transforms khác. Tham số cần quan tâm là <em>n_components</em> chỉ ra số chiều còn lại của dữ liệu sau khi giảm. Giá trị tối đa của nó = số lượng (classes - 1).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">...</span>
<span style="color:#75715e"># prepare dataset</span>
data <span style="color:#f92672">=</span> <span style="color:#f92672">...</span>
<span style="color:#75715e"># define transform</span>
lda <span style="color:#f92672">=</span> LinearDiscriminantAnalysis()
<span style="color:#75715e"># prepare transform on dataset</span>
lda<span style="color:#f92672">.</span>fit(data)
<span style="color:#75715e"># apply transform to dataset</span>
transformed <span style="color:#f92672">=</span> lda<span style="color:#f92672">.</span>transform(data)
</code></pre></div><p>Nếu sử dụng kết hợp với model trong một pipeline thì sẽ như sau:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">...</span>
<span style="color:#75715e"># define the pipeline</span>
steps <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;lda&#39;</span>, LinearDiscriminantAnalysis()), (<span style="color:#e6db74">&#39;m&#39;</span>, GaussianNB())]
model <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>steps)
<span style="color:#f92672">...</span>
<span style="color:#75715e"># define the pipeline</span>
steps <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;s&#39;</span>, StandardScaler()), (<span style="color:#e6db74">&#39;lda&#39;</span>, LinearDiscriminantAnalysis()), (<span style="color:#e6db74">&#39;m&#39;</span>, GaussianNB())]
model <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>steps)
</code></pre></div><h3 id="2-principal-component-analysis---pca">2. Principal Component Analysis - PCA</h3>
<p>PCA có lẽ là thuật toán Dimensionality Reduction phổ biến nhất. Khi nhắc đến Dimensionality Reduction, người ta thường nghĩ ngay đến PCA đầu tiên.</p>
<p>PCA hoạt động theo nguyên tắc <em>feature projection</em>, tức là từ m-dimension ban đầu của dữ liệu trong không gian S, thông qua một pháp <em>ánh xạ</em> sẽ được chuyển thành n-dimension trong không gian R mà m &gt; n.</p>
<p>Trong scikit-learn, PCA được implemented bởi class <em>PCA</em>. Các sử dụng tương tự như các kỹ thuật transforms khác. Tham số cần chú ý của class PCA cũng là <em>n_components</em> như của LDA.</p>
<p>Cách sử dụng PCA:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">...</span>
data <span style="color:#f92672">=</span> <span style="color:#f92672">...</span>
<span style="color:#75715e"># define transform</span>
pca <span style="color:#f92672">=</span> PCA()
<span style="color:#75715e"># prepare transform on dataset</span>
pca<span style="color:#f92672">.</span>fit(data)
<span style="color:#75715e"># apply transform to dataset</span>
transformed <span style="color:#f92672">=</span> pca<span style="color:#f92672">.</span>transform(data)
</code></pre></div><p>Nếu kết hợp với pipeline:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">...</span>
<span style="color:#75715e"># define the pipeline</span>
steps <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;pca&#39;</span>, PCA()), (<span style="color:#e6db74">&#39;m&#39;</span>, LogisticRegression())]
model <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>steps)
<span style="color:#f92672">...</span>
<span style="color:#75715e"># define the pipeline</span>
steps <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;norm&#39;</span>, MinMaxScaler()), (<span style="color:#e6db74">&#39;pca&#39;</span>, PCA()), (<span style="color:#e6db74">&#39;m&#39;</span>, LogisticRegression())]
model <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>steps)
</code></pre></div><h3 id="3-singular-value-decomposition---svd">3. Singular Value Decomposition - SVD</h3>
<p>SVD cũng là một trong những thuật toán Dimensionality Reduction phổ biến. Cách thức hoạt động của nó tương tự như PCA, chỉ có điều nó thường được áp dụng cho các tập dữ liệu bị <em>sparse</em>, tức là dữ liệu mà ở đó có rất nhiều các giá trị của các features bằng 0.</p>
<p>Một số VD của <em>sparse data</em> phù hợp để áp dụng SVD là:</p>
<ul>
<li>Recommender System</li>
<li>Customer-Production purchases</li>
<li>User-Song Listener Counts</li>
<li>User-Movie Ratings</li>
<li>Text Classification</li>
<li>One Hot Encoding</li>
<li>Bag-of-Words Counts</li>
<li>TF/IDF</li>
</ul>
<p>Trong scikit-learn, SVD được implemented bởi class <em>TruncatedSVD()</em>. Cách sử dụng tương tự như các kỹ thuật transforms khác. Tham số cần quan tâm là <em>n_components</em>.</p>
<p>Cách sử dụng SVD:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">...</span>
data <span style="color:#f92672">=</span> <span style="color:#f92672">...</span>
<span style="color:#75715e"># define transform</span>
svd <span style="color:#f92672">=</span> TruncatedSVD()
<span style="color:#75715e"># prepare transform on dataset</span>
svd<span style="color:#f92672">.</span>fit(data)
<span style="color:#75715e"># apply transform to dataset</span>
transformed <span style="color:#f92672">=</span> svd<span style="color:#f92672">.</span>transform(data)
</code></pre></div><p>Nếu kết hợp vào pipeline:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">...</span>
<span style="color:#75715e"># define the pipeline</span>
steps <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;svd&#39;</span>, TruncatedSVD()), (<span style="color:#e6db74">&#39;m&#39;</span>, LogisticRegression())]
model <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>steps)
<span style="color:#f92672">...</span>
<span style="color:#75715e"># define the pipeline</span>
steps <span style="color:#f92672">=</span> [( <span style="color:#e6db74">&#39;norm&#39;</span>, MinMaxScaler()), (<span style="color:#e6db74">&#39;svd&#39;</span>, TruncatedSVD()), (<span style="color:#e6db74">&#39;m&#39;</span>, LogisticRegression())]
model <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>steps)
</code></pre></div><h3 id="2-thực-hành-lda-pca-và-svd">2. Thực hành LDA, PCA và SVD</h3>
<h4 id="21-tạo-dataset">2.1 Tạo Dataset</h4>
<p>Chúng ta sẽ tạo ra một tập gồm có 1000 mẫu dữ liệu, 10 classes, số chiều là 20, sử dụng hàm <em>make_classification()</em>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># test classification dataset</span>
<span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_classification
<span style="color:#75715e"># define dataset</span>
X, y <span style="color:#f92672">=</span> make_classification(n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>, n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>, n_informative<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, n_redundant<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>, n_classes<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
<span style="color:#75715e"># summarize the dataset</span>
<span style="color:#66d9ef">print</span>(X<span style="color:#f92672">.</span>shape, y<span style="color:#f92672">.</span>shape)
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">(<span style="color:#ae81ff">1000</span>, <span style="color:#ae81ff">100</span>) (<span style="color:#ae81ff">1000</span>,)
</code></pre></div><h4 id="22-thực-hành-lda">2.2 Thực hành LDA</h4>
<h5 id="a-áp-dụng-lda-và-naive-bayes-để-mô-hình-hóa-dữ-liệu">a, Áp dụng LDA và Naive Bayes để mô hình hóa dữ liệu</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># evaluate lda with naive bayes algorithm for classification</span>
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> mean
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> std
<span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_classification
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> cross_val_score
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> RepeatedStratifiedKFold
<span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> Pipeline
<span style="color:#f92672">from</span> sklearn.discriminant_analysis <span style="color:#f92672">import</span> LinearDiscriminantAnalysis
<span style="color:#f92672">from</span> sklearn.naive_bayes <span style="color:#f92672">import</span> GaussianNB
<span style="color:#75715e"># define dataset</span>
X, y <span style="color:#f92672">=</span> make_classification(n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>, n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>, n_informative<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, n_redundant<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>, n_classes<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
<span style="color:#75715e"># define the pipeline</span>
steps <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;lda&#39;</span>, LinearDiscriminantAnalysis(n_components<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)), (<span style="color:#e6db74">&#39;m&#39;</span>, GaussianNB())]
model <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>steps)
<span style="color:#75715e"># evaluate model</span>
cv <span style="color:#f92672">=</span> RepeatedStratifiedKFold(n_splits<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, n_repeats<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
n_scores <span style="color:#f92672">=</span> cross_val_score(model, X, y, scoring<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;accuracy&#39;</span>, cv<span style="color:#f92672">=</span>cv, n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)
<span style="color:#75715e"># report performance</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Accuracy: </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (mean(n_scores), std(n_scores)))
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Accuracy: <span style="color:#ae81ff">0.366</span> (<span style="color:#ae81ff">0.052</span>)
</code></pre></div><h5 id="b-tune-n_components-của-lda">b, Tune n_components của LDA</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># compare lda number of components with naive bayes algorithm for classification</span>
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> mean
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> std
<span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_classification
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> cross_val_score
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> RepeatedStratifiedKFold
<span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> Pipeline
<span style="color:#f92672">from</span> sklearn.discriminant_analysis <span style="color:#f92672">import</span> LinearDiscriminantAnalysis
<span style="color:#f92672">from</span> sklearn.naive_bayes <span style="color:#f92672">import</span> GaussianNB
<span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> pyplot

<span style="color:#75715e"># get the dataset</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_dataset</span>():
	X, y <span style="color:#f92672">=</span> make_classification(n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>, n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>, n_informative<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, n_redundant<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>, n_classes<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
	<span style="color:#66d9ef">return</span> X, y

<span style="color:#75715e"># get a list of models to evaluate</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_models</span>():
	models <span style="color:#f92672">=</span> dict()
	<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>):
		steps <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;lda&#39;</span>, LinearDiscriminantAnalysis(n_components<span style="color:#f92672">=</span>i)), (<span style="color:#e6db74">&#39;m&#39;</span>, GaussianNB())]
		models[str(i)] <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>steps)
	<span style="color:#66d9ef">return</span> models

<span style="color:#75715e"># evaluate a given model using cross-validation</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">evaluate_model</span>(model, X, y):
	cv <span style="color:#f92672">=</span> RepeatedStratifiedKFold(n_splits<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, n_repeats<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
	scores <span style="color:#f92672">=</span> cross_val_score(model, X, y, scoring<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;accuracy&#39;</span>, cv<span style="color:#f92672">=</span>cv, n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)
	<span style="color:#66d9ef">return</span> scores

<span style="color:#75715e"># define dataset</span>
X, y <span style="color:#f92672">=</span> get_dataset()
<span style="color:#75715e"># get the models to evaluate</span>
models <span style="color:#f92672">=</span> get_models()
<span style="color:#75715e"># evaluate the models and store results</span>
results, names <span style="color:#f92672">=</span> list(), list()
<span style="color:#66d9ef">for</span> name, model <span style="color:#f92672">in</span> models<span style="color:#f92672">.</span>items():
	scores <span style="color:#f92672">=</span> evaluate_model(model, X, y)
	results<span style="color:#f92672">.</span>append(scores)
	names<span style="color:#f92672">.</span>append(name)
	<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;&gt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (name, mean(scores), std(scores)))
<span style="color:#75715e"># plot model performance for comparison</span>
pyplot<span style="color:#f92672">.</span>boxplot(results, labels<span style="color:#f92672">=</span>names, showmeans<span style="color:#f92672">=</span>True)
pyplot<span style="color:#f92672">.</span>show()
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0.148</span> (<span style="color:#ae81ff">0.030</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0.209</span> (<span style="color:#ae81ff">0.040</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0.265</span> (<span style="color:#ae81ff">0.044</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">4</span> <span style="color:#ae81ff">0.280</span> (<span style="color:#ae81ff">0.047</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">5</span> <span style="color:#ae81ff">0.296</span> (<span style="color:#ae81ff">0.051</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0.324</span> (<span style="color:#ae81ff">0.054</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0.341</span> (<span style="color:#ae81ff">0.045</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">8</span> <span style="color:#ae81ff">0.363</span> (<span style="color:#ae81ff">0.048</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">9</span> <span style="color:#ae81ff">0.366</span> (<span style="color:#ae81ff">0.052</span>)
</code></pre></div>

   <div style="text-align:center">
      <img style="height:auto" src="/images/post/101_dimensionality_reduction_1.png">
   </div>


<p><em>n_components=9</em> cho ta kết quả tốt nhất trong tất cả.</p>
<h5 id="c-dự-đoán-trên-mẫu-dữ-liệu-mới">c, Dự đoán trên mẫu dữ liệu mới</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># make predictions using lda with naive bayes</span>
<span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_classification
<span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> Pipeline
<span style="color:#f92672">from</span> sklearn.discriminant_analysis <span style="color:#f92672">import</span> LinearDiscriminantAnalysis
<span style="color:#f92672">from</span> sklearn.naive_bayes <span style="color:#f92672">import</span> GaussianNB
<span style="color:#75715e"># define dataset</span>
X, y <span style="color:#f92672">=</span> make_classification(n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>, n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>, n_informative<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, n_redundant<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>, n_classes<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
<span style="color:#75715e"># define the model</span>
steps <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;lda&#39;</span>, LinearDiscriminantAnalysis(n_components<span style="color:#f92672">=</span><span style="color:#ae81ff">9</span>)), (<span style="color:#e6db74">&#39;m&#39;</span>, GaussianNB())]
model <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>steps)
<span style="color:#75715e"># fit the model on the whole dataset</span>
model<span style="color:#f92672">.</span>fit(X, y)
<span style="color:#75715e"># make a single prediction</span>
row <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">2.3548775</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1.69674567</span>, <span style="color:#ae81ff">1.6193882</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1.19668862</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2.85422348</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2.00998376</span>, <span style="color:#ae81ff">16.56128782</span>, <span style="color:#ae81ff">2.57257575</span>, <span style="color:#ae81ff">9.93779782</span>, <span style="color:#ae81ff">0.43415008</span>, <span style="color:#ae81ff">6.08274911</span>, <span style="color:#ae81ff">2.12689336</span>, <span style="color:#ae81ff">1.70100279</span>, <span style="color:#ae81ff">3.32160983</span>, <span style="color:#ae81ff">13.02048541</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">3.05034488</span>, <span style="color:#ae81ff">2.06346747</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">3.33390362</span>, <span style="color:#ae81ff">2.45147541</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1.23455205</span>]]
yhat <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(row)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Predicted Class: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> yhat[<span style="color:#ae81ff">0</span>])
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Predicted Class: <span style="color:#ae81ff">6</span>
</code></pre></div><h4 id="23-thực-hành-pca">2.3 Thực hành PCA</h4>
<h5 id="a-áp-dụng-pca-và-logistic-regression-để-mô-hình-hóa-dữ-liệu">a, Áp dụng PCA và Logistic Regression để mô hình hóa dữ liệu</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># evaluate pca with logistic regression algorithm for classification</span>
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> mean
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> std
<span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_classification
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> cross_val_score
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> RepeatedStratifiedKFold
<span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> Pipeline
<span style="color:#f92672">from</span> sklearn.decomposition <span style="color:#f92672">import</span> PCA
<span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
<span style="color:#75715e"># define dataset</span>
X, y <span style="color:#f92672">=</span> make_classification(n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>, n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>, n_informative<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, n_redundant<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>)
<span style="color:#75715e"># define the pipeline</span>
steps <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;pca&#39;</span>, PCA(n_components<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)), (<span style="color:#e6db74">&#39;m&#39;</span>, LogisticRegression())]
model <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>steps)
<span style="color:#75715e"># evaluate model</span>
cv <span style="color:#f92672">=</span> RepeatedStratifiedKFold(n_splits<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, n_repeats<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
n_scores <span style="color:#f92672">=</span> cross_val_score(model, X, y, scoring<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;accuracy&#39;</span>, cv<span style="color:#f92672">=</span>cv, n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)
<span style="color:#75715e"># report performance</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Accuracy: </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (mean(n_scores), std(n_scores)))
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Accuracy: <span style="color:#ae81ff">0.816</span> (<span style="color:#ae81ff">0.034</span>)
</code></pre></div><h5 id="b-tune-n_components-của-pca">b, Tune n_components của PCA</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># compare pca number of components with logistic regression algorithm for classification</span>
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> mean
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> std
<span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_classification
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> cross_val_score
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> RepeatedStratifiedKFold
<span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> Pipeline
<span style="color:#f92672">from</span> sklearn.decomposition <span style="color:#f92672">import</span> PCA
<span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
<span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> pyplot

<span style="color:#75715e"># get the dataset</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_dataset</span>():
	X, y <span style="color:#f92672">=</span> make_classification(n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>, n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>, n_informative<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, n_redundant<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>)
	<span style="color:#66d9ef">return</span> X, y

<span style="color:#75715e"># get a list of models to evaluate</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_models</span>():
	models <span style="color:#f92672">=</span> dict()
	<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">21</span>):
		steps <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;pca&#39;</span>, PCA(n_components<span style="color:#f92672">=</span>i)), (<span style="color:#e6db74">&#39;m&#39;</span>, LogisticRegression())]
		models[str(i)] <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>steps)
	<span style="color:#66d9ef">return</span> models

<span style="color:#75715e"># evaluate a given model using cross-validation</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">evaluate_model</span>(model, X, y):
	cv <span style="color:#f92672">=</span> RepeatedStratifiedKFold(n_splits<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, n_repeats<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
	scores <span style="color:#f92672">=</span> cross_val_score(model, X, y, scoring<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;accuracy&#39;</span>, cv<span style="color:#f92672">=</span>cv, n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)
	<span style="color:#66d9ef">return</span> scores

<span style="color:#75715e"># define dataset</span>
X, y <span style="color:#f92672">=</span> get_dataset()
<span style="color:#75715e"># get the models to evaluate</span>
models <span style="color:#f92672">=</span> get_models()
<span style="color:#75715e"># evaluate the models and store results</span>
results, names <span style="color:#f92672">=</span> list(), list()
<span style="color:#66d9ef">for</span> name, model <span style="color:#f92672">in</span> models<span style="color:#f92672">.</span>items():
	scores <span style="color:#f92672">=</span> evaluate_model(model, X, y)
	results<span style="color:#f92672">.</span>append(scores)
	names<span style="color:#f92672">.</span>append(name)
	<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;&gt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (name, mean(scores), std(scores)))
<span style="color:#75715e"># plot model performance for comparison</span>
pyplot<span style="color:#f92672">.</span>boxplot(results, labels<span style="color:#f92672">=</span>names, showmeans<span style="color:#f92672">=</span>True)
pyplot<span style="color:#f92672">.</span>xticks(rotation<span style="color:#f92672">=</span><span style="color:#ae81ff">45</span>)
pyplot<span style="color:#f92672">.</span>show()
</code></pre></div><p>Kêt quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0.542</span> (<span style="color:#ae81ff">0.048</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0.713</span> (<span style="color:#ae81ff">0.048</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0.720</span> (<span style="color:#ae81ff">0.053</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">4</span> <span style="color:#ae81ff">0.723</span> (<span style="color:#ae81ff">0.051</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">5</span> <span style="color:#ae81ff">0.725</span> (<span style="color:#ae81ff">0.052</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0.730</span> (<span style="color:#ae81ff">0.046</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0.805</span> (<span style="color:#ae81ff">0.036</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">8</span> <span style="color:#ae81ff">0.800</span> (<span style="color:#ae81ff">0.037</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">9</span> <span style="color:#ae81ff">0.814</span> (<span style="color:#ae81ff">0.036</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">0.816</span> (<span style="color:#ae81ff">0.034</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">11</span> <span style="color:#ae81ff">0.819</span> (<span style="color:#ae81ff">0.035</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">12</span> <span style="color:#ae81ff">0.819</span> (<span style="color:#ae81ff">0.038</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">13</span> <span style="color:#ae81ff">0.819</span> (<span style="color:#ae81ff">0.035</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">0.853</span> (<span style="color:#ae81ff">0.029</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">15</span> <span style="color:#ae81ff">0.865</span> (<span style="color:#ae81ff">0.027</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">16</span> <span style="color:#ae81ff">0.865</span> (<span style="color:#ae81ff">0.027</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">17</span> <span style="color:#ae81ff">0.865</span> (<span style="color:#ae81ff">0.027</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">18</span> <span style="color:#ae81ff">0.865</span> (<span style="color:#ae81ff">0.027</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">19</span> <span style="color:#ae81ff">0.865</span> (<span style="color:#ae81ff">0.027</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">20</span> <span style="color:#ae81ff">0.865</span> (<span style="color:#ae81ff">0.027</span>)
</code></pre></div>

   <div style="text-align:center">
      <img style="height:auto" src="/images/post/101_dimensionality_reduction_1.png">
   </div>


<p><em>n_components</em> từ 15 đến 20 cho kết quả tốt nhất.</p>
<h4 id="c-tạo-dự-đoán-trên-mẫu-dữ-liệu-mới">c, Tạo dự đoán trên mẫu dữ liệu mới</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># make predictions using pca with logistic regression</span>
<span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_classification
<span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> Pipeline
<span style="color:#f92672">from</span> sklearn.decomposition <span style="color:#f92672">import</span> PCA
<span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
<span style="color:#75715e"># define dataset</span>
X, y <span style="color:#f92672">=</span> make_classification(n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>, n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>, n_informative<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, n_redundant<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>)
<span style="color:#75715e"># define the model</span>
steps <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;pca&#39;</span>, PCA(n_components<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>)), (<span style="color:#e6db74">&#39;m&#39;</span>, LogisticRegression())]
model <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>steps)
<span style="color:#75715e"># fit the model on the whole dataset</span>
model<span style="color:#f92672">.</span>fit(X, y)
<span style="color:#75715e"># make a single prediction</span>
row <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">0.2929949</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4.21223056</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1.288332</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2.17849815</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">0.64527665</span>, <span style="color:#ae81ff">2.58097719</span>, <span style="color:#ae81ff">0.28422388</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">7.1827928</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1.91211104</span>, <span style="color:#ae81ff">2.73729512</span>, <span style="color:#ae81ff">0.81395695</span>, <span style="color:#ae81ff">3.96973717</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2.66939799</span>, <span style="color:#ae81ff">3.34692332</span>, <span style="color:#ae81ff">4.19791821</span>, <span style="color:#ae81ff">0.99990998</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">0.30201875</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4.43170633</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2.82646737</span>, <span style="color:#ae81ff">0.44916808</span>]]
yhat <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(row)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Predicted Class: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> yhat[<span style="color:#ae81ff">0</span>])
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Predicted Class: <span style="color:#ae81ff">1</span>
</code></pre></div><h4 id="24-thực-hành-svd">2.4 Thực hành SVD</h4>
<h4 id="a-áp-dụng-svd-và-logistic-regression-để-mô-hình-hóa-dữ-liệu">a. Áp dụng SVD và Logistic Regression để mô hình hóa dữ liệu</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># evaluate svd with logistic regression algorithm for classification</span>
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> mean
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> std
<span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_classification
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> cross_val_score
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> RepeatedStratifiedKFold
<span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> Pipeline
<span style="color:#f92672">from</span> sklearn.decomposition <span style="color:#f92672">import</span> TruncatedSVD
<span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
<span style="color:#75715e"># define dataset</span>
X, y <span style="color:#f92672">=</span> make_classification(n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>, n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>, n_informative<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, n_redundant<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>)
<span style="color:#75715e"># define the pipeline</span>
steps <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;svd&#39;</span>, TruncatedSVD(n_components<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)), (<span style="color:#e6db74">&#39;m&#39;</span>, LogisticRegression())]
model <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>steps)
<span style="color:#75715e"># evaluate model</span>
cv <span style="color:#f92672">=</span> RepeatedStratifiedKFold(n_splits<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, n_repeats<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
n_scores <span style="color:#f92672">=</span> cross_val_score(model, X, y, scoring<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;accuracy&#39;</span>, cv<span style="color:#f92672">=</span>cv, n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)
<span style="color:#75715e"># report performance</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Accuracy: </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (mean(n_scores), std(n_scores)))
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Accuracy: <span style="color:#ae81ff">0.814</span> (<span style="color:#ae81ff">0.034</span>)
</code></pre></div><h5 id="b-tune-n_components-của-svd">b, Tune n_components của SVD</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># compare svd number of components with logistic regression algorithm for classification</span>
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> mean
<span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> std
<span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_classification
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> cross_val_score
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> RepeatedStratifiedKFold
<span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> Pipeline
<span style="color:#f92672">from</span> sklearn.decomposition <span style="color:#f92672">import</span> TruncatedSVD
<span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
<span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> pyplot

<span style="color:#75715e"># get the dataset</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_dataset</span>():
	X, y <span style="color:#f92672">=</span> make_classification(n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>, n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>, n_informative<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, n_redundant<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>)
	<span style="color:#66d9ef">return</span> X, y

<span style="color:#75715e"># get a list of models to evaluate</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_models</span>():
	models <span style="color:#f92672">=</span> dict()
	<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">20</span>):
		steps <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;svd&#39;</span>, TruncatedSVD(n_components<span style="color:#f92672">=</span>i)), (<span style="color:#e6db74">&#39;m&#39;</span>, LogisticRegression())]
		models[str(i)] <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>steps)
	<span style="color:#66d9ef">return</span> models

<span style="color:#75715e"># evaluate a given model using cross-validation</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">evaluate_model</span>(model, X, y):
	cv <span style="color:#f92672">=</span> RepeatedStratifiedKFold(n_splits<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, n_repeats<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
	scores <span style="color:#f92672">=</span> cross_val_score(model, X, y, scoring<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;accuracy&#39;</span>, cv<span style="color:#f92672">=</span>cv, n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)
	<span style="color:#66d9ef">return</span> scores

<span style="color:#75715e"># define dataset</span>
X, y <span style="color:#f92672">=</span> get_dataset()
<span style="color:#75715e"># get the models to evaluate</span>
models <span style="color:#f92672">=</span> get_models()
<span style="color:#75715e"># evaluate the models and store results</span>
results, names <span style="color:#f92672">=</span> list(), list()
<span style="color:#66d9ef">for</span> name, model <span style="color:#f92672">in</span> models<span style="color:#f92672">.</span>items():
	scores <span style="color:#f92672">=</span> evaluate_model(model, X, y)
	results<span style="color:#f92672">.</span>append(scores)
	names<span style="color:#f92672">.</span>append(name)
	<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;&gt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (name, mean(scores), std(scores)))
<span style="color:#75715e"># plot model performance for comparison</span>
pyplot<span style="color:#f92672">.</span>boxplot(results, labels<span style="color:#f92672">=</span>names, showmeans<span style="color:#f92672">=</span>True)
pyplot<span style="color:#f92672">.</span>xticks(rotation<span style="color:#f92672">=</span><span style="color:#ae81ff">45</span>)
pyplot<span style="color:#f92672">.</span>show()
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0.542</span> (<span style="color:#ae81ff">0.046</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">2</span> <span style="color:#ae81ff">0.626</span> (<span style="color:#ae81ff">0.050</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">3</span> <span style="color:#ae81ff">0.719</span> (<span style="color:#ae81ff">0.053</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">4</span> <span style="color:#ae81ff">0.722</span> (<span style="color:#ae81ff">0.052</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">5</span> <span style="color:#ae81ff">0.721</span> (<span style="color:#ae81ff">0.054</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">6</span> <span style="color:#ae81ff">0.729</span> (<span style="color:#ae81ff">0.045</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">7</span> <span style="color:#ae81ff">0.802</span> (<span style="color:#ae81ff">0.034</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">8</span> <span style="color:#ae81ff">0.800</span> (<span style="color:#ae81ff">0.040</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">9</span> <span style="color:#ae81ff">0.814</span> (<span style="color:#ae81ff">0.037</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">10</span> <span style="color:#ae81ff">0.814</span> (<span style="color:#ae81ff">0.034</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">11</span> <span style="color:#ae81ff">0.817</span> (<span style="color:#ae81ff">0.037</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">12</span> <span style="color:#ae81ff">0.820</span> (<span style="color:#ae81ff">0.038</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">13</span> <span style="color:#ae81ff">0.820</span> (<span style="color:#ae81ff">0.036</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">14</span> <span style="color:#ae81ff">0.825</span> (<span style="color:#ae81ff">0.036</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">15</span> <span style="color:#ae81ff">0.865</span> (<span style="color:#ae81ff">0.027</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">16</span> <span style="color:#ae81ff">0.865</span> (<span style="color:#ae81ff">0.027</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">17</span> <span style="color:#ae81ff">0.865</span> (<span style="color:#ae81ff">0.027</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">18</span> <span style="color:#ae81ff">0.865</span> (<span style="color:#ae81ff">0.027</span>)
<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">19</span> <span style="color:#ae81ff">0.865</span> (<span style="color:#ae81ff">0.027</span>)
</code></pre></div>

   <div style="text-align:center">
      <img style="height:auto" src="/images/post/101_dimensionality_reduction_1.png">
   </div>


<h5 id="c-tạo-dự-đoán-trên-mẫu-dữ-liệu-mới-1">c, Tạo dự đoán trên mẫu dữ liệu mới</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># make predictions using svd with logistic regression</span>
<span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> make_classification
<span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> Pipeline
<span style="color:#f92672">from</span> sklearn.decomposition <span style="color:#f92672">import</span> TruncatedSVD
<span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
<span style="color:#75715e"># define dataset</span>
X, y <span style="color:#f92672">=</span> make_classification(n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>, n_features<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>, n_informative<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, n_redundant<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>)
<span style="color:#75715e"># define the model</span>
steps <span style="color:#f92672">=</span> [(<span style="color:#e6db74">&#39;svd&#39;</span>, TruncatedSVD(n_components<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>)), (<span style="color:#e6db74">&#39;m&#39;</span>, LogisticRegression())]
model <span style="color:#f92672">=</span> Pipeline(steps<span style="color:#f92672">=</span>steps)
<span style="color:#75715e"># fit the model on the whole dataset</span>
model<span style="color:#f92672">.</span>fit(X, y)
<span style="color:#75715e"># make a single prediction</span>
row <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">0.2929949</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4.21223056</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1.288332</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2.17849815</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">0.64527665</span>, <span style="color:#ae81ff">2.58097719</span>, <span style="color:#ae81ff">0.28422388</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">7.1827928</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1.91211104</span>, <span style="color:#ae81ff">2.73729512</span>, <span style="color:#ae81ff">0.81395695</span>, <span style="color:#ae81ff">3.96973717</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2.66939799</span>, <span style="color:#ae81ff">3.34692332</span>, <span style="color:#ae81ff">4.19791821</span>, <span style="color:#ae81ff">0.99990998</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">0.30201875</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4.43170633</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2.82646737</span>, <span style="color:#ae81ff">0.44916808</span>]]
yhat <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(row)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Predicted Class: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> yhat[<span style="color:#ae81ff">0</span>])
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Predicted Class: <span style="color:#ae81ff">1</span>
</code></pre></div><h3 id="3-kết-luận">3. Kết luận</h3>
<p>Bài thứ 2 về Dimensionality Reduction, chúng ta đã cùng tìm hiểu 3 thuật toán là LDA, PCA, và SVD. Chúng ta cũng đã thực hành chúng trên tập dữ liệu tự sinh. Đây cũng là bài cuối cùng trong chuỗi các bài viết về DP4ML. Hi vọng đã phần nào giúp các bạn hiểu và biết cách áp dụng các kỹ thuật đó vào quá trình chuẩn bị dữ liệu của mình để có thể tạo ra các mô hình tốt hơn.</p>
<p>Toàn bộ code của bài này, các bạn có thể tham khảo tại <a href="https://github.com/tiensu/Data_Preparation_for_ML/tree/master/06_Dimensionality_Reduction">đây</a>.</p>
<h3 id="4-tham-khảo">4. Tham khảo</h3>
<p>[1] Jason Brownlee, &ldquo;Data Preparation for Machine Learning&rdquo;, Book: <a href="https://machinelearningmastery.com/data-preparation-for-machine-learning/">https://machinelearningmastery.com/data-preparation-for-machine-learning/</a>.</p>

        </div>

        
        
      </div>
    </div>
  </div>
</section>



<footer>
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 text-center mb-5">
        <a href="https://tiensu.github.io/"><img src="https://tiensu.github.io/images/logo3.jpg" alt="SuNT&#39;s Blog | AI in Practical" style="height: auto"></a>
      </div>
               
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Contact Me</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="tel:0869644890"><i
                class="ti-mobile mr-3 text-primary"></i>0869644890</a></li>
          
                     
          <li class="mb-3"><i class="ti-location-pin mr-3 text-primary"></i>Hanoi, Vietnam</li>
          
                     
          <li class="mb-3"><a class="text-dark" href="mailto:tiensunguyen2103@gmail.com"><i
                class="ti-email mr-3 text-primary"></i>tiensunguyen2103@gmail.com</a>
          
          </li>
        </ul>
      </div>
      
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Social Contacts</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://www.facebook.com/tiensunguyen2103">Facebook</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://www.linkedin.com/in/su-nguyen-tien-aws%C2%AE-5ba74ba6/">Linkedin</a></li>
          
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Categories</h6>
        <ul class="list-unstyled">
          <li class="mb-3"><a class="text-dark"
              href="/categories/algorithm-optimization">Algorithm Optimization</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/attention">Attention</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/audio-classification">Audio Classification</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/autoencoder">Autoencoder</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/bert">BERT</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/cnn">CNN</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ctc">CTC</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-driff">Data Driff</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-imbalance">Data Imbalance</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-preparation">Data Preparation</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-science">Data Science</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/deep-learning">Deep Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/docker">Docker</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ebook">Ebook</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/eda">EDA</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ensemble-learning">Ensemble Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/face-recognition">Face Recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/game">Game</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/human-action-recognition">Human action recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/human-pose">Human pose</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/image-classification">Image Classification</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/kubernetes">Kubernetes</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/lstm">LSTM</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/machine-learning">Machine Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/mlops">MLOps</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/neural-network">Neural Network</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/nlp">NLP</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/object-detection">Object Detection</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ocr">OCR</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/one-shot-learning">One Shot Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/project-management">Project Management</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/recommender-system">Recommender System</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/rnn">RNN</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/scalability">Scalability</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/siamese-network">Siamese Network</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/speech-recognition">Speech Recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/speech-to-text">Speech To Text</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-classification">Text Classification</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-detection">Text Detection</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-generation">Text Generation</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-recognition">Text Recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/time-series">Time Series</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/transformer">Transformer</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/xgboost">XGBoost</a>
          </li>
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Quick Links</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://tiensu.github.io/about">About</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://tiensu.github.io/blog">Post</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://tiensu.github.io/contact">Contact</a></li>
          
        </ul>
      </div>
      <div class="col-12 border-top py-4 text-center">
        | copyright © 2021 <a href="tiensu.github.io">SuNT</a>. All Rights Reserved |
      </div>
    </div>
  </div>
</footer>

<script>
  var indexURL = "https://tiensu.github.io/index.json"
</script>

<!-- JS Plugins -->

<script src="https://tiensu.github.io/plugins/jQuery/jquery.min.js"></script>

<script src="https://tiensu.github.io/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://tiensu.github.io/plugins/slick/slick.min.js"></script>

<script src="https://tiensu.github.io/plugins/venobox/venobox.min.js"></script>

<script src="https://tiensu.github.io/plugins/search/fuse.min.js"></script>

<script src="https://tiensu.github.io/plugins/search/mark.js"></script>

<script src="https://tiensu.github.io/plugins/search/search.js"></script>

<!-- Main Script -->

<script src="https://tiensu.github.io/js/script.min.js"></script>




<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"></script>
<div id="js-cookie-box" class="cookie-box cookie-box-hide">
	This site uses cookies. By continuing to use this website, you agree to their use. <span id="js-cookie-button" class="btn btn-sm btn-primary ml-2">I Accept</span>
</div>
<script>
	(function ($) {
		const cookieBox = document.getElementById('js-cookie-box');
		const cookieButton = document.getElementById('js-cookie-button');
		if (!Cookies.get('cookie-box')) {
			cookieBox.classList.remove('cookie-box-hide');
			cookieButton.onclick = function () {
				Cookies.set('cookie-box', true, {
					expires:  2 
				});
				cookieBox.classList.add('cookie-box-hide');
			};
		}
	})(jQuery);
</script>


<style>
.cookie-box {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  text-align: center;
  z-index: 9999;
  padding: 1rem 2rem;
  background: rgb(71, 71, 71);
  transition: all .75s cubic-bezier(.19, 1, .22, 1);
  color: #fdfdfd;
}

.cookie-box-hide {
  display: none;
}
</style>
</body>
</html>