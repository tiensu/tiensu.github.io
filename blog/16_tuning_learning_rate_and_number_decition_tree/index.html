<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>SuNT&#39;s Blog | AI in Practical</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This is meta description">
  <meta name="author" content="SuNT">
  <meta name="generator" content="Hugo 0.80.0" />

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/themify-icons/themify-icons.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/venobox/venobox.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/css/override.css">
  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://tiensu.github.io/scss/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://tiensu.github.io/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://tiensu.github.io/images/favicon.png " type="image/x-icon">

  <!-- google analitycs -->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'Your ID', 'auto');
    ga('send', 'pageview');
  </script>

</head><body>
<!-- preloader start -->
<div class="preloader">
  
</div>
<!-- preloader end -->
<!-- navigation -->
<header class="navigation">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0">
      <a class="navbar-brand mobile-view" href="https://tiensu.github.io/"><img class="img-fluid"
          src="https://tiensu.github.io/images/logo3.jpg" alt="SuNT&#39;s Blog | AI in Practical"></a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="ti-menu h3"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <div class="desktop-view">
          <ul class="navbar-nav mr-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.facebook.com/tiensunguyen2103"><i class="ti-facebook"></i></a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.linkedin.com/in/su-nguyen-tien-aws%C2%AE-5ba74ba6/"><i class="ti-linkedin"></i></a>
            </li>
            
          </ul>
        </div>

        <a class="navbar-brand mx-auto desktop-view" href="https://tiensu.github.io/"><img class="img-fluid"
            src="https://tiensu.github.io/images/logo3.jpg" alt="SuNT&#39;s Blog | AI in Practical"></a>

        <ul class="navbar-nav">
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://tiensu.github.io/about">About</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://tiensu.github.io/blog">Post</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://tiensu.github.io/contact">Contact</a>
          </li>
          
          
        </ul>

        
        <!-- search -->
        <div class="search pl-lg-4">
          <button id="searchOpen" class="search-btn"><i class="ti-search"></i></button>
          <div class="search-wrapper">
            <form action="https://tiensu.github.io//search" class="h-100">
              <input class="search-box px-4" id="search-query" name="s" type="search" placeholder="Type & Hit Enter...">
            </form>
            <button id="searchClose" class="search-close"><i class="ti-close text-dark"></i></button>
          </div>
        </div>
        

        
      </div>
    </nav>
  </div>
  <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</header>
<!-- /navigation -->

<section class="section-sm">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 mx-auto">
        
        <a href="/categories/machine-learning"
          class="text-primary">Machine Learning</a>
        
        <a href="/categories/xgboost"
          class="text-primary">X g boost</a>
        
        <h2>XGBoost - Bài 13: Tuning Learning_Rate và số lượng của Decision Tree</h2>
        <div class="mb-3 post-meta">
          <span>By SuNT</span>
          
          <span class="border-bottom border-primary px-2 mx-1"></span>
          <span>12 October 2020</span>
          
        </div>
        
        <img src="https://tiensu.github.io/images/featured-post/xgboost_learning_rate.png" class="img-fluid w-100 mb-4" alt="XGBoost - Bài 13: Tuning Learning_Rate và số lượng của Decision Tree">
        
        <div class="content mb-5">
          <p>Một vấn đề còn tồn tại của XGBoost là khả năng học trên tập dữ liệu huấn luyện một cách rất nhanh chóng. Điều này đôi khi dễ dẫn đến hiện tượng <code>Overfitting</code>, mặc dù XGBoost đã sử dụng <code>regularization</code>. Một cách hiệu quả để điều khiển quá trình học của XGBoost là sử dụng <code>learning_rate</code> (hay <strong>eta</strong>).</p>
<p>Trong bài này, chúng ta sẽ cùng nhau tune <code>learning_rate</code>, <code>learning_rate</code> kết hợp với số lượng trees để tìm ra giá trị tối ưu của hai tham số này.</p>
<p><strong>1. Tuning Learning_Rate</strong></p>
<p>Chúng ta tiếp tục sử dụng <a href="https://www.kaggle.com/c/otto-group-product-classification-challenge/data">Otto dataset</a> trong bài này. Sử dụng giá trị mặc định của số lượng trees là 100, ta sẽ đánh giá sự phù hợp của mỗi giá trị learning_rate trong tập sau:  <strong>[0.0001, 0.001, 0.01, 0.1, 0.2, 0.3]</strong></p>
<p>Có 6 giá trị của learning_rate, kết hợp với 10-fold cross-validation <strong>&ndash;&gt;</strong> Có 60 models được trained.</p>
<p>Code tuning như sau:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># XGBoost on Otto dataset, Tune learning_rate</span>
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> xgboost <span style="color:#f92672">import</span> XGBClassifier
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> GridSearchCV
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> StratifiedKFold
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> LabelEncoder
<span style="color:#f92672">import</span> matplotlib
matplotlib<span style="color:#f92672">.</span>use(<span style="color:#e6db74">&#39;Agg&#39;</span>)
<span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> pyplot

<span style="color:#75715e"># load data</span>
data <span style="color:#f92672">=</span> read_csv(<span style="color:#e6db74">&#39;train.csv&#39;</span>)
dataset <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>values

<span style="color:#75715e"># split data into X and y</span>
X <span style="color:#f92672">=</span> dataset[:,<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">94</span>]
y <span style="color:#f92672">=</span> dataset[:,<span style="color:#ae81ff">94</span>]

<span style="color:#75715e"># encode string class values as integers</span>
label_encoded_y <span style="color:#f92672">=</span> LabelEncoder()<span style="color:#f92672">.</span>fit_transform(y)

<span style="color:#75715e"># grid search</span>
model <span style="color:#f92672">=</span> XGBClassifier()
learning_rate <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0.0001</span>, <span style="color:#ae81ff">0.001</span>, <span style="color:#ae81ff">0.01</span>, <span style="color:#ae81ff">0.1</span>, <span style="color:#ae81ff">0.2</span>, <span style="color:#ae81ff">0.3</span>]
param_grid <span style="color:#f92672">=</span> dict(learning_rate<span style="color:#f92672">=</span>learning_rate)
kfold <span style="color:#f92672">=</span> StratifiedKFold(n_splits<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, shuffle<span style="color:#f92672">=</span>True, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>)
grid_search <span style="color:#f92672">=</span> GridSearchCV(model, param_grid, scoring<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;accuracy&#34;</span>, n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>, cv<span style="color:#f92672">=</span>kfold, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
grid_result <span style="color:#f92672">=</span> grid_search<span style="color:#f92672">.</span>fit(X, label_encoded_y)

<span style="color:#75715e"># summarize results</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Best: </span><span style="color:#e6db74">%f</span><span style="color:#e6db74"> using </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (grid_result<span style="color:#f92672">.</span>best_score_, grid_result<span style="color:#f92672">.</span>best_params_))
means <span style="color:#f92672">=</span> grid_result<span style="color:#f92672">.</span>cv_results_[<span style="color:#e6db74">&#39;mean_test_score&#39;</span>]
stds <span style="color:#f92672">=</span> grid_result<span style="color:#f92672">.</span>cv_results_[<span style="color:#e6db74">&#39;std_test_score&#39;</span>]
params <span style="color:#f92672">=</span> grid_result<span style="color:#f92672">.</span>cv_results_[<span style="color:#e6db74">&#39;params&#39;</span>]
<span style="color:#66d9ef">for</span> mean, stdev, param <span style="color:#f92672">in</span> zip(means, stds, params):
	<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%f</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">%f</span><span style="color:#e6db74">) with: </span><span style="color:#e6db74">%r</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (mean, stdev, param))

<span style="color:#75715e"># plot</span>
pyplot<span style="color:#f92672">.</span>errorbar(learning_rate, means, yerr<span style="color:#f92672">=</span>stds)
pyplot<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;XGBoost learning_rate vs Log Loss&#34;</span>)
pyplot<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;learning_rate&#39;</span>)
pyplot<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;accuracy&#39;</span>)
pyplot<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74">&#39;learning_rate.png&#39;</span>)
</code></pre></div><p>Kết quả:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Fitting <span style="color:#ae81ff">10</span> folds <span style="color:#66d9ef">for</span> each of <span style="color:#ae81ff">6</span> candidates, totalling <span style="color:#ae81ff">60</span> fits
[Parallel(n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)]: Using backend LokyBackend <span style="color:#66d9ef">with</span> <span style="color:#ae81ff">12</span> concurrent workers<span style="color:#f92672">.</span>
[Parallel(n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)]: Done  <span style="color:#ae81ff">26</span> tasks      <span style="color:#f92672">|</span> elapsed:  <span style="color:#ae81ff">9.1</span>min
[Parallel(n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)]: Done  <span style="color:#ae81ff">60</span> out of  <span style="color:#ae81ff">60</span> <span style="color:#f92672">|</span> elapsed: <span style="color:#ae81ff">13.8</span>min finished
Best: <span style="color:#ae81ff">0.999887</span> using {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.001</span>}
<span style="color:#ae81ff">0.999838</span> (<span style="color:#ae81ff">0.000102</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.0001</span>}
<span style="color:#ae81ff">0.999887</span> (<span style="color:#ae81ff">0.000103</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.001</span>}
<span style="color:#ae81ff">0.999887</span> (<span style="color:#ae81ff">0.000103</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.01</span>}
<span style="color:#ae81ff">0.999871</span> (<span style="color:#ae81ff">0.000121</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.1</span>}
<span style="color:#ae81ff">0.999887</span> (<span style="color:#ae81ff">0.000103</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.2</span>}
<span style="color:#ae81ff">0.999887</span> (<span style="color:#ae81ff">0.000103</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.3</span>}
</code></pre></div><p>Giá trị learning_rate tối ưu tìm được là 0.001.</p>
<p>Đồ thị bên dưới thể hiện mối qua hệ giữa learning_rate và độ chính xác của model.</p>


    <div style="text-align:center">
        <img style="height:auto" src="/images/post/learning_rate.png">
    </div>


<p><strong>2. Tuning Learning_Rate và số lượng <code>decision tree</code></strong></p>
<p>Nói chung, khi có nhiều trees được thêm vào XGBoost, những trees thêm vào sau nên sử dụng giá trị learning_rate nhỏ. Ta sẽ kiểm tra nhận định này thông qua quá trình tuning như sau:</p>
<ul>
<li>Số lượng trees (<em>n_estimators</em>) = [100, 200, 300, 400, 500]</li>
<li>learning_rate = [0.0001, 0.001, 0.01, 0.1]</li>
</ul>
<p>Có 5 giá trị của n_estimators và 4 giá trị của learning_rate, kết hợp với 10-fold cross-validation ta có 200 models cần train.</p>
<p>Code đầy đủ như dưới đây:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># XGBoost on Otto dataset, Tune learning_rate and n_estimators</span>
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> xgboost <span style="color:#f92672">import</span> XGBClassifier
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> GridSearchCV
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> StratifiedKFold
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> LabelEncoder
<span style="color:#f92672">import</span> matplotlib
matplotlib<span style="color:#f92672">.</span>use(<span style="color:#e6db74">&#39;Agg&#39;</span>)
<span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> pyplot
<span style="color:#f92672">import</span> numpy

<span style="color:#75715e"># load data</span>
data <span style="color:#f92672">=</span> read_csv(<span style="color:#e6db74">&#39;train.csv&#39;</span>)
dataset <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>values

<span style="color:#75715e"># split data into X and y</span>
X <span style="color:#f92672">=</span> dataset[:,<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">94</span>]
y <span style="color:#f92672">=</span> dataset[:,<span style="color:#ae81ff">94</span>]

<span style="color:#75715e"># encode string class values as integers</span>
label_encoded_y <span style="color:#f92672">=</span> LabelEncoder()<span style="color:#f92672">.</span>fit_transform(y)

<span style="color:#75715e"># grid search</span>
model <span style="color:#f92672">=</span> XGBClassifier()
n_estimators <span style="color:#f92672">=</span> [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">200</span>, <span style="color:#ae81ff">300</span>, <span style="color:#ae81ff">400</span>, <span style="color:#ae81ff">500</span>]
learning_rate <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0.0001</span>, <span style="color:#ae81ff">0.001</span>, <span style="color:#ae81ff">0.01</span>, <span style="color:#ae81ff">0.1</span>]
param_grid <span style="color:#f92672">=</span> dict(learning_rate<span style="color:#f92672">=</span>learning_rate, n_estimators<span style="color:#f92672">=</span>n_estimators)
kfold <span style="color:#f92672">=</span> StratifiedKFold(n_splits<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, shuffle<span style="color:#f92672">=</span>True, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>)
grid_search <span style="color:#f92672">=</span> GridSearchCV(model, param_grid, scoring<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;accuracy&#34;</span>, n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>, cv<span style="color:#f92672">=</span>kfold, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
grid_result <span style="color:#f92672">=</span> grid_search<span style="color:#f92672">.</span>fit(X, label_encoded_y)

<span style="color:#75715e"># summarize results</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Best: </span><span style="color:#e6db74">%f</span><span style="color:#e6db74"> using </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (grid_result<span style="color:#f92672">.</span>best_score_, grid_result<span style="color:#f92672">.</span>best_params_))
means <span style="color:#f92672">=</span> grid_result<span style="color:#f92672">.</span>cv_results_[<span style="color:#e6db74">&#39;mean_test_score&#39;</span>]
stds <span style="color:#f92672">=</span> grid_result<span style="color:#f92672">.</span>cv_results_[<span style="color:#e6db74">&#39;std_test_score&#39;</span>]
params <span style="color:#f92672">=</span> grid_result<span style="color:#f92672">.</span>cv_results_[<span style="color:#e6db74">&#39;params&#39;</span>]
<span style="color:#66d9ef">for</span> mean, stdev, param <span style="color:#f92672">in</span> zip(means, stds, params):
	<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%f</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">%f</span><span style="color:#e6db74">) with: </span><span style="color:#e6db74">%r</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (mean, stdev, param))

<span style="color:#75715e"># plot results</span>
scores <span style="color:#f92672">=</span> numpy<span style="color:#f92672">.</span>array(means)<span style="color:#f92672">.</span>reshape(len(learning_rate), len(n_estimators))
<span style="color:#66d9ef">for</span> i, value <span style="color:#f92672">in</span> enumerate(learning_rate):
	pyplot<span style="color:#f92672">.</span>plot(n_estimators, scores[i], label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;learning_rate: &#39;</span> <span style="color:#f92672">+</span> str(value))
	pyplot<span style="color:#f92672">.</span>legend()
	pyplot<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;n_estimators&#39;</span>)
	pyplot<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;accuracy&#39;</span>)
	pyplot<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74">&#39;n_estimators_vs_learning_rate.png&#39;</span>)
</code></pre></div><p>Sau khoảng 2 tiếng chờ đơi thì chúng ta cũng thu được kết quả:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Fitting <span style="color:#ae81ff">10</span> folds <span style="color:#66d9ef">for</span> each of <span style="color:#ae81ff">20</span> candidates, totalling <span style="color:#ae81ff">200</span> fits
[Parallel(n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)]: Using backend LokyBackend <span style="color:#66d9ef">with</span> <span style="color:#ae81ff">16</span> concurrent workers<span style="color:#f92672">.</span>
[Parallel(n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)]: Done  <span style="color:#ae81ff">18</span> tasks      <span style="color:#f92672">|</span> elapsed:  <span style="color:#ae81ff">6.2</span>min
[Parallel(n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)]: Done <span style="color:#ae81ff">168</span> tasks      <span style="color:#f92672">|</span> elapsed: <span style="color:#ae81ff">58.2</span>min
[Parallel(n_jobs<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>)]: Done <span style="color:#ae81ff">200</span> out of <span style="color:#ae81ff">200</span> <span style="color:#f92672">|</span> elapsed: <span style="color:#ae81ff">67.6</span>min finished
Best: <span style="color:#ae81ff">0.999887</span> using {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.001</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">100</span>}
<span style="color:#ae81ff">0.999838</span> (<span style="color:#ae81ff">0.000102</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.0001</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">100</span>}
<span style="color:#ae81ff">0.999838</span> (<span style="color:#ae81ff">0.000102</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.0001</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">200</span>}
<span style="color:#ae81ff">0.999838</span> (<span style="color:#ae81ff">0.000102</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.0001</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">300</span>}
<span style="color:#ae81ff">0.999838</span> (<span style="color:#ae81ff">0.000102</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.0001</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">400</span>}
<span style="color:#ae81ff">0.999838</span> (<span style="color:#ae81ff">0.000102</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.0001</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">500</span>}
<span style="color:#ae81ff">0.999887</span> (<span style="color:#ae81ff">0.000103</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.001</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">100</span>}
<span style="color:#ae81ff">0.999887</span> (<span style="color:#ae81ff">0.000103</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.001</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">200</span>}
<span style="color:#ae81ff">0.999887</span> (<span style="color:#ae81ff">0.000103</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.001</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">300</span>}
<span style="color:#ae81ff">0.999887</span> (<span style="color:#ae81ff">0.000103</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.001</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">400</span>}
<span style="color:#ae81ff">0.999887</span> (<span style="color:#ae81ff">0.000103</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.001</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">500</span>}
<span style="color:#ae81ff">0.999887</span> (<span style="color:#ae81ff">0.000103</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.01</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">100</span>}
<span style="color:#ae81ff">0.999887</span> (<span style="color:#ae81ff">0.000103</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.01</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">200</span>}
<span style="color:#ae81ff">0.999887</span> (<span style="color:#ae81ff">0.000103</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.01</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">300</span>}
<span style="color:#ae81ff">0.999887</span> (<span style="color:#ae81ff">0.000103</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.01</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">400</span>}
<span style="color:#ae81ff">0.999887</span> (<span style="color:#ae81ff">0.000103</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.01</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">500</span>}
<span style="color:#ae81ff">0.999871</span> (<span style="color:#ae81ff">0.000121</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.1</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">100</span>}
<span style="color:#ae81ff">0.999871</span> (<span style="color:#ae81ff">0.000121</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.1</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">200</span>}
<span style="color:#ae81ff">0.999871</span> (<span style="color:#ae81ff">0.000121</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.1</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">300</span>}
<span style="color:#ae81ff">0.999871</span> (<span style="color:#ae81ff">0.000121</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.1</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">400</span>}
<span style="color:#ae81ff">0.999871</span> (<span style="color:#ae81ff">0.000121</span>) <span style="color:#66d9ef">with</span>: {<span style="color:#e6db74">&#39;learning_rate&#39;</span>: <span style="color:#ae81ff">0.1</span>, <span style="color:#e6db74">&#39;n_estimators&#39;</span>: <span style="color:#ae81ff">500</span>}
</code></pre></div><p>Ta có thể thấy, kết quả tốt nhất của model đạt được tại learning_rate=0.001 và n_estimators=100. Tuy nhiên, kết quả này cũng không có sự khác biệt đáng kể so với những trường hợp khác. Bạn có thể thử nghiệm với các metrics đánh giá khác (<em>F1-score, precition, recall, log_loss</em>) để nhìn thấy sự khác biệt rõ hơn.</p>
<p>Bên dưới là đồ thị thể hiện mối quan hệ của mỗi learning_rate với các giá trị khác nhau của n_estimators.</p>


    <div style="text-align:center">
        <img style="height:auto" src="/images/post/n_estimators_vs_learning_rate.png">
    </div>


<p><strong>3. Kết luận</strong></p>
<p>Ở bài viết này, chúng ta đã tiến hành tuning XGBoost model với 2 hyper-parameters là learning_rate và n_estimators.</p>
<p>Bài viết tiếp theo chúng ta sẽ tiếp tục tune thêm một tham số khác là <code>subsample</code>. Hãy cùng đón đọc! :)</p>
<p><em>Toàn bộ source code của bài này các bạn có thể tham khảo trên github cá nhân của mình tại <a href="https://github.com/tiensu/xgboost-algorithm/tree/master/tune_learning_rate">github.</a></em></p>
<p>Bài viết có tham khảo tại <a href="https://machinelearningmastery.com/XGBoost-with-python/">tham khảo</a>.</p>

        </div>

        
        
      </div>
    </div>
  </div>
</section>



<footer>
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 text-center mb-5">
        <a href="https://tiensu.github.io/"><img src="https://tiensu.github.io/images/logo3.jpg" alt="SuNT&#39;s Blog | AI in Practical" style="height: auto"></a>
      </div>
               
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Contact Me</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="tel:0869644890"><i
                class="ti-mobile mr-3 text-primary"></i>0869644890</a></li>
          
                     
          <li class="mb-3"><i class="ti-location-pin mr-3 text-primary"></i>Hanoi, Vietnam</li>
          
                     
          <li class="mb-3"><a class="text-dark" href="mailto:tiensunguyen2103@gmail.com"><i
                class="ti-email mr-3 text-primary"></i>tiensunguyen2103@gmail.com</a>
          
          </li>
        </ul>
      </div>
      
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Social Contacts</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://www.facebook.com/tiensunguyen2103">Facebook</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://www.linkedin.com/in/su-nguyen-tien-aws%C2%AE-5ba74ba6/">Linkedin</a></li>
          
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Categories</h6>
        <ul class="list-unstyled">
          <li class="mb-3"><a class="text-dark"
              href="/categories/algorithm-optimization">Algorithm Optimization</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/attention">Attention</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/audio-classification">Audio Classification</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/autoencoder">Autoencoder</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/bert">BERT</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/cnn">CNN</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ctc">CTC</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-driff">Data Driff</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-imbalance">Data Imbalance</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-preparation">Data preparation</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-science">Data Science</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/deep-learning">Deep Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/docker">Docker</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ebook">Ebook</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ensemble-learning">Ensemble Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/face-recognition">Face Recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/image-classification">Image Classification</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/kubernetes">Kubernetes</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/lstm">LSTM</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/machine-learning">Machine Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/mlops">MLOps</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/neural-network">Neural Network</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/object-detection">Object Detection</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ocr">OCR</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/one-shot-learning">One Shot Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/project-management">Project Management</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/recommender-system">Recommender System</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/rnn">RNN</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/scalability">Scalability</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/siamese-network">Siamese Network</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/speech-recognition">Speech Recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/speech-to-text">Speech To Text</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-classification">Text Classification</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-detection">Text Detection</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-recognition">Text Recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/transformer">Transformer</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/xgboost">XGBoost</a>
          </li>
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Quick Links</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://tiensu.github.io/about">About</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://tiensu.github.io/blog">Post</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://tiensu.github.io/contact">Contact</a></li>
          
        </ul>
      </div>
      <div class="col-12 border-top py-4 text-center">
        | copyright © 2021 <a href="tiensu.github.io">SuNT</a>. All Rights Reserved |
      </div>
    </div>
  </div>
</footer>

<script>
  var indexURL = "https://tiensu.github.io/index.json"
</script>

<!-- JS Plugins -->

<script src="https://tiensu.github.io/plugins/jQuery/jquery.min.js"></script>

<script src="https://tiensu.github.io/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://tiensu.github.io/plugins/slick/slick.min.js"></script>

<script src="https://tiensu.github.io/plugins/venobox/venobox.min.js"></script>

<script src="https://tiensu.github.io/plugins/search/fuse.min.js"></script>

<script src="https://tiensu.github.io/plugins/search/mark.js"></script>

<script src="https://tiensu.github.io/plugins/search/search.js"></script>

<!-- Main Script -->

<script src="https://tiensu.github.io/js/script.min.js"></script>




<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"></script>
<div id="js-cookie-box" class="cookie-box cookie-box-hide">
	This site uses cookies. By continuing to use this website, you agree to their use. <span id="js-cookie-button" class="btn btn-sm btn-primary ml-2">I Accept</span>
</div>
<script>
	(function ($) {
		const cookieBox = document.getElementById('js-cookie-box');
		const cookieButton = document.getElementById('js-cookie-button');
		if (!Cookies.get('cookie-box')) {
			cookieBox.classList.remove('cookie-box-hide');
			cookieButton.onclick = function () {
				Cookies.set('cookie-box', true, {
					expires:  2 
				});
				cookieBox.classList.add('cookie-box-hide');
			};
		}
	})(jQuery);
</script>


<style>
.cookie-box {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  text-align: center;
  z-index: 9999;
  padding: 1rem 2rem;
  background: rgb(71, 71, 71);
  transition: all .75s cubic-bezier(.19, 1, .22, 1);
  color: #fdfdfd;
}

.cookie-box-hide {
  display: none;
}
</style>
</body>
</html>