<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>SuNT&#39;s Blog | AI in Practical</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This is meta description">
  <meta name="author" content="SuNT">
  <meta name="generator" content="Hugo 0.80.0" />

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/themify-icons/themify-icons.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/plugins/venobox/venobox.css ">
  
  <link rel="stylesheet" href="https://tiensu.github.io/css/override.css">
  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://tiensu.github.io/scss/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://tiensu.github.io/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://tiensu.github.io/images/favicon.png " type="image/x-icon">

  <!-- google analitycs -->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'Your ID', 'auto');
    ga('send', 'pageview');
  </script>

</head><body>
<!-- preloader start -->
<div class="preloader">
  
</div>
<!-- preloader end -->
<!-- navigation -->
<header class="navigation">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0">
      <a class="navbar-brand mobile-view" href="https://tiensu.github.io/"><img class="img-fluid"
          src="https://tiensu.github.io/images/logo3.jpg" alt="SuNT&#39;s Blog | AI in Practical"></a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="ti-menu h3"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <div class="desktop-view">
          <ul class="navbar-nav mr-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.facebook.com/tiensunguyen2103"><i class="ti-facebook"></i></a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.linkedin.com/in/su-nguyen-tien-aws%C2%AE-5ba74ba6/"><i class="ti-linkedin"></i></a>
            </li>
            
          </ul>
        </div>

        <a class="navbar-brand mx-auto desktop-view" href="https://tiensu.github.io/"><img class="img-fluid"
            src="https://tiensu.github.io/images/logo3.jpg" alt="SuNT&#39;s Blog | AI in Practical"></a>

        <ul class="navbar-nav">
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://tiensu.github.io/about">About</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://tiensu.github.io/blog">Post</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://tiensu.github.io/contact">Contact</a>
          </li>
          
          
        </ul>

        
        <!-- search -->
        <div class="search pl-lg-4">
          <button id="searchOpen" class="search-btn"><i class="ti-search"></i></button>
          <div class="search-wrapper">
            <form action="https://tiensu.github.io//search" class="h-100">
              <input class="search-box px-4" id="search-query" name="s" type="search" placeholder="Type & Hit Enter...">
            </form>
            <button id="searchClose" class="search-close"><i class="ti-close text-dark"></i></button>
          </div>
        </div>
        

        
      </div>
    </nav>
  </div>
  <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</header>
<!-- /navigation -->

<section class="section-sm">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 mx-auto">
        
        <a href="/categories/machine-learning"
          class="text-primary">Machine Learning</a>
        
        <a href="/categories/data-preparation"
          class="text-primary">Data Preparation</a>
        
        <h2>DP4ML - Feature Selection - Phần 2 - Select Categorical Input Features</h2>
        <div class="mb-3 post-meta">
          <span>By SuNT</span>
          
          <span class="border-bottom border-primary px-2 mx-1"></span>
          <span>22 June 2021</span>
          
        </div>
        
        <img src="https://tiensu.github.io/images/featured-post/83_feature_selection.png" class="img-fluid w-100 mb-4" alt="DP4ML - Feature Selection - Phần 2 - Select Categorical Input Features">
        
        <div class="content mb-5">
          <p>Bài thứ 9 trong chuỗi các bài viết về chủ đề Data Preparation cho các mô hình ML và là bài thứ 2 về Feature Selection. Trong bài này, chúng ta sẽ tìm hiểu phương pháp lựa chọn features đối với dữ liệu có Input Variance thuộc kiểu Categorical thông qua việc thực hành trên một bộ dữ liệu cụ thể.</p>
<h3 id="1-breast-cancer-categorical-dataset">1. Breast Cancer Categorical Dataset</h3>
<p><a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/breast-cancer.csv">Breast Cancer Categorical Dataset</a> là bộ dữ liệu thường được dùng cho việc nghiên cứu các thuật toán ML từ thập niên 80s. Nó bao gồm 286 mẫu dữ liệu đại diện cho các bệnh nhân, và 9 Input Variables. Thông tin về các Input Variables được miêu tả ở <a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/breast-cancer.names">đây</a>. Đây là bài toán Binary Classification, mỗi bệnh nhân thuộc 1 trong 2 nhãn là có bệnh hoặc không có bệnh.</p>
<p>Code dưới đây đọc vào dữ liệu, in ra một vài samples, chia dữ liệu thành Input/Output Variables, sau đó lại chia thành 2 tập train/test.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#75715e"># load the dataset</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_dataset</span>(filename):
<span style="color:#75715e"># load the dataset</span>
   data <span style="color:#f92672">=</span> read_csv(filename, header<span style="color:#f92672">=</span>None)
   <span style="color:#75715e"># display some samples</span>
   <span style="color:#66d9ef">print</span>(data<span style="color:#f92672">.</span>head())
   <span style="color:#75715e"># retrieve array</span>
   dataset <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>values
   <span style="color:#75715e"># split into input and output variables</span>
   X <span style="color:#f92672">=</span> dataset[:, :<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
   y <span style="color:#f92672">=</span> dataset[:,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
   <span style="color:#75715e"># format all fields as string</span>
   X <span style="color:#f92672">=</span> X<span style="color:#f92672">.</span>astype(str)
   <span style="color:#66d9ef">return</span> X, y
   <span style="color:#75715e"># load the dataset</span>
   X, y <span style="color:#f92672">=</span> load_dataset( <span style="color:#e6db74">&#39; breast-cancer.csv &#39;</span> )
   <span style="color:#75715e"># split into train and test sets</span>
   X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X, y, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.33</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
   <span style="color:#75715e"># summarize</span>
   <span style="color:#66d9ef">print</span>( <span style="color:#e6db74">&#39; Train &#39;</span> , X_train<span style="color:#f92672">.</span>shape, y_train<span style="color:#f92672">.</span>shape
   <span style="color:#66d9ef">print</span>( <span style="color:#e6db74">&#39; Test &#39;</span> , X_test<span style="color:#f92672">.</span>shape, y_test<span style="color:#f92672">.</span>shape)
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">         <span style="color:#ae81ff">0</span>          <span style="color:#ae81ff">1</span>        <span style="color:#ae81ff">2</span>      <span style="color:#ae81ff">3</span>      <span style="color:#ae81ff">4</span>    <span style="color:#ae81ff">5</span>        <span style="color:#ae81ff">6</span>           <span style="color:#ae81ff">7</span>      <span style="color:#ae81ff">8</span>                       <span style="color:#ae81ff">9</span>
<span style="color:#ae81ff">0</span>  <span style="color:#e6db74">&#39;40-49&#39;</span>  <span style="color:#e6db74">&#39;premeno&#39;</span>  <span style="color:#e6db74">&#39;15-19&#39;</span>  <span style="color:#e6db74">&#39;0-2&#39;</span>  <span style="color:#e6db74">&#39;yes&#39;</span>  <span style="color:#e6db74">&#39;3&#39;</span>  <span style="color:#e6db74">&#39;right&#39;</span>   <span style="color:#e6db74">&#39;left_up&#39;</span>   <span style="color:#e6db74">&#39;no&#39;</span>     <span style="color:#e6db74">&#39;recurrence-events&#39;</span>
<span style="color:#ae81ff">1</span>  <span style="color:#e6db74">&#39;50-59&#39;</span>     <span style="color:#e6db74">&#39;ge40&#39;</span>  <span style="color:#e6db74">&#39;15-19&#39;</span>  <span style="color:#e6db74">&#39;0-2&#39;</span>   <span style="color:#e6db74">&#39;no&#39;</span>  <span style="color:#e6db74">&#39;1&#39;</span>  <span style="color:#e6db74">&#39;right&#39;</span>   <span style="color:#e6db74">&#39;central&#39;</span>   <span style="color:#e6db74">&#39;no&#39;</span>  <span style="color:#e6db74">&#39;no-recurrence-events&#39;</span>
<span style="color:#ae81ff">2</span>  <span style="color:#e6db74">&#39;50-59&#39;</span>     <span style="color:#e6db74">&#39;ge40&#39;</span>  <span style="color:#e6db74">&#39;35-39&#39;</span>  <span style="color:#e6db74">&#39;0-2&#39;</span>   <span style="color:#e6db74">&#39;no&#39;</span>  <span style="color:#e6db74">&#39;2&#39;</span>   <span style="color:#e6db74">&#39;left&#39;</span>  <span style="color:#e6db74">&#39;left_low&#39;</span>   <span style="color:#e6db74">&#39;no&#39;</span>     <span style="color:#e6db74">&#39;recurrence-events&#39;</span>
<span style="color:#ae81ff">3</span>  <span style="color:#e6db74">&#39;40-49&#39;</span>  <span style="color:#e6db74">&#39;premeno&#39;</span>  <span style="color:#e6db74">&#39;35-39&#39;</span>  <span style="color:#e6db74">&#39;0-2&#39;</span>  <span style="color:#e6db74">&#39;yes&#39;</span>  <span style="color:#e6db74">&#39;3&#39;</span>  <span style="color:#e6db74">&#39;right&#39;</span>  <span style="color:#e6db74">&#39;left_low&#39;</span>  <span style="color:#e6db74">&#39;yes&#39;</span>  <span style="color:#e6db74">&#39;no-recurrence-events&#39;</span>
<span style="color:#ae81ff">4</span>  <span style="color:#e6db74">&#39;40-49&#39;</span>  <span style="color:#e6db74">&#39;premeno&#39;</span>  <span style="color:#e6db74">&#39;30-34&#39;</span>  <span style="color:#e6db74">&#39;3-5&#39;</span>  <span style="color:#e6db74">&#39;yes&#39;</span>  <span style="color:#e6db74">&#39;2&#39;</span>   <span style="color:#e6db74">&#39;left&#39;</span>  <span style="color:#e6db74">&#39;right_up&#39;</span>   <span style="color:#e6db74">&#39;no&#39;</span>     <span style="color:#e6db74">&#39;recurrence-events&#39;</span>
Train (<span style="color:#ae81ff">191</span>, <span style="color:#ae81ff">9</span>) (<span style="color:#ae81ff">191</span>,)
Test (<span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">9</span>) (<span style="color:#ae81ff">95</span>,)
</code></pre></div><h3 id="2-transform-data">2. Transform Data</h3>
<p>Có thể nhận ra rằng, tất cả Input Variables đều có dạng Categorical. Vì thế chúng ta cần chuyển chúng sang dạng Integer để model có thể học được. Lớp <em>OridinalEncoder</em> trong Scikit-learn giúp chúng ta thực hiện việc này.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># prepare input data</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">prepare_inputs</span>(X_train, X_test):
   oe <span style="color:#f92672">=</span> OrdinalEncoder()
   oe<span style="color:#f92672">.</span>fit(X_train)
   X_train_enc <span style="color:#f92672">=</span> oe<span style="color:#f92672">.</span>transform(X_train)
   X_test_enc <span style="color:#f92672">=</span> oe<span style="color:#f92672">.</span>transform(X_test)
<span style="color:#66d9ef">return</span> X_train_enc, X_test_enc
</code></pre></div><p>Output Variable cũng phải chuyển sang Integer. Vì đây là bài toán Binary Classification nên ánh xạ hai nhãn thành 0 và 1. Sử dụng lớp <em>LabelEncoder</em> của Scikit-learn để thực hiện.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># prepare target</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">prepare_targets</span>(y_train, y_test):
   le <span style="color:#f92672">=</span> LabelEncoder()
   le<span style="color:#f92672">.</span>fit(y_train)
   y_train_enc <span style="color:#f92672">=</span> le<span style="color:#f92672">.</span>transform(y_train)
   y_test_enc <span style="color:#f92672">=</span> le<span style="color:#f92672">.</span>transform(y_test)
   <span style="color:#66d9ef">return</span> y_train_enc, y_test_enc
</code></pre></div><p>Code đầy đủ như sau:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># example of loading and preparing the breast cancer dataset</span>
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> LabelEncoder
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> OrdinalEncoder

<span style="color:#75715e"># load the dataset</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_dataset</span>(filename):
	<span style="color:#75715e"># load the dataset</span>
	data <span style="color:#f92672">=</span> read_csv(filename, header<span style="color:#f92672">=</span>None)
	<span style="color:#75715e"># retrieve array</span>
	dataset <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>values
	<span style="color:#75715e"># split into input and output variables</span>
	X <span style="color:#f92672">=</span> dataset[:, :<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
	y <span style="color:#f92672">=</span> dataset[:,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
	<span style="color:#75715e"># format all fields as string</span>
	X <span style="color:#f92672">=</span> X<span style="color:#f92672">.</span>astype(str)
	<span style="color:#66d9ef">return</span> X, y

<span style="color:#75715e"># prepare input data</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">prepare_inputs</span>(X_train, X_test):
	oe <span style="color:#f92672">=</span> OrdinalEncoder()
	oe<span style="color:#f92672">.</span>fit(X_train)
	X_train_enc <span style="color:#f92672">=</span> oe<span style="color:#f92672">.</span>transform(X_train)
	X_test_enc <span style="color:#f92672">=</span> oe<span style="color:#f92672">.</span>transform(X_test)
	<span style="color:#66d9ef">return</span> X_train_enc, X_test_enc

<span style="color:#75715e"># prepare target</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">prepare_targets</span>(y_train, y_test):
	le <span style="color:#f92672">=</span> LabelEncoder()
	le<span style="color:#f92672">.</span>fit(y_train)
	y_train_enc <span style="color:#f92672">=</span> le<span style="color:#f92672">.</span>transform(y_train)
	y_test_enc <span style="color:#f92672">=</span> le<span style="color:#f92672">.</span>transform(y_test)
	<span style="color:#66d9ef">return</span> y_train_enc, y_test_enc

<span style="color:#75715e"># load the dataset</span>
X, y <span style="color:#f92672">=</span> load_dataset(<span style="color:#e6db74">&#39;breast-cancer.csv&#39;</span>)
<span style="color:#75715e"># split into train and test sets</span>
X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X, y, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.33</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
<span style="color:#75715e"># prepare input data</span>
X_train_enc, X_test_enc <span style="color:#f92672">=</span> prepare_inputs(X_train, X_test)
<span style="color:#75715e"># prepare output data</span>
y_train_enc, y_test_enc <span style="color:#f92672">=</span> prepare_targets(y_train, y_test)
<span style="color:#75715e"># summarize</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Train&#39;</span>, X_train_enc<span style="color:#f92672">.</span>shape, y_train_enc<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Test&#39;</span>, X_test_enc<span style="color:#f92672">.</span>shape, y_test_enc<span style="color:#f92672">.</span>shape)
</code></pre></div><h3 id="3-categorical-feature-selection">3. Categorical Feature Selection</h3>
<p>Có 2 kỹ thuật có thể áp dụng cho Input Variables dạng Categorical trong việc Feature Selection là <em>Chi-Squared Statistic</em> và <em>Mutual Information Statistic</em>.</p>
<h4 id="31-chi-squared-statistic">3.1 Chi-Squared Statistic</h4>
<p>Chi-Squared Statistic - Kiểm định giả thuyết thống kê chi bình phương ($\chi^2$) là một ví dụ về kiểm định tính độc lập giữa các biến phân loại. Kết quả của thử nghiệm này có thể được sử dụng để lựa chọn các Input Variables. Nếu Input Variables độc lập với Output Variables thì chúng có thể bị xóa khỏi tập dữ liệu.</p>
<p>Scikit-learn thực hiện Chi-Squared Statistic thông qua hàm <em>chi2()</em>. Kết hợp với hàm <em>SelectKBest()</em>, ta có thể lựa chọn được các features mong muốn như code dưới đây:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">...</span>
fs <span style="color:#f92672">=</span> SelectKBest(score_func<span style="color:#f92672">=</span>chi2, k<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;all&#39;</span>)
fs<span style="color:#f92672">.</span>fit(X_train, y_train)
X_train_fs <span style="color:#f92672">=</span> fs<span style="color:#f92672">.</span>transform(X_train)
X_test_fs <span style="color:#f92672">=</span> fs<span style="color:#f92672">.</span>transform(X_test)
</code></pre></div><p>Muốn biêt và so sánh Score của mỗi feature, chúng ta có thể thể hiện chúng lên đồ thị. Score càng lớn càng tốt.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">...</span>
<span style="color:#75715e"># what are scores for the features</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(fs<span style="color:#f92672">.</span>scores_)):
   <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Feature </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">: </span><span style="color:#e6db74">%f</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> (i, fs<span style="color:#f92672">.</span>scores_[i]))
<span style="color:#75715e"># plot the scores</span>
pyplot<span style="color:#f92672">.</span>bar([i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(fs<span style="color:#f92672">.</span>scores_))], fs<span style="color:#f92672">.</span>scores_)
pyplot<span style="color:#f92672">.</span>show()
</code></pre></div><p>Code đầy đủ:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># example of chi squared feature selection for categorical data</span>
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> LabelEncoder
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> OrdinalEncoder
<span style="color:#f92672">from</span> sklearn.feature_selection <span style="color:#f92672">import</span> SelectKBest
<span style="color:#f92672">from</span> sklearn.feature_selection <span style="color:#f92672">import</span> chi2
<span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> pyplot

<span style="color:#75715e"># load the dataset</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_dataset</span>(filename):
	<span style="color:#75715e"># load the dataset as a pandas DataFrame</span>
	data <span style="color:#f92672">=</span> read_csv(filename, header<span style="color:#f92672">=</span>None)
	<span style="color:#75715e"># retrieve numpy array</span>
	dataset <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>values
	<span style="color:#75715e"># split into input (X) and output (y) variables</span>
	X <span style="color:#f92672">=</span> dataset[:, :<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
	y <span style="color:#f92672">=</span> dataset[:,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
	<span style="color:#75715e"># format all fields as string</span>
	X <span style="color:#f92672">=</span> X<span style="color:#f92672">.</span>astype(str)
	<span style="color:#66d9ef">return</span> X, y

<span style="color:#75715e"># prepare input data</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">prepare_inputs</span>(X_train, X_test):
	oe <span style="color:#f92672">=</span> OrdinalEncoder()
	oe<span style="color:#f92672">.</span>fit(X_train)
	X_train_enc <span style="color:#f92672">=</span> oe<span style="color:#f92672">.</span>transform(X_train)
	X_test_enc <span style="color:#f92672">=</span> oe<span style="color:#f92672">.</span>transform(X_test)
	<span style="color:#66d9ef">return</span> X_train_enc, X_test_enc

<span style="color:#75715e"># prepare target</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">prepare_targets</span>(y_train, y_test):
	le <span style="color:#f92672">=</span> LabelEncoder()
	le<span style="color:#f92672">.</span>fit(y_train)
	y_train_enc <span style="color:#f92672">=</span> le<span style="color:#f92672">.</span>transform(y_train)
	y_test_enc <span style="color:#f92672">=</span> le<span style="color:#f92672">.</span>transform(y_test)
	<span style="color:#66d9ef">return</span> y_train_enc, y_test_enc

<span style="color:#75715e"># feature selection</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">select_features</span>(X_train, y_train, X_test):
	fs <span style="color:#f92672">=</span> SelectKBest(score_func<span style="color:#f92672">=</span>chi2, k<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;all&#39;</span>)
	fs<span style="color:#f92672">.</span>fit(X_train, y_train)
	X_train_fs <span style="color:#f92672">=</span> fs<span style="color:#f92672">.</span>transform(X_train)
	X_test_fs <span style="color:#f92672">=</span> fs<span style="color:#f92672">.</span>transform(X_test)
	<span style="color:#66d9ef">return</span> X_train_fs, X_test_fs, fs

<span style="color:#75715e"># load the dataset</span>
X, y <span style="color:#f92672">=</span> load_dataset(<span style="color:#e6db74">&#39;breast-cancer.csv&#39;</span>)
<span style="color:#75715e"># split into train and test sets</span>
X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X, y, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.33</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
<span style="color:#75715e"># prepare input data</span>
X_train_enc, X_test_enc <span style="color:#f92672">=</span> prepare_inputs(X_train, X_test)
<span style="color:#75715e"># prepare output data</span>
y_train_enc, y_test_enc <span style="color:#f92672">=</span> prepare_targets(y_train, y_test)
<span style="color:#75715e"># feature selection</span>
X_train_fs, X_test_fs, fs <span style="color:#f92672">=</span> select_features(X_train_enc, y_train_enc, X_test_enc)
<span style="color:#75715e"># what are scores for the features</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(fs<span style="color:#f92672">.</span>scores_)):
	<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Feature </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">: </span><span style="color:#e6db74">%f</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> (i, fs<span style="color:#f92672">.</span>scores_[i]))
<span style="color:#75715e"># plot the scores</span>
pyplot<span style="color:#f92672">.</span>bar([i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(fs<span style="color:#f92672">.</span>scores_))], fs<span style="color:#f92672">.</span>scores_)
pyplot<span style="color:#f92672">.</span>show()
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Feature <span style="color:#ae81ff">0</span>: <span style="color:#ae81ff">0.472553</span>
Feature <span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">0.029193</span>
Feature <span style="color:#ae81ff">2</span>: <span style="color:#ae81ff">2.137658</span>
Feature <span style="color:#ae81ff">3</span>: <span style="color:#ae81ff">29.381059</span>
Feature <span style="color:#ae81ff">4</span>: <span style="color:#ae81ff">8.222601</span>
Feature <span style="color:#ae81ff">5</span>: <span style="color:#ae81ff">8.100183</span>
Feature <span style="color:#ae81ff">6</span>: <span style="color:#ae81ff">1.273822</span>
Feature <span style="color:#ae81ff">7</span>: <span style="color:#ae81ff">0.950682</span>
Feature <span style="color:#ae81ff">8</span>: <span style="color:#ae81ff">3.699989</span>
</code></pre></div>

   <div style="text-align:center">
      <img style="height:auto" src="/images/post/83_feature_selection_1.png">
   </div>


<p>Theo kết quả này thì có lẽ 4/9 feature <em>liên quan</em> nhất đến Output Variables là các features 3, 4, 5, 8. Do đó, ta sẽ chọn <em>k=4</em> để lấy ra 4 features này.</p>
<h4 id="32-mutual-information-feature-selection">3.2 Mutual Information Feature Selection</h4>
<p>Mutual Information xuất phát từ lĩnh vực Lý thuyết Thông tin. Nó đo đặc mức độ suy giảm của một biến khi đã biết giá trị của một biến khác. Trong Scikit-learn, Mutual Information được implement trong hàm <em>mutual info classif()</em>. Cách sử dụng cũng tương tự như Chi-Squared Statistic.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># feature selection</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">select_features</span>(X_train, y_train, X_test):
	fs <span style="color:#f92672">=</span> SelectKBest(score_func<span style="color:#f92672">=</span>mutual_info_classif, k<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;all&#39;</span>)
	fs<span style="color:#f92672">.</span>fit(X_train, y_train)
	X_train_fs <span style="color:#f92672">=</span> fs<span style="color:#f92672">.</span>transform(X_train)
	X_test_fs <span style="color:#f92672">=</span> fs<span style="color:#f92672">.</span>transform(X_test)
	<span style="color:#66d9ef">return</span> X_train_fs, X_test_fs, fs
</code></pre></div><p>Kết quả thực hiện:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Feature <span style="color:#ae81ff">0</span>: <span style="color:#ae81ff">0.000000</span>
Feature <span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">0.045906</span>
Feature <span style="color:#ae81ff">2</span>: <span style="color:#ae81ff">0.063114</span>
Feature <span style="color:#ae81ff">3</span>: <span style="color:#ae81ff">0.018165</span>
Feature <span style="color:#ae81ff">4</span>: <span style="color:#ae81ff">0.007357</span>
Feature <span style="color:#ae81ff">5</span>: <span style="color:#ae81ff">0.041046</span>
Feature <span style="color:#ae81ff">6</span>: <span style="color:#ae81ff">0.049755</span>
Feature <span style="color:#ae81ff">7</span>: <span style="color:#ae81ff">0.000000</span>
Feature <span style="color:#ae81ff">8</span>: <span style="color:#ae81ff">0.024087</span>
</code></pre></div>

   <div style="text-align:center">
      <img style="height:auto" src="/images/post/83_feature_selection_2.png">
   </div>


<p>Theo Mutual Information thì các features 2, 3, 5, 6 có mức độ <em>liên quan</em> đến Output Variables nhất. Chọn <em>k=4</em>.</p>
<h3 id="4-modeling-with-selected-features">4. Modeling With Selected Features</h3>
<p>Sử dụng 2 kỹ thuật bên trên, chúng ta sẽ đi đánh giá độ chính xác của Logistic Regression model trên tập dữ liệu Breast Cancer Categorical Dataset.</p>
<h4 id="41-model-built-using-all-features">4.1 Model Built using All Features</h4>
<p>Đầu tiên, chúng ta sẽ xây dựng Base model làm cơ sở để so sánh, đánh giá. Các model về sau được mong đợi phải có độ chính xác cao hơn độ chính xác của Base model này.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># evaluation of a model using all input features</span>
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> LabelEncoder
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> OrdinalEncoder
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
<span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
<span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> accuracy_score

<span style="color:#75715e"># load the dataset</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_dataset</span>(filename):
	<span style="color:#75715e"># load the dataset as a pandas DataFrame</span>
	data <span style="color:#f92672">=</span> read_csv(filename, header<span style="color:#f92672">=</span>None)
	<span style="color:#75715e"># retrieve numpy array</span>
	dataset <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>values
	<span style="color:#75715e"># split into input (X) and output (y) variables</span>
	X <span style="color:#f92672">=</span> dataset[:, :<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
	y <span style="color:#f92672">=</span> dataset[:,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
	<span style="color:#75715e"># format all fields as string</span>
	X <span style="color:#f92672">=</span> X<span style="color:#f92672">.</span>astype(str)
	<span style="color:#66d9ef">return</span> X, y

<span style="color:#75715e"># prepare input data</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">prepare_inputs</span>(X_train, X_test):
	oe <span style="color:#f92672">=</span> OrdinalEncoder()
	oe<span style="color:#f92672">.</span>fit(X_train)
	X_train_enc <span style="color:#f92672">=</span> oe<span style="color:#f92672">.</span>transform(X_train)
	X_test_enc <span style="color:#f92672">=</span> oe<span style="color:#f92672">.</span>transform(X_test)
	<span style="color:#66d9ef">return</span> X_train_enc, X_test_enc

<span style="color:#75715e"># prepare target</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">prepare_targets</span>(y_train, y_test):
	le <span style="color:#f92672">=</span> LabelEncoder()
	le<span style="color:#f92672">.</span>fit(y_train)
	y_train_enc <span style="color:#f92672">=</span> le<span style="color:#f92672">.</span>transform(y_train)
	y_test_enc <span style="color:#f92672">=</span> le<span style="color:#f92672">.</span>transform(y_test)
	<span style="color:#66d9ef">return</span> y_train_enc, y_test_enc

<span style="color:#75715e"># load the dataset</span>
X, y <span style="color:#f92672">=</span> load_dataset(<span style="color:#e6db74">&#39;breast-cancer.csv&#39;</span>)
<span style="color:#75715e"># split into train and test sets</span>
X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X, y, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.33</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
<span style="color:#75715e"># prepare input data</span>
X_train_enc, X_test_enc <span style="color:#f92672">=</span> prepare_inputs(X_train, X_test)
<span style="color:#75715e"># prepare output data</span>
y_train_enc, y_test_enc <span style="color:#f92672">=</span> prepare_targets(y_train, y_test)
<span style="color:#75715e"># fit the model</span>
model <span style="color:#f92672">=</span> LogisticRegression(solver<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lbfgs&#39;</span>)
model<span style="color:#f92672">.</span>fit(X_train_enc, y_train_enc)
<span style="color:#75715e"># evaluate the model</span>
yhat <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(X_test_enc)
<span style="color:#75715e"># evaluate predictions</span>
accuracy <span style="color:#f92672">=</span> accuracy_score(y_test_enc, yhat)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Accuracy: </span><span style="color:#e6db74">%.2f</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> (accuracy<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>))
</code></pre></div><p>Kết quả:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Accuracy: <span style="color:#ae81ff">75.79</span>
</code></pre></div><h4 id="42-model-built-using-chi-squared-features">4.2 Model Built Using Chi-Squared Features</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># evaluation of a model fit using chi squared input features</span>
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> LabelEncoder
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> OrdinalEncoder
<span style="color:#f92672">from</span> sklearn.feature_selection <span style="color:#f92672">import</span> SelectKBest
<span style="color:#f92672">from</span> sklearn.feature_selection <span style="color:#f92672">import</span> chi2
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
<span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
<span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> accuracy_score

<span style="color:#75715e"># load the dataset</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_dataset</span>(filename):
	<span style="color:#75715e"># load the dataset as a pandas DataFrame</span>
	data <span style="color:#f92672">=</span> read_csv(filename, header<span style="color:#f92672">=</span>None)
	<span style="color:#75715e"># retrieve numpy array</span>
	dataset <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>values
	<span style="color:#75715e"># split into input (X) and output (y) variables</span>
	X <span style="color:#f92672">=</span> dataset[:, :<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
	y <span style="color:#f92672">=</span> dataset[:,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
	<span style="color:#75715e"># format all fields as string</span>
	X <span style="color:#f92672">=</span> X<span style="color:#f92672">.</span>astype(str)
	<span style="color:#66d9ef">return</span> X, y

<span style="color:#75715e"># prepare input data</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">prepare_inputs</span>(X_train, X_test):
	oe <span style="color:#f92672">=</span> OrdinalEncoder()
	oe<span style="color:#f92672">.</span>fit(X_train)
	X_train_enc <span style="color:#f92672">=</span> oe<span style="color:#f92672">.</span>transform(X_train)
	X_test_enc <span style="color:#f92672">=</span> oe<span style="color:#f92672">.</span>transform(X_test)
	<span style="color:#66d9ef">return</span> X_train_enc, X_test_enc

<span style="color:#75715e"># prepare target</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">prepare_targets</span>(y_train, y_test):
	le <span style="color:#f92672">=</span> LabelEncoder()
	le<span style="color:#f92672">.</span>fit(y_train)
	y_train_enc <span style="color:#f92672">=</span> le<span style="color:#f92672">.</span>transform(y_train)
	y_test_enc <span style="color:#f92672">=</span> le<span style="color:#f92672">.</span>transform(y_test)
	<span style="color:#66d9ef">return</span> y_train_enc, y_test_enc

<span style="color:#75715e"># feature selection</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">select_features</span>(X_train, y_train, X_test):
	fs <span style="color:#f92672">=</span> SelectKBest(score_func<span style="color:#f92672">=</span>chi2, k<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>)
	fs<span style="color:#f92672">.</span>fit(X_train, y_train)
	X_train_fs <span style="color:#f92672">=</span> fs<span style="color:#f92672">.</span>transform(X_train)
	X_test_fs <span style="color:#f92672">=</span> fs<span style="color:#f92672">.</span>transform(X_test)
	<span style="color:#66d9ef">return</span> X_train_fs, X_test_fs

<span style="color:#75715e"># load the dataset</span>
X, y <span style="color:#f92672">=</span> load_dataset(<span style="color:#e6db74">&#39;breast-cancer.csv&#39;</span>)
<span style="color:#75715e"># split into train and test sets</span>
X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X, y, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.33</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
<span style="color:#75715e"># prepare input data</span>
X_train_enc, X_test_enc <span style="color:#f92672">=</span> prepare_inputs(X_train, X_test)
<span style="color:#75715e"># prepare output data</span>
y_train_enc, y_test_enc <span style="color:#f92672">=</span> prepare_targets(y_train, y_test)
<span style="color:#75715e"># feature selection</span>
X_train_fs, X_test_fs <span style="color:#f92672">=</span> select_features(X_train_enc, y_train_enc, X_test_enc)
<span style="color:#75715e"># fit the model</span>
model <span style="color:#f92672">=</span> LogisticRegression(solver<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lbfgs&#39;</span>)
model<span style="color:#f92672">.</span>fit(X_train_fs, y_train_enc)
<span style="color:#75715e"># evaluate the model</span>
yhat <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(X_test_fs)
<span style="color:#75715e"># evaluate predictions</span>
accuracy <span style="color:#f92672">=</span> accuracy_score(y_test_enc, yhat)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Accuracy: </span><span style="color:#e6db74">%.2f</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> (accuracy<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>))
</code></pre></div><p>Kết quả:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Accuracy: <span style="color:#ae81ff">74.74</span>
</code></pre></div><h4 id="43-model-built-using-mutual-information-features">4.3 Model Built Using Mutual Information Features</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># evaluation of a model fit using mutual information input features</span>
<span style="color:#f92672">from</span> pandas <span style="color:#f92672">import</span> read_csv
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> LabelEncoder
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> OrdinalEncoder
<span style="color:#f92672">from</span> sklearn.feature_selection <span style="color:#f92672">import</span> SelectKBest
<span style="color:#f92672">from</span> sklearn.feature_selection <span style="color:#f92672">import</span> mutual_info_classif
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
<span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
<span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> accuracy_score

<span style="color:#75715e"># load the dataset</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_dataset</span>(filename):
	<span style="color:#75715e"># load the dataset as a pandas DataFrame</span>
	data <span style="color:#f92672">=</span> read_csv(filename, header<span style="color:#f92672">=</span>None)
	<span style="color:#75715e"># retrieve numpy array</span>
	dataset <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>values
	<span style="color:#75715e"># split into input (X) and output (y) variables</span>
	X <span style="color:#f92672">=</span> dataset[:, :<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
	y <span style="color:#f92672">=</span> dataset[:,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
	<span style="color:#75715e"># format all fields as string</span>
	X <span style="color:#f92672">=</span> X<span style="color:#f92672">.</span>astype(str)
	<span style="color:#66d9ef">return</span> X, y

<span style="color:#75715e"># prepare input data</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">prepare_inputs</span>(X_train, X_test):
	oe <span style="color:#f92672">=</span> OrdinalEncoder()
	oe<span style="color:#f92672">.</span>fit(X_train)
	X_train_enc <span style="color:#f92672">=</span> oe<span style="color:#f92672">.</span>transform(X_train)
	X_test_enc <span style="color:#f92672">=</span> oe<span style="color:#f92672">.</span>transform(X_test)
	<span style="color:#66d9ef">return</span> X_train_enc, X_test_enc

<span style="color:#75715e"># prepare target</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">prepare_targets</span>(y_train, y_test):
	le <span style="color:#f92672">=</span> LabelEncoder()
	le<span style="color:#f92672">.</span>fit(y_train)
	y_train_enc <span style="color:#f92672">=</span> le<span style="color:#f92672">.</span>transform(y_train)
	y_test_enc <span style="color:#f92672">=</span> le<span style="color:#f92672">.</span>transform(y_test)
	<span style="color:#66d9ef">return</span> y_train_enc, y_test_enc

<span style="color:#75715e"># feature selection</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">select_features</span>(X_train, y_train, X_test):
	fs <span style="color:#f92672">=</span> SelectKBest(score_func<span style="color:#f92672">=</span>mutual_info_classif, k<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>)
	fs<span style="color:#f92672">.</span>fit(X_train, y_train)
	X_train_fs <span style="color:#f92672">=</span> fs<span style="color:#f92672">.</span>transform(X_train)
	X_test_fs <span style="color:#f92672">=</span> fs<span style="color:#f92672">.</span>transform(X_test)
	<span style="color:#66d9ef">return</span> X_train_fs, X_test_fs

<span style="color:#75715e"># load the dataset</span>
X, y <span style="color:#f92672">=</span> load_dataset(<span style="color:#e6db74">&#39;breast-cancer.csv&#39;</span>)
<span style="color:#75715e"># split into train and test sets</span>
X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X, y, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.33</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
<span style="color:#75715e"># prepare input data</span>
X_train_enc, X_test_enc <span style="color:#f92672">=</span> prepare_inputs(X_train, X_test)
<span style="color:#75715e"># prepare output data</span>
y_train_enc, y_test_enc <span style="color:#f92672">=</span> prepare_targets(y_train, y_test)
<span style="color:#75715e"># feature selection</span>
X_train_fs, X_test_fs <span style="color:#f92672">=</span> select_features(X_train_enc, y_train_enc, X_test_enc)
<span style="color:#75715e"># fit the model</span>
model <span style="color:#f92672">=</span> LogisticRegression(solver<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lbfgs&#39;</span>)
model<span style="color:#f92672">.</span>fit(X_train_fs, y_train_enc)
<span style="color:#75715e"># evaluate the model</span>
yhat <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(X_test_fs)
<span style="color:#75715e"># evaluate predictions</span>
accuracy <span style="color:#f92672">=</span> accuracy_score(y_test_enc, yhat)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Accuracy: </span><span style="color:#e6db74">%.2f</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> (accuracy<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>))
</code></pre></div><p>Kết quả:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Accuracy: <span style="color:#ae81ff">76.84</span>
</code></pre></div><p>Theo các kết quả thu được từ 3 lần thí nghiệm thì có thể thấy rằng Mutual Information mang lại kết quả tốt nhất. Để kết quả được <em>tin cậy</em> hơn, bạn có thể sử dụng k-Fold Cross-Validation thay vì chỉ chia Train/Test thông thường.</p>
<h3 id="5-kết-luận">5. Kết luận</h3>
<p>Bài thứ 2 về chủ đề Feature Selection, mình đã giới thiệu 2 kỹ thuật Chi-Squared Statistic và Mutual Information áp dụng cho Input Variables dạng Categorical.</p>
<p>Toàn bộ code của bài này, các bạn có thể tham khảo tại <a href="https://github.com/tiensu/Data_Preparation_for_ML/tree/master/03_Feature_Selection/Categorical_Input_Variable">đây</a>.</p>
<p>Bài tiếp theo sẽ là các kỹ thuật Feature Selection áp dụng cho Input Variables dạng Numerical. Mời các bạn đón đọc.</p>
<h3 id="6-tham-khảo">6. Tham khảo</h3>
<p>[1] Jason Brownlee, &ldquo;Data Preparation for Machine Learning&rdquo;, Book: <a href="https://machinelearningmastery.com/data-preparation-for-machine-learning/">https://machinelearningmastery.com/data-preparation-for-machine-learning/</a>.</p>

        </div>

        
        
      </div>
    </div>
  </div>
</section>



<footer>
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 text-center mb-5">
        <a href="https://tiensu.github.io/"><img src="https://tiensu.github.io/images/logo3.jpg" alt="SuNT&#39;s Blog | AI in Practical" style="height: auto"></a>
      </div>
               
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Contact Me</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="tel:0869644890"><i
                class="ti-mobile mr-3 text-primary"></i>0869644890</a></li>
          
                     
          <li class="mb-3"><i class="ti-location-pin mr-3 text-primary"></i>Hanoi, Vietnam</li>
          
                     
          <li class="mb-3"><a class="text-dark" href="mailto:tiensunguyen2103@gmail.com"><i
                class="ti-email mr-3 text-primary"></i>tiensunguyen2103@gmail.com</a>
          
          </li>
        </ul>
      </div>
      
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Social Contacts</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://www.facebook.com/tiensunguyen2103">Facebook</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://www.linkedin.com/in/su-nguyen-tien-aws%C2%AE-5ba74ba6/">Linkedin</a></li>
          
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Categories</h6>
        <ul class="list-unstyled">
          <li class="mb-3"><a class="text-dark"
              href="/categories/algorithm-optimization">Algorithm Optimization</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/attention">Attention</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/audio-classification">Audio Classification</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/autoencoder">Autoencoder</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/bert">BERT</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/cnn">CNN</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ctc">CTC</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-driff">Data Driff</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-imbalance">Data Imbalance</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-preparation">Data Preparation</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/data-science">Data Science</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/deep-learning">Deep Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/docker">Docker</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ebook">Ebook</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ensemble-learning">Ensemble Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/face-recognition">Face Recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/game">Game</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/human-action-recognition">Human action recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/human-pose">Human pose</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/image-classification">Image Classification</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/kubernetes">Kubernetes</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/lstm">LSTM</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/machine-learning">Machine Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/mlops">MLOps</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/neural-network">Neural Network</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/nlp">Nlp</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/object-detection">Object Detection</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/ocr">OCR</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/one-shot-learning">One Shot Learning</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/project-management">Project Management</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/recommender-system">Recommender System</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/rnn">RNN</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/scalability">Scalability</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/siamese-network">Siamese Network</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/speech-recognition">Speech Recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/speech-to-text">Speech To Text</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-classification">Text Classification</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-detection">Text Detection</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-generation">Text generation</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/text-recognition">Text Recognition</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/transformer">Transformer</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/xgboost">XGBoost</a>
          </li>
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Quick Links</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://tiensu.github.io/about">About</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://tiensu.github.io/blog">Post</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://tiensu.github.io/contact">Contact</a></li>
          
        </ul>
      </div>
      <div class="col-12 border-top py-4 text-center">
        | copyright © 2021 <a href="tiensu.github.io">SuNT</a>. All Rights Reserved |
      </div>
    </div>
  </div>
</footer>

<script>
  var indexURL = "https://tiensu.github.io/index.json"
</script>

<!-- JS Plugins -->

<script src="https://tiensu.github.io/plugins/jQuery/jquery.min.js"></script>

<script src="https://tiensu.github.io/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://tiensu.github.io/plugins/slick/slick.min.js"></script>

<script src="https://tiensu.github.io/plugins/venobox/venobox.min.js"></script>

<script src="https://tiensu.github.io/plugins/search/fuse.min.js"></script>

<script src="https://tiensu.github.io/plugins/search/mark.js"></script>

<script src="https://tiensu.github.io/plugins/search/search.js"></script>

<!-- Main Script -->

<script src="https://tiensu.github.io/js/script.min.js"></script>




<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"></script>
<div id="js-cookie-box" class="cookie-box cookie-box-hide">
	This site uses cookies. By continuing to use this website, you agree to their use. <span id="js-cookie-button" class="btn btn-sm btn-primary ml-2">I Accept</span>
</div>
<script>
	(function ($) {
		const cookieBox = document.getElementById('js-cookie-box');
		const cookieButton = document.getElementById('js-cookie-button');
		if (!Cookies.get('cookie-box')) {
			cookieBox.classList.remove('cookie-box-hide');
			cookieButton.onclick = function () {
				Cookies.set('cookie-box', true, {
					expires:  2 
				});
				cookieBox.classList.add('cookie-box-hide');
			};
		}
	})(jQuery);
</script>


<style>
.cookie-box {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  text-align: center;
  z-index: 9999;
  padding: 1rem 2rem;
  background: rgb(71, 71, 71);
  transition: all .75s cubic-bezier(.19, 1, .22, 1);
  color: #fdfdfd;
}

.cookie-box-hide {
  display: none;
}
</style>
</body>
</html>