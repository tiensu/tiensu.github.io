<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="format-detection" content="telephone=no" />

    <title>
        Neural Network cơ bản (Phần 2) | ML in Practical
    </title>


    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#ffffff" />


    <link rel="stylesheet" href="https://unpkg.com/modern-normalize@0.6.0/modern-normalize.css" />





    <link rel="stylesheet" href="https://tiensu.github.io/style.min.388cbd0ce358245ec0dfcee3b8889b3cc50e2bb8a5b2bcd40f8bd092ebefb81a.css" integrity="sha256-OIy9DONYJF7A387juIibPMUOK7ilsrzUD4vQkuvvuBo=" />




    <script type="application/javascript">
        var doNotTrack = false;
        if (!doNotTrack) {
            (function(i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r;
                i[r] = i[r] || function() {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date();
                a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0];
                a.async = 1;
                a.src = g;
                m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
            ga('create', 'UA-180180568-1', 'auto');
            ga('set', 'anonymizeIp', true);
            ga('send', 'pageview');
        }
    </script>


</head>

<body>
    <header id="header">

        <script type="application/javascript">
            var doNotTrack = false;
            if (!doNotTrack) {
                (function(i, s, o, g, r, a, m) {
                    i['GoogleAnalyticsObject'] = r;
                    i[r] = i[r] || function() {
                        (i[r].q = i[r].q || []).push(arguments)
                    }, i[r].l = 1 * new Date();
                    a = s.createElement(o),
                        m = s.getElementsByTagName(o)[0];
                    a.async = 1;
                    a.src = g;
                    m.parentNode.insertBefore(a, m)
                })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
                ga('create', 'UA-180180568-1', 'auto');
                ga('set', 'anonymizeIp', true);
                ga('send', 'pageview');
            }
        </script>

        <div class="header_container">
            <h1 class="sitetitle">
                <a href="https://tiensu.github.io/" title="ML in Practical">ML in Practical</a>
            </h1>
            <nav class="navbar">
                <ul>
                    <li><a href="https://tiensu.github.io/">Home</a></li>

                    <li>
                        <a href="/about/">

                            <span>About</span>
                        </a>
                    </li>

                    <li>
                        <a href="/tags/">

                            <span>Tags</span>
                        </a>
                    </li>

                    <li>
                        <a href="/archives/">

                            <span>Archives</span>
                        </a>
                    </li>

                    <li class="hide-sm"><a href="https://tiensu.github.io/index.xml" type="application/rss+xml">RSS</a></li>
                </ul>
            </nav>
        </div>
        <script>
            MathJax = {
                tex: {
                    inlineMath: [
                        ['$', '$'],
                        ['\\(', '\\)']
                    ],
                    displayMath: [
                        ['$$', '$$'],
                        ['\\[', '\\]']
                    ],
                    processEscapes: true,
                    processEnvironments: true
                },
                options: {
                    skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
                }
            };

            window.addEventListener('load', (event) => {
                document.querySelectorAll("mjx-container").forEach(function(x) {
                    x.parentElement.classList += 'has-jax'
                })
            });
        </script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


    </header>


    <section id="main">
        <article class="post content">
            <h2 class="title">Neural Network cơ bản (Phần 2)</h2>
            <div class="post_content">
                <p>Trong quá trình tìm hiểu về mạng NN, mình thấy khá là khó hiểu, đặc biệt với các bạn không mạnh về toán. Bài này, mình sẽ diễn giải cách thức làm việc của NN một cách trực quan, dễ hiểu cho các bạn thông qua một ví dụ cụ thể.</p>

                <p><strong>1. Nhắc lại lý thuyết</strong></p>

                <p>Giả sử ta có mạng NN như sau:</p>



                <div style="text-align:center">
                    <img src="\neural_network-1.png">
                </div>



                <p>Quá trình training model bao gồm 2 phases:</p>

                <p><strong><em>1.1 Forward Path</em></strong></p>

                <p>Phase này tính toán (<em>dự đoán</em>) đầu ra $o_1, o_2$, tính loss.</p>

                <p>Giả sử activation là hàm sigmoid:


                    <div style="text-align:center">
                        <img src="\sigmoid.png">
                    </div>

                </p>

                <p>Ta sẽ tính lần lượt các đại lượng trung gian:</p>

                <ul>
                    <li>$in_{h_1}$: input của $h_1$</li>
                    <li>$in_{h_2}$: input của $h_2$</li>
                    <li>$out_{h_1}$: output của $h_1$</li>
                    <li>$out_{h_2}$: output của $h_2$</li>
                    <li>$in_{o_1}$: input của $o_1$</li>
                    <li>$in_{o_2}$: input của $o_2$</li>
                    <li>$out_{o_1}$: output của $o_1$</li>
                    <li>$out_{o_2}: output của $o_2$$</li>
                </ul>

                <p>Công thức tính của từng đại lượng như sau:</p>



                <div style="text-align:left; margin-left: 400px">
                    <p>$in_{h_1} = w_1 * i_1 + w_2 * i_2 + b_1 * 1$</p>
                    <p>$in_{h_2} = w_3 * i_1 + w_4 * i_2 + b_1 * 1$</p>
                    <p>$out_{h_1} = sigmoid(in_{h_1}) =$<span style="font-size:22px">$\frac{1}{1 + e^{-in_{h_1}}}$</span></p>
                    <p>$out_{h_2} = sigmoid(in_{h_2}) =$<span style="font-size:22px">$\frac{1}{1 + e^{-in_{h_2}}}$</span></p>
                    <p>$in_{o_1} = w_5 * out_{h_1} + w_6 * out_{h_2} + b_2 * 1$</p>
                    <p>$in_{o_2} = w_7 * out_{h_1} + w_8 * out_{h_2} + b_2 * 1$</p>
                    <p>$out_{o_1} = sigmoid(in_{o_1}) =$<span style="font-size:22px">$\frac{1}{1 + e^{-in_{o_1}}}$</span></p>
                    <p>$out_{o_2} = sigmoid(in_{o_2}) =$<span style="font-size:22px">$\frac{1}{1 + e^{-in_{o_2}}}$</span></p>
                </div>



                <p>Tiếp theo là tính loss bằng cách so sánh đầu ra của mạng NN với các giá trị thực tế:</p>

                <ul>
                    <li>$target_{o_1}$</li>
                    <li>$target_{o_2}$:</li>
                </ul>

                <p>Công thức tính loss như sau:</p>



                <div style="text-align:left; margin-left: 400px">
                    <p>$E_{total} = \sum_{i=1}^2 E_{o_i} = \sum_{i=1}^2 \frac{1}{2} (target_{o_i} - out_{o_i})^2 = E_{o_1} + E_{o_2}$</p>
                    <p>$E_{o_1} = \frac{1}{2} (target_{o_1} - out_{o_1})^2$</p>
                    <p>$E_{o_2} = \frac{1}{2} (target_{o_2} - out_{o_2})^2$</p>
                </div>



                <p><strong><em>1.2 Backward Path</em></strong></p>

                <p>Mục đích của phase này là cập nhật trọng số $w$ sao cho tối thiểu hóa loss.</p>

                <p>Ta sẽ sử dụng thuật toán tối ưu <code>Stochastic Gradient Descent (SGD)</code> để cập nhật $w$.</p>

                <p>Công thức cập nhật như sau:</p>



                <div style="text-align:center">$\theta = \theta - \eta \nabla_\theta f(\theta)$</div>



                <p>với:</p>

                <ul>
                    <li>$\nabla_\theta f(\theta)$ là đạo hàm của Loss Function tại $\theta$ (<em>đạo hàm từng phần theo $\nabla$</em>).</li>
                    <li>$\eta$ là một số &gt; 0, gọi là <code>learning rate</code>.</li>
                    <li>$\theta$ là tập hợp các vector các tham số của model cần tối ưu. Trong trường hợp này là các trọng số $w$.</li>
                </ul>

                <p>Đạo hàm từng phần của các $w$ tại output layer được tính theo quy tắc <a href="https://en.wikipedia.org/wiki/Chain_rule">chain rule</a> như sau:</p>



                <div style="text-align:center; font-size:22px">
                    <p>$\frac{\partial E_{total}}{\partial w_5} = \frac{\partial E_{total}}{\partial out_{o_1}} * \frac{\partial out_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial w_5}$</p>
                    <p>$\frac{\partial E_{total}}{\partial w_6} = \frac{\partial E_{total}}{\partial out_{o_1}} * \frac{\partial out_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial w_6}$</p>
                    <p>$\frac{\partial E_{total}}{\partial w_7} = \frac{\partial E_{total}}{\partial out_{o_2}} * \frac{\partial out_{o_2}}{\partial in_{o_2}} * \frac{\partial in_{o_2}}{\partial w_7}$</p>
                    <p>$\frac{\partial E_{total}}{\partial w_8} = \frac{\partial E_{total}}{\partial out_{o_2}} * \frac{\partial out_{o_2}}{\partial in_{o_2}} * \frac{\partial in_{o_2}}{\partial w_8}$</p>
                </div>



                <p>Đạo hàm từng phần của các $w$ tại hidden layer được tính như sau:</p>



                <div style="text-align:center; font-size:22px">
                    <p>$\frac{\partial E_{total}}{\partial w_1} = \frac{\partial E_{total}}{\partial out_{h_1}} * \frac{\partial out_{h_1}}{\partial in_{h_1}} * \frac{\partial in_{h_1}}{\partial w_1}$</p>
                    <p>$\frac{\partial E_{total}}{\partial w_2} = \frac{\partial E_{total}}{\partial out_{h_1}} * \frac{\partial out_{h_1}}{\partial in_{h_1}} * \frac{\partial in_{h_1}}{\partial w_2}$</p>
                    <p>$\frac{\partial E_{total}}{\partial w_3} = \frac{\partial E_{total}}{\partial out_{h_2}} * \frac{\partial out_{h_2}}{\partial in_{h_2}} * \frac{\partial in_{h_2}}{\partial w_3}$</p>
                    <p>$\frac{\partial E_{total}}{\partial w_4} = \frac{\partial E_{total}}{\partial out_{h_2}} * \frac{\partial out_{h_2}}{\partial in_{h_2}} * \frac{\partial in_{h_2}}{\partial w_4}$</p>
                </div>



                <p>Sau khi tính được đạo hàm từng phần của mỗi $w$, ta áp dụng công thức phía trên để cập nhật $w$.</p>

                <p><strong>2. Ví dụ áp dụng</strong></p>

                <p>Vẫn với kiến trúc mạng như trên, ta sẽ gán các giá trị khởi tạo cho các tham số như hình bên dưới:</p>



                <div style="text-align:center">
                    <img src="\neural_network-2.png">
                </div>



                <p>Ok, bây giờ ta sẽ bắt đầu đi tính toán.</p>

                <p><strong>2.1 Fordward Path</strong></p>

                <p>Input của $h_1$:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p>$in_{h_1} = w_1 * i_1 + w_2 * i_2 + b_1 * 1$</p>
                    <p>$in_{h_1} = 0.15 * 0.05 + 0.2 * 0.1 + 0.35 * 1$</p>
                    <p>$in_{h_1} = 0.3775$</p>
                </div>



                <p>Input của $h_2$:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p>$in_{h_2} = w_3 * i_1 + w_4 * i_2 + b_1 * 1$</p>
                    <p>$in_{h_2} = 0.25 * 0.05 + 0.3 * 0.1 + 0.35 * 1$</p>
                    <p>$in_{h_2} = 0.3925$</p>
                </div>



                <p>Ouput của $h_1$:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p>$out_{h_1} = $<span style="font-size:22px"> $\frac{1}{1 + e^{-in_{h_1}}}$</span></p>
                    <p>$out_{h_1} = \frac{1}{1 + e^{-0.3775}}$</p>
                    <p>$out_{h_1} = 0.593269992$</p>
                </div>



                <p>Output của $h_2$:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p>$out_{h_2} = $<span style="font-size:22px"> $\frac{1}{1 + e^{-in_{h_2}}}$</span></p>
                    <p>$out_{h_2} = \frac{1}{1 + e^{-0.3925}}$</p>
                    <p>$out_{h_2} = 0.596884378$</p>
                </div>



                <p>Input của $o_1$:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p>$in_{o_1} = w_5 * out_{h_1} + w_6 * out_{h_2} + b_2 * 1$</p>
                    <p>$in_{o_1} = 0.4 * 0.593269992 + 0.45 * 0.596884378 + 0.6 * 1$</p>
                    <p>$in_{o_1} = 1.105905967$</p>
                </div>



                <p>Input của $o_2$:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p>$in_{o_2} = w_7 * out_{h_1} + w_8 * out_{h_2} + b_2 * 1$</p>
                    <p>$in_{o_2} = 0.5 * 0.593269992 + 0.55 * 0.596884378 + 0.6 * 1$</p>
                    <p>$in_{o_2} = 1.224921404$</p>
                </div>



                <p>Output của $o_1$:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p>$out_{o_1} = $<span style="font-size:22px"> $\frac{1}{1 + e^{-in_{o_1}}}$</span></p>
                    <p>$out_{o_1} = \frac{1}{1 + e^{-1.105905967}}$</p>
                    <p>$out_{o_1} = 0.75136507$</p>
                </div>



                <p>Output cuat $o_2$:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p>$out_{o_2} = $<span style="font-size:22px"> $\frac{1}{1 + e^{-in_{o_2}}}$</span></p>
                    <p>$out_{o_2} = \frac{1}{1 + e^{-1.224921404}}$</p>
                    <p>$out_{o_2} = 0.772928465$</p>
                </div>



                <p>Tổng lỗi:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p>$E_{o_1} = \frac{1}{2} (target_{o_1} - out_{o_1})^2$</p>
                    <p>$E_{o_2} = \frac{1}{2} (0.01 - 0.75136507)^2$</p>
                    <p>$E_{o_1} = 0.274811083$</p>
                </div>





                <div style="text-align:left; margin-left: 200px">
                    <p>$E_{o_2} = \frac{1}{2} (target_{o_1} - out_{o_1})^2$</p>
                    <p>$E_{o_2} = \frac{1}{2} (0.01 - 0.772928465)^2$</p>
                    <p>$E_{o_2} = 0.023560026$</p>
                </div>





                <div style="text-align:left; margin-left: 200px">
                    <p>$E_{total} = \sum_{i=1}^2 E_{o_i}$</p>
                    <p>$E_{total} = 0.274811083 + 0.023560026$</p>
                    <p>$E_{total} = 0.298371109$</p>
                </div>



                <p><strong><em>2.2 Backward Path</em></strong></p>

                <p>Tính đạo hàm từng phần của Loss Function theo mỗi $w$.</p>

                <p>Các $w$ của output layer ($w_5, w_6, w_7, w_8$) có cách tính giống nhau:</p>

                <ul>
                    <li>$w_5$:</li>
                </ul>



                <div style="text-align:left; font-size:22px; margin-left: 200px">
                    <p>$\frac{\partial E_{total}}{\partial w_5} = \frac{\partial E_{total}}{\partial out_{o_1}} * \frac{\partial out_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial w_5}$</p>
                </div>



                <p>Ta biết:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p>$E_{total} = \sum_{i=1}^2 \frac{1}{2} (target_{o_i} - out_{o_i})^2$</p>
                    <p>$E_{total} = \frac{1}{2} (target_{o_1} - out_{o_1})^2 + \frac{1}{2} (target_{o_2} - out_{o_2})^2$</p>
                </div>



                <p>Nên:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{o_1}}$</span> $ = 2 * \frac{1}{2} (target_{o_1} - out_{o_1})^{2-1} * (-1) + 0$</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{o_1}}$</span> $ = -(target_{o_1} - out_{o_1})$</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{o_1}}$</span> $ = -(0.01 - 0.75136507) = 0.74136507$</p>
                </div>



                <p>Tiếp theo, vì:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p>$out_{o_1} = sigmoid(in_{o_1}) =$ <span style="font-size:22px">$\frac{1}{1 + e^{-in_{01}}}$</span></p>
                </div>



                <p>Nên:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial out_{o_1}}{\partial in_{o_1}}$</span> $ = out_{o_1}(1 - out_{o_1})$</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{o_1}}{\partial in_{o_1}}$</span> $ = 0.75136507(1 - 0.75136507)$</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{o_1}}{\partial in_{o_1}}$</span> $ = 0.186815602$</p>
                </div>



                <p>Và,


                    <div style="text-align:left; margin-left: 200px">
                        <p>$in_{o_1} = w_5 * out_{h_1} + w_6 * out_{h_2} + b_2 * 1$</p>
                    </div>

                </p>

                <p>Nên:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial w_5}$</span> $ = out_{h_1}$</p>
                    <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial w_5}$</span> $ = 0.593269992$</p>
                </div>



                <p>Tổng hợp lại ta được:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_5} = \frac{\partial E_{total}}{\partial out_{o_1}} * \frac{\partial out_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial w_5}$$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_5}$</span> $ = 0.74136507 * 0.186815602 * 0.593269992$</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_5}$</span> $ = 0.082167041$</p>
                </div>



                <ul>
                    <li>$w_6$:</li>
                </ul>



                <div style="text-align:left; font-size:22px; margin-left: 200px">
                    <p>$\frac{\partial E_{total}}{\partial w_6} = \frac{\partial E_{total}}{\partial out_{o_1}} * \frac{\partial out_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial w_6}$</p>
                </div>





                <div style="text-align:left; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{o_1}} = 2 * \frac{1}{2} (target_{o_1} - out_{o_1})^{2-1} * (-1) + 0$$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{o_1}}$</span> $ = -(target_{o_1} - out_{o_1})$</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{o_1}}$</span> $ = -(0.01 - 0.75136507) = 0.74136507$</p>
                </div>





                <div style="text-align:left; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial out_{o_1}}{\partial in_{o_1}}$</span> $ = out_{o_1}(1 - out_{o_1})$</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{o_1}}{\partial in_{o_1}}$</span> $ = 0.75136507(1 - 0.75136507)$</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{o_1}}{\partial in_{o_1}}$</span> $ = 0.186815602$</p>
                </div>





                <div style="text-align:left; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial w_6} $</span> $= out_{h_2}$</p>
                    <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial w_6}$</span> $ = 0.596884378$</p>
                </div>



                <p>Tổng hợp lại ta được:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_6} = \frac{\partial E_{total}}{\partial out_{o_1}} * \frac{\partial out_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial w_6}$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_6}$</span> $ = 0.74136507 * 0.186815602 * 0.596884378$</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_6} $</span> $= 0.082667628$</p>
                </div>



                <ul>
                    <li>$w_7$:</li>
                </ul>



                <div style="text-align:left; font-size:22px; margin-left: 200px">
                    <p>$\frac{\partial E_{total}}{\partial w_7} = \frac{\partial E_{total}}{\partial out_{o_2}} * \frac{\partial out_{o_2}}{\partial in_{o_2}} * \frac{\partial in_{o_2}}{\partial w_7}$</p>
                </div>





                <div style="text-align:left; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{o_2}} = 0 + 2 * \frac{1}{2} (target_{o_2} - out_{o_2})^{2-1} * (-1)$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{o_2}}$</span> $ = -(target_{o_2} - out_{o_2})$</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{o_2}}$</span> $ = -(0.99 - 0.772928465) = -0.217071535$</p>
                </div>





                <div style="text-align:left; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial out_{o_2}}{\partial in_{o_2}}$</span> $ = out_{o_2}(1 - out_{o_2})$</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{o_2}}{\partial in_{o_2}} $</span> $= 0.772928465(1 - 0.772928465)$</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{o_2}}{\partial in_{o_2}} $</span> $= 0.175510053$</p>
                </div>





                <div style="text-align:left; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial w_7}$</span> $ = out_{h_1}$</p>
                    <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial w_7} $</span> $= 0.593269992$</p>
                </div>



                <p>Tổng hợp lại ta được:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_6} = \frac{\partial E_{total}}{\partial out_{o_1}} * \frac{\partial out_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial w_6}$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_6} $</span> $= -0.217071535 * 0.175510053 * 0.593269992$</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_6} $</span> $= -0.022602541$</p>
                </div>



                <ul>
                    <li>$w_8$:</li>
                </ul>



                <div style="text-align:left; font-size:22px; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_8} = \frac{\partial E_{total}}{\partial out_{o_2}} * \frac{\partial out_{o_2}}{\partial in_{o_2}} * \frac{\partial in_{o_2}}{\partial w_8}$</p>
    </div>





    <div style="text-align:left; margin-left: 200px">
       <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{o_2}} = 0 + 2 * \frac{1}{2} (target_{o_2} - out_{o_2})^{2-1} * (-1)$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{o_2}} $</span> $= -(target_{o_2} - out_{o_2})$</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{o_2}} $</span> $= -(0.99 - 0.772928465) = -0.217071535$</p>
                </div>





                <div style="text-align:left; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial out_{o_2}}{\partial in_{o_2}} $</span> $= out_{o_2}(1 - out_{o_2})$</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{o_2}}{\partial in_{o_2}} $</span> $= 0.772928465(1 - 0.772928465)$</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{o_2}}{\partial in_{o_2}} $</span> $= 0.175510053$</p>
                </div>





                <div style="text-align:left; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial w_8} $</span> $= out_{h_2}$</p>
                    <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial w_8} $</span> $= 0.596884378$</p>
                </div>



                <p>Tổng hợp lại ta được:</p>



                <div style="text-align:left; margin-left: 200px">
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_6} = \frac{\partial E_{total}}{\partial out_{o_1}} * \frac{\partial out_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial w_6}$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_6} $</span> $= -0.217071535 * 0.175510053 * 0.596884378$</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_6} $</span> $= -0.022740242$</p>
                </div>



                <p>Các $w$ của hidden layer ($w_1, w_2, w_3, w_4$) có cách tính giống nhau:</p>

                <ul>
                    <li>$w_1$:</li>
                </ul>



                <div style="text-align:left; font-size:22px; margin-left:50px">
                    <p>$\frac{\partial E_{total}}{\partial w_1} = \frac{\partial E_{total}}{\partial out_{h_1}} * \frac{\partial out_{h_1}}{\partial in_{h_1}} * \frac{\partial in_{h_1}}{\partial w_1}$</p>
                    <p>--------------------------------------------------------------</p>
                </div>





                <div style="text-align:left; margin-left: 100px; font-size:22px">
                    <p>$\frac{\partial E_{total}}{\partial out_{h_1}} = \frac{\partial E_{o_1}}{\partial out_{h_1}} + \frac{\partial E_{o_2}}{\partial out_{h_1}}$</p>
                    <p>----------------------------------------------------</p>
                </div>





                <div style="text-align:left; margin-left: 150px; font-size:22px">
                    <!-- E o1/ out h1 -->
                    <p>$\frac{\partial E_{o_1}}{\partial out_{h_1}} = \frac{\partial E_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial out_{h_1}}$</p>
                    <p>---------------------------------</p>
                </div>



                <p>

                    <div style="text-align:left; margin-left: 200px">
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} = \frac{\partial E_{o_1}}{\partial out_{o_1}} * \frac{\partial out_{o_1}}{\partial in_{o_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} = \frac{\partial (\frac{1}{2}(target_{o_1} - out_{o_1})^2)}{\partial out_{o_1}} * \frac{\partial (\frac{1}{1 + e^{-in_{o_1}}})}{\partial in_{o_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} $</span>$ = 2 * \frac{1}{2} (target_{o_1} - out_{o_1}) * (-1) * out_{o_1}(1 - out_{o_1})$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}}$</span> $ = (0.01 - 0.75136507) * (-1) * 0.75136507(1 - 0.75136507)$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} $</span> $= 0.138498562$</p>
                        <p>-------------------------</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial out_{h_1}} = \frac{\partial (w_5 * out_{h_1} + w_6 * out_{h_2} + b_2 * 1)}{\partial out_{h_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial out_{h_1}}$</span> $ = w_5$</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial out_{h_1}}$</span> $ = 0.4$</p>
                        <p>Gộp lại:</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial out_{h_1}} = \frac{\partial E_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial out_{h_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial out_{h_1}}$</span> $ = 0.138498562 * 0.4$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial out_{h_1}} $</span> $= 0.055399425$</p>
                        <p>----------------------------------------------------</p>
                    </div>




                    <div style="text-align:left; margin-left: 150px; font-size:22px">
                        <!-- E o2/out h1 -->
                        <p>$\frac{\partial E_{o_2}}{\partial out_{h_1}} = \frac{\partial E_{o_2}}{\partial in_{o_2}} * \frac{\partial in_{o_2}}{\partial out_{h_1}}$</p>
                        <p>---------------------------------</p>
                    </div>




                    <div style="text-align:left; margin-left: 200px">
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_2}} = \frac{\partial E_{o_2}}{\partial out_{o_2}} * \frac{\partial out_{o_2}}{\partial in_{o_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_2}} = \frac{\partial (\frac{1}{2}(target_{o_2} - out_{o_2})^2)}{\partial out_{o_2}} * \frac{\partial (\frac{1}{1 + e^{-in_{o_2}}})}{\partial in_{o_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_1}} $</span>$ = 2 * \frac{1}{2} (target_{o_2} - out_{o_2}) * (-1) * out_{o_2}(1 - out_{o_2})$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_1}}$</span> $ = (0.99 - 0.772928465) * (-1) * 0.772928465(1 - 0.772928465)$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_1}} $</span> $= -0.038098237$</p>
                        <p>-------------------------</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial out_{h_1}} = \frac{\partial (w_7 * out_{h_1} + w_8 * out_{h_2} + b_2 * 1)}{\partial out_{h_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial out_{h_1}}$</span> $ = w_7$</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial out_{h_1}} $</span> $= 0.5$</p>
                        <p>Gộp lại:</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial out_{h_1}} = \frac{\partial E_{o_2}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial out_{h_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial out_{h_1}}$</span> $ = -0.038098237 * 0.5$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial out_{h_1}}$</span> $ = -0.019049118$</p>
                        <p>---------------------------------</p>
                    </div>




                    <div style="text-align:left; margin-left: 150px">
                        <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{h_1}} = \frac{\partial E_{o_1}}{\partial out_{h_1}} + \frac{\partial E_{o_2}}{\partial out_{h_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{h_1}} $</span>$= 0.055399425 + (-0.019049118) = 0,036350307$</p>
                    </div>

                </p>



                <div style="text-align:left; margin-left: 100px">
                    <p>----------------------</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{h_1}}{\partial in_{h_1}} = \frac{\partial (\frac{1}{1 + e^{-in_{h_1}}})}{\partial in_{h_1}}$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial out_{h_1}}{\partial in_{h_1}} $</span> $= out_{h_1}(1 - out_{h_1})$</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{h_1}}{\partial in_{h_1}}$</span> $ = 0.59326999(1 - 0.59326999) = 0.241300709$</p>
                </div>





                <div style="text-align:left; margin-left: 100px">
                    <p>----------------------</p>
                    <p><span style="font-size:22px">$\frac{\partial in_{h_1}}{\partial w_1} = \frac{\partial (w_1 * i_1 + w_2 * i_2 + b_1 * 1)}{\partial w_1}$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial in_{h_1}}{\partial w_1}$</span> $ = i_1$</p>
                    <p><span style="font-size:22px">$\frac{\partial in_{h_1}}{\partial w_1} $</span> $= 0.05$</p>
                </div>





                <div style="text-align:left; margin-left:50px">
                    <p>--------------------------------------------------------------</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_1} = \frac{\partial E_{total}}{\partial out_{h_1}} * \frac{\partial out_{h_1}}{\partial in_{h_1}} * \frac{\partial in_{h_1}}{\partial w_1}$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_1} $</span> $= 0.036350306 * 0.241300709 * 0.05$</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_1} $</span> $= 0.000438568$</p>
                </div>



                <ul>
                    <li>$w_2$:</li>
                </ul>



                <div style="text-align:left; font-size:22px; margin-left:50px">
                    <p>$\frac{\partial E_{total}}{\partial w_2} = \frac{\partial E_{total}}{\partial out_{h_1}} * \frac{\partial out_{h_1}}{\partial in_{h_1}} * \frac{\partial in_{h_1}}{\partial w_2}$</p>
                    <p>--------------------------------------------------------------</p>
                </div>





                <div style="text-align:left; margin-left: 100px; font-size:22px">
                    <p>$\frac{\partial E_{total}}{\partial out_{h_1}} = \frac{\partial E_{o_1}}{\partial out_{h_1}} + \frac{\partial E_{o_2}}{\partial out_{h_1}}$</p>
                    <p>----------------------------------------------------</p>
                </div>





                <div style="text-align:left; margin-left: 150px; font-size:22px">
                    <!-- E o1/ out h1 -->
                    <p>$\frac{\partial E_{o_1}}{\partial out_{h_1}} = \frac{\partial E_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial out_{h_1}}$</p>
                    <p>---------------------------------</p>
                </div>



                <p>

                    <div style="text-align:left; margin-left: 200px">
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} = \frac{\partial E_{o_1}}{\partial out_{o_1}} * \frac{\partial out_{o_1}}{\partial in_{o_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} = \frac{\partial (\frac{1}{2}(target_{o_1} - out_{o_1})^2)}{\partial out_{o_1}} * \frac{\partial (\frac{1}{1 + e^{-in_{o_1}}})}{\partial in_{o_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} $</span>$ = 2 * \frac{1}{2} (target_{o_1} - out_{o_1}) * (-1) * out_{o_1}(1 - out_{o_1})$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}}$</span> $ = (0.01 - 0.75136507) * (-1) * 0.75136507(1 - 0.75136507)$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} $</span> $= 0.138498562$</p>
                        <p>-------------------------</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial out_{h_1}} = \frac{\partial (w_5 * out_{h_1} + w_6 * out_{h_2} + b_2 * 1)}{\partial out_{h_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial out_{h_1}}$</span> $ = w_5$</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial out_{h_1}}$</span> $ = 0.4$</p>
                        <p>Gộp lại:</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial out_{h_1}} = \frac{\partial E_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial out_{h_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial out_{h_1}}$</span> $ = 0.138498562 * 0.4$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial out_{h_1}} $</span> $= 0.055399425$</p>
                        <p>----------------------------------------------------</p>
                    </div>




                    <div style="text-align:left; margin-left: 150px; font-size:22px">
                        <!-- E o2/out h1 -->
                        <p>$\frac{\partial E_{o_2}}{\partial out_{h_1}} = \frac{\partial E_{o_2}}{\partial in_{o_2}} * \frac{\partial in_{o_2}}{\partial out_{h_1}}$</p>
                        <p>---------------------------------</p>
                    </div>




                    <div style="text-align:left; margin-left: 200px">
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_2}} = \frac{\partial E_{o_2}}{\partial out_{o_2}} * \frac{\partial out_{o_2}}{\partial in_{o_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_2}} = \frac{\partial (\frac{1}{2}(target_{o_2} - out_{o_2})^2)}{\partial out_{o_2}} * \frac{\partial (\frac{1}{1 + e^{-in_{o_2}}})}{\partial in_{o_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_1}} $</span>$ = 2 * \frac{1}{2} (target_{o_2} - out_{o_2}) * (-1) * out_{o_2}(1 - out_{o_2})$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_1}}$</span> $ = (0.99 - 0.772928465) * (-1) * 0.772928465(1 - 0.772928465)$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_1}} $</span> $= -0.038098237$</p>
                        <p>-------------------------</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial out_{h_1}} = \frac{\partial (w_7 * out_{h_1} + w_8 * out_{h_2} + b_2 * 1)}{\partial out_{h_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial out_{h_1}}$</span> $ = w_7$</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial out_{h_1}} $</span> $= 0.5$</p>
                        <p>Gộp lại:</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial out_{h_1}} = \frac{\partial E_{o_2}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial out_{h_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial out_{h_1}}$</span> $ = -0.038098237 * 0.5$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial out_{h_1}}$</span> $ = -0.019049118$</p>
                        <p>---------------------------------</p>
                    </div>




                    <div style="text-align:left; margin-left: 150px">
                        <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{h_1}} = \frac{\partial E_{o_1}}{\partial out_{h_1}} + \frac{\partial E_{o_2}}{\partial out_{h_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{h_1}} $</span>$= 0.055399425 + (-0.019049118) = 0,036350307$</p>
                    </div>

                </p>



                <div style="text-align:left; margin-left: 100px">
                    <p>----------------------</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{h_1}}{\partial in_{h_1}} = \frac{\partial (\frac{1}{1 + e^{-in_{h_1}}})}{\partial in_{h_1}}$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial out_{h_1}}{\partial in_{h_1}} $</span> $= out_{h_1}(1 - out_{h_1})$</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{h_1}}{\partial in_{h_1}}$</span> $ = 0.59326999(1 - 0.59326999) = 0.241300709$</p>
                </div>





                <div style="text-align:left; margin-left: 100px">
                    <p>----------------------</p>
                    <p><span style="font-size:22px">$\frac{\partial in_{h_1}}{\partial w_2} = \frac{\partial (w_1 * i_1 + w_2 * i_2 + b_1 * 1)}{\partial w_2}$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial in_{h_1}}{\partial w_2}$</span> $ = i_2$</p>
                    <p><span style="font-size:22px">$\frac{\partial in_{h_1}}{\partial w_2} $</span> $= 0.1$</p>
                </div>





                <div style="text-align:left; margin-left:50px">
                    <p>--------------------------------------------------------------</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_2} = \frac{\partial E_{total}}{\partial out_{h_1}} * \frac{\partial out_{h_1}}{\partial in_{h_1}} * \frac{\partial in_{h_1}}{\partial w_2}$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_2} $</span> $= 0.036350306 * 0.241300709 * 0.1$</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_2} $</span> $= 0.000877135$</p>
                </div>



                <ul>
                    <li>$w_3$:</li>
                </ul>



                <div style="text-align:left; font-size:22px; margin-left:50px">
                    <p>$\frac{\partial E_{total}}{\partial w_3} = \frac{\partial E_{total}}{\partial out_{h_2}} * \frac{\partial out_{h_2}}{\partial in_{h_2}} * \frac{\partial in_{h_2}}{\partial w_3}$</p>
                    <p>--------------------------------------------------------------</p>
                </div>





                <div style="text-align:left; margin-left: 100px; font-size:22px">
                    <p>$\frac{\partial E_{total}}{\partial out_{h_2}} = \frac{\partial E_{o_1}}{\partial out_{h_2}} + \frac{\partial E_{o_2}}{\partial out_{h_2}}$</p>
                    <p>----------------------------------------------------</p>
                </div>





                <div style="text-align:left; margin-left: 150px; font-size:22px">
                    <!-- E o1/ out h1 -->
                    <p>$\frac{\partial E_{o_1}}{\partial out_{h_2}} = \frac{\partial E_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial out_{h_2}}$</p>
                    <p>---------------------------------</p>
                </div>



                <p>

                    <div style="text-align:left; margin-left: 200px">
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} = \frac{\partial E_{o_1}}{\partial out_{o_1}} * \frac{\partial out_{o_1}}{\partial in_{o_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} = \frac{\partial (\frac{1}{2}(target_{o_1} - out_{o_1})^2)}{\partial out_{o_1}} * \frac{\partial (\frac{1}{1 + e^{-in_{o_1}}})}{\partial in_{o_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} $</span>$ = 2 * \frac{1}{2} (target_{o_1} - out_{o_1}) * (-1) * out_{o_1}(1 - out_{o_1})$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}}$</span> $ = (0.01 - 0.75136507) * (-1) * 0.75136507(1 - 0.75136507)$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} $</span> $= 0.138498562$</p>
                        <p>-------------------------</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial out_{h_2}} = \frac{\partial (w_5 * out_{h_1} + w_6 * out_{h_2} + b_2 * 1)}{\partial out_{h_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial out_{h_2}}$</span> $ = w_6$</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial out_{h_2}}$</span> $ = 0.45$</p>
                        <p>Gộp lại:</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial out_{h_2}} = \frac{\partial E_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial out_{h_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial out_{h_2}}$</span> $ = 0.138498562 * 0.45$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial out_{h_2}} $</span> $= 0.062324353$</p>
                        <p>----------------------------------------------------</p>
                    </div>




                    <div style="text-align:left; margin-left: 150px; font-size:22px">
                        <!-- E o2/out h1 -->
                        <p>$\frac{\partial E_{o_2}}{\partial out_{h_2}} = \frac{\partial E_{o_2}}{\partial in_{o_2}} * \frac{\partial in_{o_2}}{\partial out_{h_2}}$</p>
                        <p>---------------------------------</p>
                    </div>




                    <div style="text-align:left; margin-left: 200px">
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_2}} = \frac{\partial E_{o_2}}{\partial out_{o_2}} * \frac{\partial out_{o_2}}{\partial in_{o_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_2}} = \frac{\partial (\frac{1}{2}(target_{o_2} - out_{o_2})^2)}{\partial out_{o_2}} * \frac{\partial (\frac{1}{1 + e^{-in_{o_2}}})}{\partial in_{o_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_2}} $</span>$ = 2 * \frac{1}{2} (target_{o_2} - out_{o_2}) * (-1) * out_{o_2}(1 - out_{o_2})$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_2}}$</span> $ = (0.99 - 0.772928465) * (-1) * 0.772928465(1 - 0.772928465)$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_2}} $</span> $= -0.038098237$</p>
                        <p>-------------------------</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial out_{h_2}} = \frac{\partial (w_7 * out_{h_1} + w_8 * out_{h_2} + b_2 * 1)}{\partial out_{h_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial out_{h_2}}$</span> $ = w_8$</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial out_{h_2}} $</span> $= 0.55$</p>
                        <p>Gộp lại:</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial out_{h_2}} = \frac{\partial E_{o_2}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial out_{h_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial out_{h_2}}$</span> $ = -0.038098237 * 0.55$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial out_{h_2}}$</span> $ = -0.02095403$</p>
                        <p>---------------------------------</p>
                    </div>




                    <div style="text-align:left; margin-left: 150px">
                        <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{h_2}} = \frac{\partial E_{o_1}}{\partial out_{h_2}} + \frac{\partial E_{o_2}}{\partial out_{h_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{h_2}} $</span>$= 0.062324353 + (-0.02095403) = 0.041370323$</p>
                    </div>

                </p>



                <div style="text-align:left; margin-left: 100px">
                    <p>----------------------</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{h_2}}{\partial in_{h_2}} = \frac{\partial (\frac{1}{1 + e^{-in_{h_2}}})}{\partial in_{h_2}}$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial out_{h_2}}{\partial in_{h_2}} $</span> $= out_{h_2}(1 - out_{h_2})$</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{h_2}}{\partial in_{h_2}}$</span> $ = 0.596884378(1 - 0.596884378) = 0.240613417$</p>
                </div>





                <div style="text-align:left; margin-left: 100px">
                    <p>----------------------</p>
                    <p><span style="font-size:22px">$\frac{\partial in_{h_2}}{\partial w_3} = \frac{\partial (w_3 * i_1 + w_4 * i_2 + b_1 * 1)}{\partial w_3}$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial in_{h_2}}{\partial w_3}$</span> $ = i_1$</p>
                    <p><span style="font-size:22px">$\frac{\partial in_{h_2}}{\partial w_3} $</span> $= 0.05$</p>
                </div>





                <div style="text-align:left; margin-left:50px">
                    <p>--------------------------------------------------------------</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_3} = \frac{\partial E_{total}}{\partial out_{h_2}} * \frac{\partial out_{h_2}}{\partial in_{h_2}} * \frac{\partial in_{h_2}}{\partial w_3}$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_3} $</span> $= 0.041370323 * 0.240613417 * 0.05$</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_3} $</span> $= 0.000497713$</p>
                </div>



                <ul>
                    <li>$w_4$:</li>
                </ul>



                <div style="text-align:left; font-size:22px; margin-left:50px">
                    <p>$\frac{\partial E_{total}}{\partial w_4} = \frac{\partial E_{total}}{\partial out_{h_2}} * \frac{\partial out_{h_2}}{\partial in_{h_2}} * \frac{\partial in_{h_2}}{\partial w_4}$</p>
                    <p>--------------------------------------------------------------</p>
                </div>





                <div style="text-align:left; margin-left: 100px; font-size:22px">
                    <p>$\frac{\partial E_{total}}{\partial out_{h_2}} = \frac{\partial E_{o_1}}{\partial out_{h_2}} + \frac{\partial E_{o_2}}{\partial out_{h_2}}$</p>
                    <p>----------------------------------------------------</p>
                </div>





                <div style="text-align:left; margin-left: 150px; font-size:22px">
                    <!-- E o1/ out h1 -->
                    <p>$\frac{\partial E_{o_1}}{\partial out_{h_2}} = \frac{\partial E_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial out_{h_2}}$</p>
                    <p>---------------------------------</p>
                </div>



                <p>

                    <div style="text-align:left; margin-left: 200px">
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} = \frac{\partial E_{o_1}}{\partial out_{o_1}} * \frac{\partial out_{o_1}}{\partial in_{o_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} = \frac{\partial (\frac{1}{2}(target_{o_1} - out_{o_1})^2)}{\partial out_{o_1}} * \frac{\partial (\frac{1}{1 + e^{-in_{o_1}}})}{\partial in_{o_1}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} $</span>$ = 2 * \frac{1}{2} (target_{o_1} - out_{o_1}) * (-1) * out_{o_1}(1 - out_{o_1})$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}}$</span> $ = (0.01 - 0.75136507) * (-1) * 0.75136507(1 - 0.75136507)$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial in_{o_1}} $</span> $= 0.138498562$</p>
                        <p>-------------------------</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial out_{h_2}} = \frac{\partial (w_5 * out_{h_1} + w_6 * out_{h_2} + b_2 * 1)}{\partial out_{h_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial out_{h_2}}$</span> $ = w_6$</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_1}}{\partial out_{h_2}}$</span> $ = 0.45$</p>
                        <p>Gộp lại:</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial out_{h_2}} = \frac{\partial E_{o_1}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial out_{h_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial out_{h_2}}$</span> $ = 0.138498562 * 0.45$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_1}}{\partial out_{h_2}} $</span> $= 0.062324353$</p>
                        <p>----------------------------------------------------</p>
                    </div>




                    <div style="text-align:left; margin-left: 150px; font-size:22px">
                        <!-- E o2/out h1 -->
                        <p>$\frac{\partial E_{o_2}}{\partial out_{h_2}} = \frac{\partial E_{o_2}}{\partial in_{o_2}} * \frac{\partial in_{o_2}}{\partial out_{h_2}}$</p>
                        <p>---------------------------------</p>
                    </div>




                    <div style="text-align:left; margin-left: 200px">
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_2}} = \frac{\partial E_{o_2}}{\partial out_{o_2}} * \frac{\partial out_{o_2}}{\partial in_{o_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_2}} = \frac{\partial (\frac{1}{2}(target_{o_2} - out_{o_2})^2)}{\partial out_{o_2}} * \frac{\partial (\frac{1}{1 + e^{-in_{o_2}}})}{\partial in_{o_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_2}} $</span>$ = 2 * \frac{1}{2} (target_{o_2} - out_{o_2}) * (-1) * out_{o_2}(1 - out_{o_2})$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_2}}$</span> $ = (0.99 - 0.772928465) * (-1) * 0.772928465(1 - 0.772928465)$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial in_{o_2}} $</span> $= -0.038098237$</p>
                        <p>-------------------------</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial out_{h_2}} = \frac{\partial (w_7 * out_{h_1} + w_8 * out_{h_2} + b_2 * 1)}{\partial out_{h_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial out_{h_2}}$</span> $ = w_8$</p>
                        <p><span style="font-size:22px">$\frac{\partial in_{o_2}}{\partial out_{h_2}} $</span> $= 0.55$</p>
                        <p>Gộp lại:</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial out_{h_2}} = \frac{\partial E_{o_2}}{\partial in_{o_1}} * \frac{\partial in_{o_1}}{\partial out_{h_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial out_{h_2}}$</span> $ = -0.038098237 * 0.55$</p>
                        <p><span style="font-size:22px">$\frac{\partial E_{o_2}}{\partial out_{h_2}}$</span> $ = -0.02095403$</p>
                        <p>---------------------------------</p>
                    </div>




                    <div style="text-align:left; margin-left: 150px">
                        <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{h_2}} = \frac{\partial E_{o_1}}{\partial out_{h_2}} + \frac{\partial E_{o_2}}{\partial out_{h_2}}$</span></p>
                        <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial out_{h_2}} $</span>$= 0.062324353 + (-0.02095403) = 0.041370323$</p>
                    </div>

                </p>



                <div style="text-align:left; margin-left: 100px">
                    <p>----------------------</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{h_2}}{\partial in_{h_2}} = \frac{\partial (\frac{1}{1 + e^{-in_{h_2}}})}{\partial in_{h_2}}$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial out_{h_2}}{\partial in_{h_2}} $</span> $= out_{h_2}(1 - out_{h_2})$</p>
                    <p><span style="font-size:22px">$\frac{\partial out_{h_2}}{\partial in_{h_2}}$</span> $ = 0.596884378(1 - 0.596884378) = 0.240613417$</p>
                </div>





                <div style="text-align:left; margin-left: 100px">
                    <p>----------------------</p>
                    <p><span style="font-size:22px">$\frac{\partial in_{h_2}}{\partial w_4} = \frac{\partial (w_3 * i_1 + w_4 * i_2 + b_1 * 1)}{\partial w_3}$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial in_{h_2}}{\partial w_4}$</span> $ = i_2$</p>
                    <p><span style="font-size:22px">$\frac{\partial in_{h_2}}{\partial w_4} $</span> $= 0.1$</p>
                </div>





                <div style="text-align:left; margin-left:50px">
                    <p>--------------------------------------------------------------</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_4} = \frac{\partial E_{total}}{\partial out_{h_2}} * \frac{\partial out_{h_2}}{\partial in_{h_2}} * \frac{\partial in_{h_2}}{\partial w_4}$</span></p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_4} $</span> $= 0.041370323 * 0.240613417 * 0.1$</p>
                    <p><span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_4} $</span> $= 0.000995425$</p>
                </div>



                <p>Đến đây ta đã tính xong các đạo hàm từng phần theo các $w$. Áp dụng SGD để cập nhật các $w$ ta được (chọn $\eta = 0.9$):</p>



                <div style="text-align:left; margin-left:50px">
                    <p>$w_5^+ = w_5 - \eta * $<span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_5}$</span></p>
                    <p>$w_5^+ = 0.4 - 0.9 * 0.082167041$</p>
                    <p>$w_5^+ = 0.326049663$</p>
                    <p>-------------------------</p>
                </div>





                <div style="text-align:left; margin-left:50px">
                    <p>$w_6^+ = w_6 - \eta * $<span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_6}$</span></p>
                    <p>$w_6^+ = 0.45 - 0.9 * 0.082667628$</p>
                    <p>$w_6^+ = 0.375599135$</p>
                    <p>-------------------------</p>
                </div>





                <div style="text-align:left; margin-left:50px">
                    <p>$w_7^+ = w_7 - \eta * $<span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_7}$</span></p>
                    <p>$w_7^+ = 0.5 - 0.9 * (-0.022602541)$</p>
                    <p>$w_7^+ = 0.520342287$</p>
                    <p>-------------------------</p>
                </div>





                <div style="text-align:left; margin-left:50px">
                    <p>$w_8^+ = w_8 - \eta * $<span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_8}$</span></p>
                    <p>$w_8^+ = 0.55 - 0.9 * (-0.022740242)$</p>
                    <p>$w_8^+ = 0.570466218$</p>
                    <p>-------------------------</p>
                </div>





                <div style="text-align:left; margin-left:50px">
                    <p>$w_1^+ = w_1 - \eta * $<span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_1}$</span></p>
                    <p>$w_1^+ = 0.15 - 0.9 * 0.000438568$</p>
                    <p>$w_1^+ = 0.149605289$</p>
                    <p>-------------------------</p>
                </div>





                <div style="text-align:left; margin-left:50px">
                    <p>$w_2^+ = w_2 - \eta * $<span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_2}$</span></p>
                    <p>$w_2^+ = 0.2 - 0.9 * 0.0080877135$</p>
                    <p>$w_2^+ = 0.192721058$</p>
                    <p>-------------------------</p>
                </div>





                <div style="text-align:left; margin-left:50px">
                    <p>$w_3^+ = w_3 - \eta * $<span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_3}$</span></p>
                    <p>$w_3^+ = 0.25 - 0.9 * 0.000497713$</p>
                    <p>$w_3^+ = 0.249552058$</p>
                    <p>-------------------------</p>
                </div>





                <div style="text-align:left; margin-left:50px">
                    <p>$w_4^+ = w_4 - \eta * $<span style="font-size:22px">$\frac{\partial E_{total}}{\partial w_4}$</span></p>
                    <p>$w_4^+ = 0.3 - 0.9 * 0.000995425$</p>
                    <p>$w_4^+ = 0.299104118$</p>
                    <p>-------------------------</p>
                </div>



                <p>Phù, như vậy là chúng ta đã cập nhật xong giá trị mới cho các trọng số $w$. Đây là những phép toán xảy ra trong mỗi lần cập nhật. Hi vọng, thông qua ví dụ trong bài này, các bạn đã có thể hiểu rõ hơn bản chất của mạng NN. Hẹn gặp lại các
                    bạn trong các bài tiếp theo!</p>

                <p><strong>3. Tham khảo</strong></p>

                <ul>
                    <li><a href="https://www.pyimagesearch.com/">Pyimagesearch</a></li>
                    <li><a href="https://d2l.ai/chapter_multilayer-perceptrons/mlp.html">Dive into Deep Learning</a></li>
                    <li><a href="https://en.wikipedia.org/wiki/Activation_function">Wikipedia</a></li>
                </ul>

            </div>
            <div class="info post_meta">
                <time datetime=2020-10-24T00:00:00Z class="date">Saturday, October 24, 2020</time>

                <ul class="tags">

                    <li> <a href="https://tiensu.github.io/tags/ai">AI</a> </li>

                    <li> <a href="https://tiensu.github.io/tags/deep-learning">Deep Learning</a> </li>

                    <li> <a href="https://tiensu.github.io/tags/neural-network">Neural Network</a> </li>

                </ul>


            </div>
            <div class="clearfix"></div>
        </article>

        <div class="other_posts">

            <a href="https://tiensu.github.io/posts/18_neural_network_fundamentals_1/" class="prev">Neural Network cơ bản (Phần 1)</a>


            <a href="https://tiensu.github.io/posts/20_convolutional_neural_network_1/" class="next">Mạng thần kinh tích chập (Convolutional Neural Network (CNN) - Phần 1</a>

        </div>
        <aside id="comments">
        </aside>


    </section>

    <a id="back_to_top" title="Go To Top" href="#">
        <span>
    <svg viewBox="0 0 24 24">
      <path fill="none" d="M0 0h24v24H0z"></path>
      <path d="M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"></path>
    </svg>
  </span>
    </a>

    <footer id="footer">
        <p>
            <span>&copy; 2020 <a href="https://tiensu.github.io/" title="ML in Practical">ML in Practical</a> </span>
            <span>Built with <a rel="nofollow" target="_blank" href="https://gohugo.io">Hugo</a></span>
            <span>Theme by <a rel="nofollow" target="_blank" href="https://github.com/wayjam/hugo-theme-mixedpaper">WayJam</a></span>
        </p>
        <script src="https://tiensu.github.io/js/main.min.8b182175f5874aeed0acc0979345c98d4bde22208ec4f36cc1d6e3102acb4b10.js" integrity="sha256-ixghdfWHSu7QrMCXk0XJjUveIiCOxPNswdbjECrLSxA=" crossorigin="anonymous" async></script>
    </footer>

</body>

</html>